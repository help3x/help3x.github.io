<!DOCTYPE html><html><head><meta charSet="utf-8" class="next-head"/><meta http-equiv="X-UA-Compatible" content="IE=edge" class="next-head"/><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1" class="next-head"/><link rel="stylesheet" href="/next1/static/css/bootstrap-reboot.css" class="next-head"/><link rel="stylesheet" href="/next1/static/css/base.css" class="next-head"/><title class="jsx-796471169 next-head">JavaScript で
abc\ | NOTE:: 技術メモ</title><meta name="description" class="jsx-796471169 next-head"/><link rel="preload" href="/next1/_next/static/8XuzPB_jJm_7d8ACRpK5s/pages/post.js" as="script"/><link rel="preload" href="/next1/_next/static/8XuzPB_jJm_7d8ACRpK5s/pages/_app.js" as="script"/><link rel="preload" href="/next1/_next/static/8XuzPB_jJm_7d8ACRpK5s/pages/_error.js" as="script"/><link rel="preload" href="/next1/_next/static/runtime/webpack-42652fa8b82c329c0559.js" as="script"/><link rel="preload" href="/next1/_next/static/chunks/commons.c8e68c3a49c7dc3e6621.js" as="script"/><link rel="preload" href="/next1/_next/static/runtime/main-525d18c4fe55e81fb890.js" as="script"/><style id="__jsx-3432564821">.global-header.jsx-3432564821{height:auto;box-shadow:none;background-color:#24292e;}
.site-name.jsx-3432564821{color:whiteSmoke;font-weight:bold;}
.site-name.jsx-3432564821:hover{-webkit-text-decoration:none;text-decoration:none;}
.cursor-pointer.jsx-3432564821{cursor:pointer;}
.text-white-smoke.jsx-3432564821{color:whiteSmoke;}
.line-height-3x.jsx-3432564821{line-height:3;}</style><style id="__jsx-796471169">.article-header h1{font-size:2rem;line-height:1.25;}
.article-body h2{font-size:1.5rem;line-height:1.3333333333;margin-top:3rem;padding-top:1rem;padding-bottom:1rem;border-top:solid 1px #000;border-bottom:solid 1px #000;}
.article-body h3{font-size:1.25rem;line-height:1.4;padding-top:.75rem;}
.article-body h4{font-size:1rem;line-height:1.5;padding-top:1rem;}
.article-body h5{font-size:.875rem;line-height:1.5714285714;padding-top:1.125rem;}
.article-body h6{font-size:.75rem;line-height:1.6666666667;padding-top:1.25rem;}
.article-body div.sourceCode{margin:0;margin-left:-1rem;margin-right:-1rem;margin-bottom:1rem;padding:0;}
.article-body pre.sourceCode{madgin:0;padding:1rem;overflow-x:auto;color:#333;background:#f8f8f8;border:1px solid #ddd;border-radius:.25rem;font-size:.75rem;max-width:100%;}
.article-body code.sourceCode,pre>code{background-color:transparent;padding:0;}
@media all and (min-width:50em){.article-body div.sourceCode{margin-left:-2rem;margin-right:-2rem;}.article-body pre.sourceCode{padding-left:2rem;padding-right:2rem;}}</style><style id="__jsx-3331426913">.copyright.jsx-3331426913{background-color:dimGray;color:whiteSmoke;}</style></head><body><div id="__next"><div class="flex flex-column overflow-hidden bg-white-smoke"><div class="flex flex-column min-h-screen"><header class="jsx-3432564821 global-header mb3 py0 px2 shadow-md bg-white"><div class="jsx-3432564821"><a class="jsx-3432564821 h4 regular m0 site-name text-bg line-height-3x cursor-pointer" href="/next1/">NOTE:: 技術メモ</a><p class="jsx-3432564821 mt0 text-sm text-white-smoke">自分のための技術メモを残しています。</p></div></header><div class="flex-auto contents mb3 md-px3 md-pt2 md-pb3 bg-white-smoke"><article class="jsx-796471169 p2 md-pt3 md-px3 bg-white"><header class="jsx-796471169 article-header mb3"><h1 class="jsx-796471169">JavaScript で
abc\</h1><div class="jsx-796471169 flex flex-wrap"><div class="jsx-796471169"><time dateTime="2019-01-15T16:39+09:00" class="jsx-796471169 ">2019.01.15</time></div></div></header><div class="jsx-796471169 article-body"><p>abc
を"<code>dangerouslySetInnerHTML</code>"に指定したとき、どのように表示されるか。確かめてください。</p><h2 id="実施環境">実施環境</h2>
<ul>
<li>Windows 7 Professional Service Pack 1</li>
<li>node v8.9.4</li>
<li>npm 4.0.5</li>
<li>create-react-app 1.5.2</li>
</ul>
<h2 id="はじめに">はじめに</h2>
<p>React : Webの見た目を作ることに特化したJavaScriptライブラリ。 Viewに関連する機能だけを持つ。</p>
<p>Flux : 次のように、データの流れを一方向に限定する設計パターン。 不整合が発生しにくい仕組みになっている。</p>
<pre><code>                  ┌─── Action ←─┐
                  ↓                  ｜
    Action → Dispatcher → Store → View

&lt;!-- --&gt;

1. View はユーザーの入力から Action を作成する。
2. Action を Dispatch することで Store にデータを保存する。
3. Store を View に反映する。
</code></pre>
<p>Redux : Fluxアーキテクチャの実装。</p>
<!--
- View
- Action
- Store
- Dispatcher
- Reducer
    状態を変化させるための関数です。Actionの内容によって既存の状態を変化させます。
-->

<p>オブジェクトや配列の操作を行う場合は、基本的には参照渡しでなく値のコピーを渡します。 参照を切る方法としてES2015で標準化された<code>Object.assign()</code>メソッドを使ってもよいです。</p>
<p>Spread Operatorでも可。</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">  ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="dt">status</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="op">};</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="cf">return</span> <span class="va">Object</span>.<span class="at">assign</span>(<span class="op">{},</span> state<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="dt">state</span><span class="op">:</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="create-react-app">Create React App</h2>
<p><a href="https://github.com/facebook/create-react-app">GitHub - facebook/create-react-app</a></p>
<h2 id="環境構築">環境構築</h2>
<h3 id="nodejsのインストール">node.jsのインストール</h3>
<p>割愛します。</p>
<p>Windowsユーザーであれば nodist を入れればよいかと。</p>
<h3 id="create-react-app-のインストール">create-react-app のインストール</h3>
<p>作業フォルダを作りその中にインストールします。</p>
<pre><code>&gt; mkdir react1st &amp; cd react1st
&gt; npm install create-react-app
</code></pre>
<h3 id="アプリケーションの作成">アプリケーションの作成</h3>
<p><code>create-react-app</code>コマンドを使ってアプリケーションを作成します。</p>
<p>構文 : <code>create-react-app &lt;application-name&gt;</code></p>
<p><code>my-app</code>アプリケーションを作成してみます。</p>
<pre><code>&gt; .\node_modules\.bin\create-react-app my-app
</code></pre>
<p>作成されたアプリケーションの構成は以下のようになっています。</p>
<pre><code>.
+---node_modules
+---public
|   +---favicon.ico
|   +---index.html
|   `---manifest.json
+---src
|   +---App.css
|   +---App.js
|   +---App.test.js
|   +---index.css
|   +---index.js
|   +---logo.svg
|   `---registerServiceWorker.js
+---.gitignore
+---package.json
`---README.md
</code></pre>
<h3 id="開発モードでアプリケーションを起動">開発モードでアプリケーションを起動</h3>
<p>アプリケーションのルートフォルダ（<code>my-app</code>フォルダ）に移動し、<code>npm start</code>コマンドを実行します。 ブラウザが自動で起動し、アプリケーションが表示されます。 もし、ブラウザが起動しなかったときは自分で起動して<code>http://localhost:3000/</code>にアクセスしてください。</p>
<pre><code>&gt; cd my-app
&gt; npm start
</code></pre>
<h4 id="開発モードの機能">開発モードの機能</h4>
<p>開発モードは次の動作になります。 開発モードを終了するには、Control＋Cキーを押します。</p>
<ul>
<li>ソースコードの変更を監視し、アプリケーションを自動でビルドする。</li>
<li>ブラウザを自動でリロードする。</li>
<li>コンソールにビルドエラーとlintの警告を表示する。</li>
</ul>
<h3 id="hello-world-の表示">Hello, World! の表示</h3>
<p><code>src\App.js</code>ファイルを以下のように編集します。</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="op">&lt;</span>h1 className<span class="op">=</span><span class="st">&quot;App-title&quot;</span><span class="op">&gt;</span>Welcome to React&lt;/h1<span class="op">&gt;</span></a></code></pre></div>
<p>↓</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="op">&lt;</span>h1 className<span class="op">=</span><span class="st">&quot;App-title&quot;</span><span class="op">&gt;</span>Hello<span class="op">,</span> World<span class="op">!</span>&lt;/h1<span class="op">&gt;</span></a></code></pre></div>
<p>保存に伴い、ブラウザが自動でリロードされ、修正内容が反映されます。</p>
<h2 id="jsx">JSX</h2>
<p>JSX : JavaScriptを拡張した言語。 ReactとJSXを一緒に使うことが推奨されています（必須ではない）。</p>
<ul>
<li>JSXでは、JavaScriptのなかにHTMLのタグや属性を（ほぼ）同じように書くことができる。</li>
<li>最終的にトランスパイラでJavaScriptに変換して使う。 このとき、JSXに書いたタグは、<code>React.createElement</code>関数の呼び出しに変換される。</li>
</ul>
<p>トランスパイラ : ソースコードを別のソースコードに変換するツールのことです。 BabelのほかCoffeeScriptやTypeScriptなどがあります。</p>
<h3 id="jsxの使い方">JSXの使い方</h3>
<ul>
<li><p>JSXのタグは<code>React.createElement</code>に変換されるため、Reactのインポートが必要です。</p>
<pre><code>  import React from &#39;react&#39;;
</code></pre></li>
<li><p><code>{}</code>で囲むと式をJSXに埋め込むことができます。</p>
<pre><code>  const fullnames = {
    ryoma: &#39;坂本竜馬&#39;
  };
  const getFullname = nickname =&gt; fullnames[nickname];
  const element = &lt;h1&gt;Hello, {getFullname(&#39;ryoma&#39;)}&lt;/h1&gt;;
</code></pre></li>
</ul>
<h2 id="babelのインストール">babelのインストール</h2>
<ol>
<li><p>作業ディレクトリを作り、その中に移動します。</p>
<pre><code> &gt; mkdir babel-cli-example &amp; cd babel-cli-example
</code></pre></li>
<li><p>空のpackage.jsonを作ります。</p>
<pre><code> &gt; echo {} &gt; package.json
</code></pre></li>
<li><p>Babel関連のパッケージをインストールします。</p>
<pre><code> &gt; npm install --save-dev babel-cli babel-preset-react
</code></pre></li>
</ol>
<p>babel-cli BabelをCLI上で動作させるためのパッケージです。 Babelを使ったソースコードの変換を行うbabelコマンドと、変換に加えて変換後のソースコードをそのままNode.jsで実行するbabel-nodeコマンドを含んでいます。</p>
<h3 id="react向けに変換するコマンド">react向けに変換するコマンド</h3>
<pre><code>.\node_modules\.bin\babel [Options...] target-file
</code></pre>
<p>e.g.,</p>
<pre><code>.\node_modules\.bin\babel --presets=react input.js
</code></pre>
<p>標準出力ではなくファイルに出力するときは、<code>--out-file</code>オプションにファイル名を指定します。</p>
<pre><code>.\node_modules\.bin\babel --presets=react input.js --out-file output.js
</code></pre>
<p>webpack : モジュールバンドラー。<br />
ES ModulesやNode.jsで利用されているCommonJSのモジュール方式で記述されたソースファイルを束ねて、ブラウザで実行可能な静的なJavaScriptファイルを出力します。</p>
<ol>
<li><p>作業ディレクトリを作り、その中に移動します。</p>
<pre><code> &gt; mkdir webpack-example &amp; cd webpack-example
</code></pre></li>
<li><p>空のpackage.jsonを作ります。</p>
<pre><code> &gt; echo {} &gt; package.json
</code></pre></li>
<li><p>開発に使うパッケージをインストールします（<code>--save-dev</code>オプションをつけます）。</p>
<pre><code> &gt; npm install --save-dev ^
   webpack ^
   webpack-cli ^
   babel-loader ^
   babel-core ^
   babel-preset-react
</code></pre></li>
<li><p>実行に使うパッケージをインストールします（<code>--save</code>オプションをつけます）。</p>
<pre><code> &gt; npm install --save ^
   react ^
   react-dom
</code></pre></li>
</ol>
<!--
--save-devインストール

- webpack
- webpack-cli
- babel-loader
- babel-core
- babel-preset-react

--saveインストール

- react
- react-dom
-->

<p>Webpackのバージョンを表示</p>
<pre><code>.\node_modules\.bin\webpack --version
4.1.0
</code></pre>
<p>Hello.js :</p>
<pre><code>~~~javascript
import React from &#39;react&#39;;

// export default function で
// Hello コンポーネントを持っていることを外部に知らせる
export default function Hello() {
  return &lt;h1&gt;Hello! webpack&lt;/h1&gt;;
}
~~~
</code></pre>
<p>entry.js :</p>
<pre><code>~~~javascript
import React from &#39;react&#39;;
import ReactDOM from &#39;react-dom&#39;;
import Hello from &#39;./Hello&#39;;    // ← Hello.js の読み込み

ReactDOM.render(
  &lt;Hello /&gt;,
  document.getElementById(&#39;root&#39;)
);
~~~
</code></pre>
<p>importのパスが絶対パスでも相対パスでもない場合、webpackはnpmモジュールから読み込みます。</p>
<p>webpack.config.js</p>
<p>webpackの設定ファイルは、JSON、XML、YAMLなどのフォーマットを記述できます。<br />
フォーマットの判別は設定ファイルの拡張子で行います。</p>
<p>JavaScriptであれば、Node.jsのモジュールとして扱うので、<code>module.exports</code>に代入しているオブジェクトが設定ファイルとして利用されます。</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb25-2" title="2">  <span class="co">// entryフィールド</span></a>
<a class="sourceLine" id="cb25-3" title="3">  <span class="co">// 実行の起点となるファイルの指定</span></a>
<a class="sourceLine" id="cb25-4" title="4">  <span class="dt">entry</span><span class="op">:</span> <span class="st">&#39;./entry.js&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb25-5" title="5">  </a>
<a class="sourceLine" id="cb25-6" title="6">  <span class="co">// outputフィールド</span></a>
<a class="sourceLine" id="cb25-7" title="7">  <span class="co">// 出力に関する設定</span></a>
<a class="sourceLine" id="cb25-8" title="8">  <span class="dt">output</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb25-9" title="9">    <span class="dt">filename</span><span class="op">:</span> <span class="st">&#39;output.js&#39;</span></a>
<a class="sourceLine" id="cb25-10" title="10">  <span class="op">},</span></a>
<a class="sourceLine" id="cb25-11" title="11">  </a>
<a class="sourceLine" id="cb25-12" title="12">  <span class="dt">module</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb25-13" title="13">    <span class="dt">rules</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb25-14" title="14">      <span class="co">// babel-loader の設定</span></a>
<a class="sourceLine" id="cb25-15" title="15">      <span class="co">// ファイルごとに適応するLoaderの設定を書く</span></a>
<a class="sourceLine" id="cb25-16" title="16">      <span class="op">{</span></a>
<a class="sourceLine" id="cb25-17" title="17">        <span class="dt">loader</span><span class="op">:</span> <span class="st">&#39;babel-loader&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb25-18" title="18">        <span class="dt">test</span><span class="op">:</span> <span class="ss">/</span><span class="sc">\.</span><span class="ss">js</span><span class="sc">$</span><span class="ss">/</span><span class="op">,</span></a>
<a class="sourceLine" id="cb25-19" title="19">        <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb25-20" title="20">          <span class="dt">presets</span><span class="op">:</span> [<span class="st">&#39;react&#39;</span>]</a>
<a class="sourceLine" id="cb25-21" title="21">        <span class="op">}</span></a>
<a class="sourceLine" id="cb25-22" title="22">      <span class="op">}</span></a>
<a class="sourceLine" id="cb25-23" title="23">    ]</a>
<a class="sourceLine" id="cb25-24" title="24">  <span class="op">}</span></a>
<a class="sourceLine" id="cb25-25" title="25"><span class="op">};</span></a></code></pre></div>
<p>webpackを実行</p>
<p><code>dist\output.js</code>が出力されます。</p>
<pre><code>&gt; .\node_modules\.bin\webpack --config webpack.config.js
</code></pre>
<p><code>dist\index.html</code>を作成します。</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb27-1" title="1"><span class="dt">&lt;!DOCTYPE </span>html<span class="dt">&gt;</span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="kw">&lt;html</span><span class="ot"> lang=</span><span class="st">&quot;ja&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="kw">&lt;head&gt;</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="kw">&lt;meta</span><span class="ot"> http-equiv=</span><span class="st">&quot;X-UA-Compatible&quot;</span><span class="ot"> content=</span><span class="st">&quot;IE=edge&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="kw">&lt;title&gt;</span>webpack test<span class="kw">&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="kw">&lt;meta</span><span class="ot"> charset=</span><span class="st">&quot;utf-8&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="kw">&lt;meta</span><span class="ot"> name=</span><span class="st">&quot;viewport&quot;</span><span class="ot"> content=</span><span class="st">&quot;width=device-width, initial-scale=1&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb27-8" title="8"><span class="kw">&lt;/head&gt;</span></a>
<a class="sourceLine" id="cb27-9" title="9"><span class="kw">&lt;body&gt;</span></a>
<a class="sourceLine" id="cb27-10" title="10">  <span class="kw">&lt;div</span><span class="ot"> id=</span><span class="st">&quot;root&quot;</span><span class="kw">&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb27-11" title="11">  <span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;./output.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb27-12" title="12"><span class="kw">&lt;/body&gt;</span></a>
<a class="sourceLine" id="cb27-13" title="13"><span class="kw">&lt;/html&gt;</span></a></code></pre></div>
<p>ブラウザで表示。</p>
<p><code>output.js</code>の読み込みだけで表示されました。 動作に必要なスクリプト（<code>react.min.js</code>や<code>react-dom.min.js</code>）が、webpackによってすべて<code>output.js</code>に束ねられているからです。</p>
<h2 id="reactコンポーネント">Reactコンポーネント</h2>
<p>create-react-app による開発は、自動作成された「src\index.js」や、その中で読み込んでいる「src\App.js」を編集して動作を確かめます。 ファイルやフォルダを分けてコードを管理するのもありです。</p>
<h3 id="reactコンポーネントの種類">Reactコンポーネントの種類</h3>
<h4 id="functional-component">Functional Component</h4>
<p>関数によって定義されるコンポーネント。</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb28-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb28-2" title="2"></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="kw">const</span> Hello <span class="op">=</span> (props) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb28-4" title="4">  <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは、<span class="op">{</span><span class="va">props</span>.<span class="at">name</span><span class="op">}</span>さん&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="op">};</span></a></code></pre></div>
<h4 id="class-component">Class Component</h4>
<p>クラスによって定義されるコンポーネント。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">class</span> Hello <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb29-2" title="2">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb29-3" title="3">    <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは、<span class="op">{</span><span class="kw">this</span>.<span class="va">props</span>.<span class="at">name</span><span class="op">}</span>さん&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb29-4" title="4">  <span class="op">}</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="op">};</span></a></code></pre></div>
<h5 id="functional-componentとの違い">Functional Componentとの違い</h5>
<ul>
<li><code>React.Component</code>を明示的に継承している。</li>
<li>propsの受け取り方がthis.propsとなっている。</li>
<li>コンポーネントの状態を記録する仕組みがある（state）。</li>
<li>ライフサイクルメソッドという特殊なメソッドが定義できる。</li>
</ul>
<h3 id="コンポーネントの再利用">コンポーネントの再利用</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">const</span> Hello <span class="op">=</span> () <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb30-2" title="2">  <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは、坂本竜馬さん&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb30-3" title="3"><span class="op">};</span></a>
<a class="sourceLine" id="cb30-4" title="4"></a>
<a class="sourceLine" id="cb30-5" title="5"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb30-6" title="6">  <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb30-7" title="7">    <span class="op">&lt;</span>Hello /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb30-8" title="8">    <span class="op">&lt;</span>Hello /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb30-9" title="9">    <span class="op">&lt;</span>Hello /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb30-10" title="10">  &lt;/div<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb30-11" title="11">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;root&quot;</span>)</a>
<a class="sourceLine" id="cb30-12" title="12">)<span class="op">;</span></a></code></pre></div>
<p>Reactコンポーネント : 設計図のようなもの。 オブジェクト指向でいえば〝クラス〟にあたる。</p>
<p>Reactエレメント : 設計図（Reactコンポーネント）を元に作られた実体のこと。 オブジェクト指向でいえば〝インスタンス〟にあたる。</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb31-1" title="1"><span class="co">// こちらはReactコンポーネント</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">const</span> Hello <span class="op">=</span> () <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb31-3" title="3">  <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは、坂本竜馬さん&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="op">};</span></a>
<a class="sourceLine" id="cb31-5" title="5"></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb31-7" title="7">  <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb31-8" title="8">    <span class="op">{</span> <span class="co">/* 以下のHello3つはどれも React エレメント */</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb31-9" title="9">    <span class="op">&lt;</span>Hello /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb31-10" title="10">    <span class="op">&lt;</span>Hello /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb31-11" title="11">    <span class="op">&lt;</span>Hello /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb31-12" title="12">  &lt;/div<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb31-13" title="13">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;root&quot;</span>)</a>
<a class="sourceLine" id="cb31-14" title="14">)<span class="op">;</span></a></code></pre></div>
<h3 id="fragmentコンポーネント">Fragmentコンポーネント</h3>
<p>Reactコンポーネントは単一の親からなる要素しか表現できません。 複数の要素をラップする要素を使ってもよいのですが、これではもともと表現したかったHTML構造にならないことがあります。</p>
<p>React.Fragmentコンポーネントを使うとこの制約をクリアすることができます。</p>
<p>↓ ダメな例</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">const</span> Hello <span class="op">=</span> () <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb32-2" title="2">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb32-3" title="3">    <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb32-4" title="4">    <span class="op">&lt;</span>div<span class="op">&gt;</span>坂本竜馬さん&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb32-5" title="5">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb32-6" title="6"><span class="op">};</span></a></code></pre></div>
<p>↓ ラップして対処する方法</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">const</span> Hello <span class="op">=</span> () <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb33-2" title="2">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb33-3" title="3">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb33-4" title="4">      <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb33-5" title="5">      <span class="op">&lt;</span>div<span class="op">&gt;</span>坂本竜馬さん&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb33-6" title="6">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb33-7" title="7">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb33-8" title="8"><span class="op">};</span></a></code></pre></div>
<p>↓ <code>React.Fragment</code>で対処する方法</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">const</span> Hello <span class="op">=</span> () <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb34-2" title="2">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb34-3" title="3">    <span class="op">&lt;</span><span class="va">React</span>.<span class="at">Fragment</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb34-4" title="4">      <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb34-5" title="5">      <span class="op">&lt;</span>div<span class="op">&gt;</span>坂本竜馬さん&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb34-6" title="6">    &lt;/<span class="va">React</span>.<span class="at">Fragment</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb34-7" title="7">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="op">};</span></a></code></pre></div>
<h3 id="データの受け渡しprops">データの受け渡し（props）</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">const</span> Hello <span class="op">=</span> (props) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb35-2" title="2">  <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは、<span class="op">{</span><span class="va">props</span>.<span class="at">name</span><span class="op">}</span>さん&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb35-3" title="3"><span class="op">};</span></a>
<a class="sourceLine" id="cb35-4" title="4"></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb35-6" title="6">  <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb35-7" title="7">    <span class="op">&lt;</span>Hello name<span class="op">=</span><span class="st">&quot;A&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb35-8" title="8">    <span class="op">&lt;</span>Hello name<span class="op">=</span><span class="st">&quot;B&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb35-9" title="9">    <span class="op">&lt;</span>Hello name<span class="op">=</span><span class="st">&quot;C&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb35-10" title="10">  &lt;/div<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb35-11" title="11">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;root&quot;</span>)</a>
<a class="sourceLine" id="cb35-12" title="12">)<span class="op">;</span></a></code></pre></div>
<p>Helloの関数の引数に<code>props</code>を追加します。引数の名前はなんでもいいですが、<code>props</code>にするのが一般的。</p>
<p><code>props</code>の引数にはコンポーネントを使う側で指定した内容が入ります。</p>
<p>上記でいえば、<code>&lt;Hello name="A" /&gt;</code>として使っているので、<code>props</code>には<code>name</code>というプロパティが追加され、「A」が格納されます。同様に<code>&lt;Hello name="B" /&gt;</code>であれば、<code>props.name</code>の値は「B」になります。</p>
<p><code>props</code>には文字列、数値、配列、オブジェクト、関数など任意の値を指定できます。 渡す値は<code>{}</code>で囲みます。</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb36-1" title="1"><span class="co">// 文字列</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="op">&lt;</span>Component stringValue<span class="op">={</span> <span class="st">&quot;坂本竜馬&quot;</span> <span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb36-3" title="3"></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co">// 数値</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="op">&lt;</span>Component numberValue<span class="op">={</span><span class="dv">42</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb36-6" title="6"></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="co">// 真偽値</span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="op">&lt;</span>Component boolValue<span class="op">={</span><span class="kw">true</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb36-9" title="9"></a>
<a class="sourceLine" id="cb36-10" title="10"><span class="co">// 配列</span></a>
<a class="sourceLine" id="cb36-11" title="11"><span class="op">&lt;</span>Component arrayValue<span class="op">={</span>[<span class="st">&quot;Aさん&quot;</span><span class="op">,</span> <span class="st">&quot;Bさん&quot;</span><span class="op">,</span> <span class="st">&quot;Cさん&quot;</span>]<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb36-12" title="12"></a>
<a class="sourceLine" id="cb36-13" title="13"><span class="co">// オブジェクト</span></a>
<a class="sourceLine" id="cb36-14" title="14"><span class="op">&lt;</span>Component objectValue<span class="op">={{</span><span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Aさん&quot;</span><span class="op">,</span> <span class="dt">birthDay</span><span class="op">:</span> <span class="st">&quot;1836/01/03&quot;</span><span class="op">}}</span> /&gt;</a>
<a class="sourceLine" id="cb36-15" title="15"></a>
<a class="sourceLine" id="cb36-16" title="16"><span class="co">// 関数</span></a>
<a class="sourceLine" id="cb36-17" title="17"><span class="op">&lt;</span>Component funcValue<span class="op">={</span>(name) <span class="op">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(name)<span class="op">;}</span> /&gt;</a>
<a class="sourceLine" id="cb36-18" title="18"></a>
<a class="sourceLine" id="cb36-19" title="19"><span class="co">// 変数</span></a>
<a class="sourceLine" id="cb36-20" title="20"><span class="kw">const</span> name <span class="op">=</span> <span class="st">&quot;Aさん&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb36-21" title="21"><span class="op">&lt;</span>Component value<span class="op">={</span>name<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb36-22" title="22"></a>
<a class="sourceLine" id="cb36-23" title="23"><span class="co">// 複数の値も渡せます</span></a>
<a class="sourceLine" id="cb36-24" title="24"><span class="op">&lt;</span>Component name<span class="op">={</span> <span class="st">&quot;Aさん&quot;</span> <span class="op">}</span> birthDay<span class="op">={</span> <span class="kw">new</span> <span class="at">Date</span>(<span class="dv">1836</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">3</span>) <span class="op">}</span> /&gt;</a></code></pre></div>
<p><code>props.children</code></p>
<p>Reactコンポーネントの子要素が渡されるプロパティです。</p>
<p>次の場合、<code>props.children</code>には「坂本竜馬」が渡されます。</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">const</span> Hello <span class="op">=</span> (props) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb37-2" title="2">  <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは、<span class="op">{</span><span class="va">props</span>.<span class="at">children</span><span class="op">}</span>さん&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="op">};</span></a>
<a class="sourceLine" id="cb37-4" title="4"></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb37-6" title="6">  <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb37-7" title="7">    <span class="op">&lt;</span>Hello<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb37-8" title="8">      坂本竜馬      ←Helloコンポーネントの子要素が渡される</a>
<a class="sourceLine" id="cb37-9" title="9">    &lt;/Hello<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb37-10" title="10">  &lt;/div<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb37-11" title="11">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&quot;root&quot;</span>)</a>
<a class="sourceLine" id="cb37-12" title="12">)<span class="op">;</span></a></code></pre></div>
<h3 id="propsの型チェック">propsの型チェック</h3>
<p>コンポーネントがどのようなpropsを受け取るのか記述することができます。 インターフェイスに合わない値が渡されたときに、エディタや実行時に警告を受け取ることができます。</p>
<p>別パッケージになっているので追加でインストールします。</p>
<pre><code>&gt; npm install --save prop-types
</code></pre>
<p>ReactコンポーネントのpropTypesプロパティに型情報を記述します。 Functional Component/Class Componentのどちらでも記述できます。</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb39-1" title="1"><span class="im">import</span> PropTypes <span class="im">from</span> <span class="st">&#39;prop-types&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb39-2" title="2"></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="kw">const</span> Hello <span class="op">=</span> (props) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb39-4" title="4">  <span class="cf">return</span> <span class="op">&lt;</span>div<span class="op">&gt;</span>こんにちは、<span class="op">{</span><span class="va">props</span>.<span class="at">name</span><span class="op">}</span>さん&lt;/div<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb39-5" title="5"><span class="op">};</span></a>
<a class="sourceLine" id="cb39-6" title="6"></a>
<a class="sourceLine" id="cb39-7" title="7"><span class="co">// ここに型情報を書きます</span></a>
<a class="sourceLine" id="cb39-8" title="8"><span class="co">// ↓</span></a>
<a class="sourceLine" id="cb39-9" title="9"><span class="va">Hello</span>.<span class="at">propTypes</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb39-10" title="10">  <span class="dt">name</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">string</span>    <span class="co">// nameの型はstring</span></a>
<a class="sourceLine" id="cb39-11" title="11"><span class="op">}</span></a></code></pre></div>
<p>propTypesの種類</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb40-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="im">import</span> PropTypes <span class="im">from</span> <span class="st">&#39;prop-types&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb40-3" title="3"></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="kw">class</span> SomeComponent <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="op">}</span></a>
<a class="sourceLine" id="cb40-6" title="6"></a>
<a class="sourceLine" id="cb40-7" title="7"><span class="va">SomeComponent</span>.<span class="at">propTypes</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb40-8" title="8">  <span class="dt">someString</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">string</span><span class="op">,</span> <span class="co">// 文字列</span></a>
<a class="sourceLine" id="cb40-9" title="9">  <span class="dt">someNumber</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">number</span><span class="op">,</span> <span class="co">// 数値</span></a>
<a class="sourceLine" id="cb40-10" title="10">  <span class="dt">someBool</span><span class="op">:</span>   <span class="va">PropTypes</span>.<span class="at">bool</span><span class="op">,</span>   <span class="co">// 真偽値</span></a>
<a class="sourceLine" id="cb40-11" title="11">  <span class="dt">someArray</span><span class="op">:</span>  <span class="va">PropTypes</span>.<span class="at">array</span><span class="op">,</span>  <span class="co">// 配列</span></a>
<a class="sourceLine" id="cb40-12" title="12">  <span class="dt">someObject</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">object</span><span class="op">,</span> <span class="co">// オブジェクト</span></a>
<a class="sourceLine" id="cb40-13" title="13">  <span class="dt">someFunc</span><span class="op">:</span>   <span class="va">PropTypes</span>.<span class="at">func</span><span class="op">,</span>   <span class="co">// 関数</span></a>
<a class="sourceLine" id="cb40-14" title="14">  <span class="dt">someSymbol</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">symbol</span><span class="op">,</span> <span class="co">// シンボル</span></a>
<a class="sourceLine" id="cb40-15" title="15">  </a>
<a class="sourceLine" id="cb40-16" title="16">  <span class="co">// 配列の中身を指定</span></a>
<a class="sourceLine" id="cb40-17" title="17">  <span class="dt">someArray2</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">arayOf</span>(<span class="va">PropTypes</span>.<span class="at">number</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb40-18" title="18">  </a>
<a class="sourceLine" id="cb40-19" title="19">  <span class="co">// オブジェクトの中身を指定</span></a>
<a class="sourceLine" id="cb40-20" title="20">  <span class="dt">someObj2</span><span class="op">:</span>   <span class="va">PropTypes</span>.<span class="at">objectOf</span>(<span class="va">PropTypes</span>.<span class="at">number</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb40-21" title="21">  </a>
<a class="sourceLine" id="cb40-22" title="22">  <span class="co">// オブジェクトの個別のプロパティの中身を指定</span></a>
<a class="sourceLine" id="cb40-23" title="23">  <span class="dt">someObj3</span><span class="op">:</span>   <span class="va">PropTypes</span>.<span class="at">shape</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb40-24" title="24">    <span class="dt">name</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">string</span><span class="op">,</span></a>
<a class="sourceLine" id="cb40-25" title="25">    <span class="dt">age</span><span class="op">:</span>  <span class="va">PropTypes</span>.<span class="at">number</span></a>
<a class="sourceLine" id="cb40-26" title="26">  <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb40-27" title="27">  </a>
<a class="sourceLine" id="cb40-28" title="28">  <span class="co">// Reactエレメント</span></a>
<a class="sourceLine" id="cb40-29" title="29">  <span class="dt">someElement</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">element</span><span class="op">,</span></a>
<a class="sourceLine" id="cb40-30" title="30">  </a>
<a class="sourceLine" id="cb40-31" title="31">  <span class="co">// コンポーネントの子要素となるもの</span></a>
<a class="sourceLine" id="cb40-32" title="32">  <span class="co">// （string, number, element, array ならOK）</span></a>
<a class="sourceLine" id="cb40-33" title="33">  <span class="dt">someNode</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">node</span><span class="op">,</span></a>
<a class="sourceLine" id="cb40-34" title="34">  </a>
<a class="sourceLine" id="cb40-35" title="35">  <span class="co">// Helloコンポーネントのインスタンスを指定</span></a>
<a class="sourceLine" id="cb40-36" title="36">  <span class="dt">helloElement</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">instanceOf</span>(Hello)<span class="op">,</span></a>
<a class="sourceLine" id="cb40-37" title="37">  </a>
<a class="sourceLine" id="cb40-38" title="38">  <span class="co">// 指定した値のいずれかであること</span></a>
<a class="sourceLine" id="cb40-39" title="39">  <span class="dt">dayOfTheWeek</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">oneOf</span>([<span class="st">&quot;月&quot;</span><span class="op">,</span> <span class="st">&quot;火&quot;</span><span class="op">,</span> <span class="st">&quot;水&quot;</span>])<span class="op">,</span></a>
<a class="sourceLine" id="cb40-40" title="40">  </a>
<a class="sourceLine" id="cb40-41" title="41">  <span class="co">// 配列で指定した型のいずれかであること</span></a>
<a class="sourceLine" id="cb40-42" title="42">  <span class="dt">union</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">oneOfType</span>([</a>
<a class="sourceLine" id="cb40-43" title="43">    <span class="va">PropTypes</span>.<span class="at">string</span><span class="op">,</span></a>
<a class="sourceLine" id="cb40-44" title="44">    <span class="va">PropTypes</span>.<span class="at">number</span><span class="op">,</span></a>
<a class="sourceLine" id="cb40-45" title="45">    <span class="va">PropTypes</span>.<span class="at">instanceOf</span>(Hello)<span class="op">,</span></a>
<a class="sourceLine" id="cb40-46" title="46">  ])<span class="op">,</span></a>
<a class="sourceLine" id="cb40-47" title="47">  </a>
<a class="sourceLine" id="cb40-48" title="48">  <span class="co">// 何でもオーケー</span></a>
<a class="sourceLine" id="cb40-49" title="49">  <span class="dt">any</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">any</span><span class="op">,</span></a>
<a class="sourceLine" id="cb40-50" title="50">  </a>
<a class="sourceLine" id="cb40-51" title="51">  <span class="co">// 必須項目</span></a>
<a class="sourceLine" id="cb40-52" title="52">  <span class="dt">requiredString</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb40-53" title="53">  </a>
<a class="sourceLine" id="cb40-54" title="54">  <span class="co">// どんな型でもいいから何かしら指定</span></a>
<a class="sourceLine" id="cb40-55" title="55">  <span class="dt">requiredAny</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">any</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb40-56" title="56"><span class="op">};</span></a>
<a class="sourceLine" id="cb40-57" title="57"></a>
<a class="sourceLine" id="cb40-58" title="58"><span class="co">// propsの値が undefined だったときの規定値を指定する</span></a>
<a class="sourceLine" id="cb40-59" title="59"><span class="va">SomeComponent</span>.<span class="at">defaultProps</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb40-60" title="60">  <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;坂本竜馬&quot;</span>    <span class="co">// name が undefined のときに設定する内容</span></a>
<a class="sourceLine" id="cb40-61" title="61"><span class="op">};</span></a></code></pre></div>
<p><code>Array.map</code>メソッド : 配列の各要素について、引数に与えられた関数の処理に従って処理をし、新たな配列を返すメソッド。</p>
<pre><code>~~~javascript
// tasksの各要素をTodoItemコンポーネントにして返す
const list = this.props.tasks.map(todo =&gt; {
  return &lt;TodoItem {...todo} key={todo.id} /&gt;;
});
~~~
</code></pre>
<h3 id="stateの初期値">stateの初期値</h3>
<p><code>constructor</code>で設定します。</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb42-1" title="1"><span class="at">constructor</span>(props) <span class="op">{</span></a>
<a class="sourceLine" id="cb42-2" title="2">  <span class="kw">super</span>(props)<span class="op">;</span></a>
<a class="sourceLine" id="cb42-3" title="3">  <span class="kw">this</span>.<span class="at">state</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb42-4" title="4">    <span class="dt">tasks</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb42-5" title="5">      <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;Todo-1&quot;</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="dv">0</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb42-6" title="6">      <span class="op">{</span> <span class="dt">title</span><span class="op">:</span> <span class="st">&quot;Todo-2&quot;</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="dv">1</span> <span class="op">},</span></a>
<a class="sourceLine" id="cb42-7" title="7">    ]<span class="op">,</span></a>
<a class="sourceLine" id="cb42-8" title="8">    <span class="dt">uniqueId</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></a>
<a class="sourceLine" id="cb42-9" title="9">  <span class="op">};</span></a>
<a class="sourceLine" id="cb42-10" title="10"><span class="op">}</span></a></code></pre></div>
<ul>
<li><code>state</code>の名前は変更できません。</li>
<li><code>this.state</code>に直接値を入れていいのは<code>constructor</code>で初期値を設定するときだけです。 それ以外の場面で直接編集してしまうと、Reactコンポーネントに値の変更を通知することができません。</li>
<li><code>this.state</code>を更新するときは<code>this.setState</code>メソッドを使います。 いまあるstateと比べて、変更があった内容を反映します。stateをごっそり置き換えるわけではありません。</li>
<li><code>this.state</code>を直接参照するのはありです。</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb43-1" title="1"><span class="at">constructor</span>(props) <span class="op">{</span></a>
<a class="sourceLine" id="cb43-2" title="2">  ...<span class="at">略</span></a>
<a class="sourceLine" id="cb43-3" title="3">  </a>
<a class="sourceLine" id="cb43-4" title="4">  <span class="co">// bindメソッド</span></a>
<a class="sourceLine" id="cb43-5" title="5">  <span class="co">// 指定したメソッドでAppコンポーネントのstateを変更するために必要</span></a>
<a class="sourceLine" id="cb43-6" title="6">  <span class="co">// ↓</span></a>
<a class="sourceLine" id="cb43-7" title="7">  <span class="kw">this</span>.<span class="at">methodName</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">methodName</span>.<span class="at">bind</span>(<span class="kw">this</span>)<span class="op">;</span></a></code></pre></div>
<p><code>bind</code>メソッド : 関数の中で使用する<code>this</code>を強制する（バインドする）メソッド。</p>
<pre><code>methodNameメソッドを実行するのは、Appコンポーネントではない別のコンポーネントやDOMになります。
それらのコンテキストである`this`には`state`が存在しないのでエラーが発生します。
</code></pre>
<p>ほかのバインドの方法</p>
<ul>
<li><p>アロー関数を使う</p>
<p>アロー関数を使うときは、constructorにbindメソッドを書く必要がありません。 ですが、同じメソッドを複数のコンポーネントに渡したい場合、その数だけアロー関数を書く必要があります。</p>
<p>毎回新しいアロー関数を作ることになるので、パフォーマンスも少し劣ります。</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb45-1" title="1"><span class="co">// アロー関数を使う</span></a>
<a class="sourceLine" id="cb45-2" title="2"><span class="op">&lt;</span>Component methodName<span class="op">={</span> (hoge) <span class="op">=&gt;</span> <span class="op">{</span> <span class="kw">this</span>.<span class="at">methodName</span>(hoge) <span class="op">}</span> <span class="op">}</span> /&gt;</a></code></pre></div></li>
<li><p>property initializer syntax を使う</p>
<p>最初からバインドされたメソッドを作ることができます。 アロー関数のようなパフォーマンスの懸念もありません。</p>
<p>ただし、ECMAScriptに公式なシンタックスとして採用されていないため、babelにプラグインを追加しておく必要があります。</p>
<p>Class properties transform・Babel（transform-class-properties）</p></li>
</ul>
<h3 id="イベントハンドリング">イベントハンドリング</h3>
<p>イベントハンドラを追加します。</p>
<p>下記の例では、クリック時のイベントを<code>handleClick</code>メソッドに定義しています。 イベントとの関連付けは、button要素のonClick属性に<code>handleClick</code>メソッドを設定しています。</p>
<p>Reactでは<code>onClick</code>といった属性に関数を渡して、イベントの関連付けをします。</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb46-1" title="1"><span class="at">constructor</span>(props) <span class="op">{</span></a>
<a class="sourceLine" id="cb46-2" title="2">  <span class="kw">super</span>(props)<span class="op">;</span></a>
<a class="sourceLine" id="cb46-3" title="3">  <span class="kw">this</span>.<span class="at">handleClick</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">handleClick</span>.<span class="at">bind</span>(<span class="kw">this</span>)<span class="op">;</span>   <span class="co">// バインドする</span></a>
<a class="sourceLine" id="cb46-4" title="4"><span class="op">}</span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="co">// Eventオブジェクトを引数に持つ</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="at">handleClick</span>(e) <span class="op">{</span></a>
<a class="sourceLine" id="cb46-7" title="7">  <span class="kw">this</span>.<span class="va">props</span>.<span class="at">methodName</span>(<span class="st">&quot;hoge&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb46-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb46-9" title="9"><span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb46-10" title="10">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb46-11" title="11">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb46-12" title="12">      <span class="op">&lt;</span>input placeholder<span class="op">=</span><span class="st">&quot;何か入力してください&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb46-13" title="13">      <span class="op">&lt;</span>button onClick<span class="op">={</span> <span class="kw">this</span>.<span class="at">handleClick</span> <span class="op">}</span> <span class="op">&gt;</span>登録&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb46-14" title="14">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb46-15" title="15"><span class="op">}</span></a></code></pre></div>
<p>イベントハンドラの引数は、Eventオブジェクトを受け取ります。 ブラウザ本来のEventオブジェクトとほぼ同じものです。</p>
<h3 id="formの操作">formの操作</h3>
<p>Reactではフォームに入力された値も<code>state</code>として扱います。</p>
<p>以下は、ユーザーの入力で state を変更するコードです。</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb47-1" title="1"><span class="at">constructor</span>(props) <span class="op">{</span></a>
<a class="sourceLine" id="cb47-2" title="2">  <span class="kw">super</span>(props)<span class="op">;</span></a>
<a class="sourceLine" id="cb47-3" title="3">  <span class="kw">this</span>.<span class="at">state</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb47-4" title="4">    <span class="dt">inputValue</span><span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb47-5" title="5">  <span class="op">};</span></a>
<a class="sourceLine" id="cb47-6" title="6">  <span class="kw">this</span>.<span class="at">handleChange</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">handleChange</span>.<span class="at">bind</span>(<span class="kw">this</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb47-7" title="7">  <span class="kw">this</span>.<span class="at">handleClick</span> <span class="op">=</span> <span class="kw">this</span>.<span class="va">handleClick</span>.<span class="at">bind</span>(<span class="kw">this</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb47-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb47-9" title="9"><span class="at">handleChange</span>(e) <span class="op">{</span></a>
<a class="sourceLine" id="cb47-10" title="10">  <span class="co">// ユーザーの入力した値をstate.inputValueに格納する</span></a>
<a class="sourceLine" id="cb47-11" title="11">  <span class="kw">this</span>.<span class="at">setState</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb47-12" title="12">    <span class="dt">inputValue</span><span class="op">:</span> <span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span><span class="op">,</span></a>
<a class="sourceLine" id="cb47-13" title="13">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb47-14" title="14"><span class="op">}</span></a>
<a class="sourceLine" id="cb47-15" title="15"><span class="at">handleClick</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb47-16" title="16">  <span class="kw">const</span> inputValue <span class="op">=</span> <span class="kw">this</span>.<span class="va">state</span>.<span class="at">inputValue</span><span class="op">;</span></a>
<a class="sourceLine" id="cb47-17" title="17">  <span class="kw">this</span>.<span class="va">props</span>.<span class="at">methodName</span>(inputValue)<span class="op">;</span></a>
<a class="sourceLine" id="cb47-18" title="18"><span class="op">}</span></a>
<a class="sourceLine" id="cb47-19" title="19"><span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb47-20" title="20">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb47-21" title="21">    <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;TodoInput&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb47-22" title="22">      <span class="va">▼valueにstate</span>.<span class="at">inputValueを設定、onChangeにhandleChangeメソッドを関連付け</span></a>
<a class="sourceLine" id="cb47-23" title="23">      <span class="op">&lt;</span>input placeholder<span class="op">=</span><span class="st">&quot;何か入力してください&quot;</span> value<span class="op">={</span><span class="kw">this</span>.<span class="va">state</span>.<span class="at">inputValue</span><span class="op">}</span> onChange<span class="op">={</span><span class="kw">this</span>.<span class="at">handleChange</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb47-24" title="24">      <span class="op">&lt;</span>button onClick<span class="op">={</span><span class="kw">this</span>.<span class="at">handleClick</span><span class="op">}</span> <span class="op">&gt;</span>登録&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb47-25" title="25">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb47-26" title="26">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb47-27" title="27"><span class="op">}</span></a></code></pre></div>
<h3 id="まとめ-reactコンポーネントの作成手順">まとめ: Reactコンポーネントの作成手順</h3>
<ol>
<li>UIをコンポーネントに分割する</li>
<li>propsやstateによって、どのようにUIが変化するかを定義する（JSXの作成）</li>
<li>ユーザー操作によって、どのようにstateが変化するかを定義する（メソッドの作成）</li>
<li>UIとメソッドを関連付ける（onClick属性などを設定）</li>
</ol>
<p>コンポーネントごとの責務を明らかにすること。</p>
<h3 id="ライフサイクル">ライフサイクル</h3>
<p>Reactコンポーネントにはライフサイクルメソッドと呼ばれる特殊なメソッドがあります。 Reactコンポーネントの状態に応じて、次の3つのうち対応するメソッドが呼ばれます。</p>
<ul>
<li>コンポーネントのマウントに対応して呼ばれるメソッド。</li>
<li>コンポーネントで扱うデータの変化に対応して呼ばれるメソッド。</li>
<li>エラーハンドリングに用いるメソッド。</li>
</ul>
<h4 id="マウントに関するライフサイクルメソッド">マウントに関するライフサイクルメソッド</h4>
<p>Reactコンポーネントが新しく配置されるときに呼び出されるメソッドです。 コンポーネントの<code>render</code>メソッドが初めて呼ばれたときに、コンポーネントがマウントされた状態となります。</p>
<ul>
<li>コンポーネントのマウント ＝ コンポーネントの<code>render</code>メソッドが初めて呼ばれたとき</li>
<li>コンポーネントのアップデート ＝ 2回目以降の<code>render</code>メソッドの呼び出し</li>
<li>コンポーネントのアンマウント ＝ DOM上からなくなったとき</li>
</ul>
<p>componentWillMount : コンポーネントがマウントされる直前に呼ばれます。 コンポーネントを描画する<code>render</code>メソッドよりも先に呼ばれます。</p>
<pre><code>ただ、コンストラクターも`render`メソッドより先に呼ばれるので、マウント前にしたい処理はここではなくコンストラクターで実行すれば十分です。
</code></pre>
<p>componentDidMount : コンポーネントがマウントされた直後に呼ばれます。 DOMがブラウザにレンダリングされたあとなので、DOMに対してイベントリスナーを設定したりサブスクライブなどの処理をしたりします。</p>
<pre><code>TODO: サブスクライブって何でしょう？？

`setState`は行わないこと。

stateが変更されるとrenderメソッドが実行されます。
render → componentDidMount → setState → renderとなり、renderメソッドが2回実行されてしまうためです。
</code></pre>
<p>componentWillUnmount : コンポーネントがアンマウントされる直前に呼ばれます。 各種コンポーネントに関連付けた処理の後始末をします。</p>
<pre><code>たとえば、setInterval関数に対するclearIntervalの実行や、APIリクエストのキャンセルなどです。
</code></pre>
<h4 id="データのアップデートに関するライフサイクルメソッド">データのアップデートに関するライフサイクルメソッド</h4>
<p>アップデートはコンポーネントのpropsかstateが変更されたときに行われます。 初回のレンダリングはマウントとして扱われるため、マウント時にはこれらのメソッドは実行されません。</p>
<p>componentWillReceiveProps : 引数に受け取る予定のpropsをとります。</p>
<pre><code>~~~javascript
componentWillReceiveProps(nextProps)
~~~

propsがアップデートされようとしているときのみ実行されます。
propsの受け取りで実行されるため、変更の有無は関係なく実行されます。

this.propsには以前に受け取ったpropsが入っています。
引数のnextPropsと比較する処理をすることができます。

setStateをすることも可能です。
</code></pre>
<p>shouldComponentUpdate : propsやstateに変更が合った場合に呼ばれます。 引数は次に受け取るpropsとstateです。 this.propsとthis.stateには前回の内容が入っています。</p>
<pre><code>~~~javascript
shouldComponentUpdate(nextProps, nextStaet)
~~~

renderを行うべきかどうかをtrue/falseで返す必要があります。

このメソッドを指定しなかった場合、どのような変更でもrenderメソッドが呼び出されます（常にtrueを返すように指定したのと同じ）。

このメソッドはパフォーマンスチューニングをする際に利用します。
表示に使っていないpropを受け取ったときや、そもそもpropsやstateに変更がなかったときは不要なrenderを行わないようにします。

変更がないpropやstateを受け取ったときに再描画させないようにするもう一つの方法。

`React.Component`を継承する代わりに`React.PureComponent`を継承すると、Reactが自動的に浅い比較（オブジェクトや配列の中身までは確認しない比較）を行うので、通常はこちらを利用する方が便利です。
なにか特別な比較を行い、renderの有無を決めるときだけ`shouldComponentUpdate`を利用することを推奨します。
</code></pre>
<p>componentWillUpdate : renderが呼ばれる前に呼ばれる最後のメソッドです。</p>
<pre><code>引数は次に受け取るpropsとstateです。
this.propsとthis.stateには前回の内容が入っています。

~~~javascript
componentWillUpdate(nextProps, nextStaet)
~~~

`setState`などコンポーネントの再レンダリングを促すような処理はしないこと。
変更に対して`componentWillUpdate`、`render`が実行され、処理がループする可能性があるためです。

propsの値を使ってstateを変更したいときは`componentWillReceiveProps`メソッドを使います。

`shouldComponentUpdate`でfalseを返した場合、このメソッドは呼ばれません。
</code></pre>
<p>componentDidUpdate : renderの直後に呼ばれます。</p>
<pre><code>引数は前のpropsとstateです。
this.propsとthis.stateは、いまの値（renderに使った内容）が格納されています。

~~~javascript
componentDidUpdate(prevProps, prevStaet)
~~~

アップデート後のDOMにアクセスするときや、変更が完了したことをAPIに通知するときなどに利用します。

`shouldComponentUpdate`でfalseを返した場合、このメソッドは呼ばれません。
</code></pre>
<h4 id="エラーハンドリングに関するライフサイクルメソッド">エラーハンドリングに関するライフサイクルメソッド</h4>
<p>エラーが起きたときだけ呼ばれるライフサイクルメソッドです。 React v16 から実装されています。</p>
<p>componentDidCatch : 子コンポーネントでエラーが起こったときに呼ばれます。</p>
<pre><code>~~~Javascript
componentDidCatch(error, info)
~~~

引数にスタックとレースが入ったerror、その他の情報が入ったinfoをとります。

infoはオブジェクトで、現時点では`componentStack`プロパティしか持っていません。
これにはどのコンポーネントでエラーが発生したかが入っています。

エラー解析の手がかりとなるので、どちらもログとして送信するようにしておくと便利。

`setState`などの処理を行うことも可能。

このメソッドを記述したコンポーネント自体のエラーは検知できません。
子コンポーネントのエラーを検知するためのメソッドです。
</code></pre>
<h2 id="reduxによるアプリケーションの状態管理">Reduxによるアプリケーションの状態管理</h2>
<p><code>create-react-app</code>で新しいアプリケーションを作成します。</p>
<h3 id="reduxのインストール">Reduxのインストール</h3>
<pre><code>&gt; npm install --save redux
</code></pre>
<h3 id="reduxの構成">Reduxの構成</h3>
<p>Store : アプリケーションの状態（<code>state</code>）とロジックを保持している居場所。</p>
<p>Reducer : Storeが保持している状態を変化させるための関数。</p>
<p>Action : 何らかの状態変化を引き起こす現象。たとえば、ユーザー入力、APIから取得した情報。</p>
<pre><code>Actionの形式を標準化した〝Flux Standard Action〟というものがあります。
Actionを扱うライブラリ（`redux-actions`や`redux-promise`など）でも、これを採用したものが多いので、この形式に沿っておくのがよいでしょう。

Actionオブジェクトには、次のプロパティを持たせることができます。

- type
  
  必須プロパティです。
  どのような操作をしたのかが分かる内容を指定します。

- payload
  
  Actionに伴うデータ。オブジェクト形式で扱うのが一般的。
  errorプロパティがtrueのときはErrorオブジェクトを返すべき。
  
- error
  
  エラーを表現するときはtrueにします。
  
- meta
  
  payloadとは別に、ほかの情報をActionとして含めたいときに使う項目です。
</code></pre>
<h3 id="reducerの定義">Reducerの定義</h3>
<p>Storeの初期状態［index.js］</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">const</span> initialState <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb58-2" title="2">  <span class="dt">tasks</span><span class="op">:</span> []</a>
<a class="sourceLine" id="cb58-3" title="3"><span class="op">};</span></a></code></pre></div>
<p>tasksReducerの定義［index.js］</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb59-1" title="1"><span class="co">// Reducerの定義</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="co">// 第1引数は、現在の状態を表すstateオブジェクト</span></a>
<a class="sourceLine" id="cb59-3" title="3"><span class="co">// 第2引数は、どのような操作をしたのかを示すActionオブジェクト</span></a>
<a class="sourceLine" id="cb59-4" title="4"><span class="kw">function</span> <span class="at">tasksReducer</span>(state <span class="op">=</span> initialState<span class="op">,</span> action) <span class="op">{</span></a>
<a class="sourceLine" id="cb59-5" title="5">  <span class="cf">switch</span> (<span class="va">action</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb59-6" title="6">    <span class="cf">case</span> <span class="st">&#39;ADD_TASK&#39;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb59-7" title="7">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb59-8" title="8">        ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb59-9" title="9">        <span class="dt">tasks</span><span class="op">:</span> <span class="va">state</span>.<span class="va">tasks</span>.<span class="at">concat</span>([<span class="va">action</span>.<span class="at">task</span>])    <span class="co">// </span><span class="al">TODO</span><span class="co">: action.payload.taskでは？　→　そのとおりでした。</span></a>
<a class="sourceLine" id="cb59-10" title="10">      <span class="op">};</span></a>
<a class="sourceLine" id="cb59-11" title="11">    <span class="dt">default</span><span class="op">:</span></a>
<a class="sourceLine" id="cb59-12" title="12">      <span class="cf">return</span> state<span class="op">;</span></a>
<a class="sourceLine" id="cb59-13" title="13">  <span class="op">}</span></a>
<a class="sourceLine" id="cb59-14" title="14"><span class="op">}</span></a></code></pre></div>
<p>Actionオブジェクトのイメージ</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb60-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb60-2" title="2">  <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;ADD_TASK&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb60-3" title="3">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb60-4" title="4">    <span class="dt">task</span><span class="op">:</span> <span class="st">&#39;Study Reducer&#39;</span></a>
<a class="sourceLine" id="cb60-5" title="5">  <span class="op">}</span></a>
<a class="sourceLine" id="cb60-6" title="6"><span class="op">}</span></a></code></pre></div>
<h3 id="actioncreatorの定義">ActionCreatorの定義</h3>
<p>ActionCreatorとはActionを生成するための関数です。</p>
<p>Actionを生成する関数の定義［index.js］</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb61-1" title="1"><span class="co">// ActionCreatorの定義</span></a>
<a class="sourceLine" id="cb61-2" title="2"><span class="co">// 追加するtaskを引数に取り、Actionオブジェクトを返す</span></a>
<a class="sourceLine" id="cb61-3" title="3"><span class="kw">const</span> addTask <span class="op">=</span> (task) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb61-4" title="4">  <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;ADD_TASK&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb61-5" title="5">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb61-6" title="6">    task</a>
<a class="sourceLine" id="cb61-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb61-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="storeの定義">Storeの定義</h3>
<p>Reduxの<code>createStore</code>関数を使ってStoreを生成します。 生成したStoreはアプリケーション内で唯一のものです。 アプリケーション全体のさまざまな状態をこのStoreで集約管理します。</p>
<p>ReduxのStoreを生成するにはReducerが必要となります。</p>
<p>Storeの作成［index.js］</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb62-1" title="1"><span class="im">import</span> <span class="op">{</span> createStore <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb62-2" title="2"></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="co">// Reducerの定義</span></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="kw">function</span> <span class="at">tasksReducer</span>(state <span class="op">=</span> initialState<span class="op">,</span> action) <span class="op">{</span></a>
<a class="sourceLine" id="cb62-5" title="5">  <span class="co">// ...略</span></a>
<a class="sourceLine" id="cb62-6" title="6"><span class="op">}</span></a>
<a class="sourceLine" id="cb62-7" title="7"></a>
<a class="sourceLine" id="cb62-8" title="8"><span class="co">// Storeの生成</span></a>
<a class="sourceLine" id="cb62-9" title="9"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(tasksReducer)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb63-1" title="1"><span class="at">createStore</span>(reducer<span class="op">,</span> [preloadedState]<span class="op">,</span> [enhancer])</a></code></pre></div>
<p>引数</p>
<p>reducer : Reducerを指定します。</p>
<p>preloadedState : Storeの初期値を指定します。 サーバーサイドやユーザーセッションで事前にデータを保持しているときに利用することが想定されます。</p>
<p>enhancer : Storeの機能を拡張するサードパーティ製のツールを指定できます。</p>
<p>戻り値</p>
<p>Storeオブジェクト</p>
<p>Storeオブジェクトは次の4つのメソッドを持ちます。</p>
<ul>
<li><p>dispatch</p>
<p>ActionCreatorで生成したActionを発行します。</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb64-1" title="1"><span class="co">// ActionCreatorの定義</span></a>
<a class="sourceLine" id="cb64-2" title="2"><span class="kw">const</span> addTask <span class="op">=</span> (task) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb64-3" title="3">  ... <span class="at">略</span></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb64-5" title="5"></a>
<a class="sourceLine" id="cb64-6" title="6"><span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">addTask</span>(<span class="st">&quot;Study Store&quot;</span>))<span class="op">;</span></a></code></pre></div></li>
<li><p>getState</p>
<p>Storeの現在の状態を取得します。</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb65-1" title="1"><span class="va">console</span>.<span class="at">log</span>(<span class="va">store</span>.<span class="at">getState</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb65-2" title="2">↓</a>
<a class="sourceLine" id="cb65-3" title="3"><span class="op">{</span></a>
<a class="sourceLine" id="cb65-4" title="4">  <span class="dt">tasks</span><span class="op">:</span> [<span class="st">&#39;Study Store&#39;</span>]</a>
<a class="sourceLine" id="cb65-5" title="5"><span class="op">}</span></a></code></pre></div></li>
<li><p>subscribe</p>
<p>Storeの状態が変更されたときに呼び出されるコールバック関数を指定します。</p>
<p>ActionのdispatchによってStoreの状態が変わったときに、その変換を監視する役目を担う処理。</p>
<p><code>store.subscribe</code>で監視を開始します。 <code>store.subscribe</code>の戻り値である<code>unsubscribe</code>を実行することで、<code>subscribe</code>を解除することができます。</p>
<p>実際にReactと組み合わせるときは、<code>react-redux</code>というライブラリを使います。 <code>react-redux</code>が<code>subscribe</code>の仕組みを隠蔽するため、Storeの状態が変化するとReactのViewが更新されるというシンプルな流れになります。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">function</span> <span class="at">handleChange</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb66-2" title="2">  <span class="va">console</span>.<span class="at">log</span>(<span class="va">store</span>.<span class="at">getState</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb66-3" title="3"><span class="op">}</span></a>
<a class="sourceLine" id="cb66-4" title="4"></a>
<a class="sourceLine" id="cb66-5" title="5"><span class="co">// Storeの状態が変化したときに handleChange 関数が呼ばれる。</span></a>
<a class="sourceLine" id="cb66-6" title="6"><span class="co">// subscribeの戻り値は unsubscribe という関数。</span></a>
<a class="sourceLine" id="cb66-7" title="7"><span class="co">// これを実行すると状態変化の通知が解除され、handleChange 関数は呼ばれなくなる。</span></a>
<a class="sourceLine" id="cb66-8" title="8"><span class="kw">const</span> unsubscribe <span class="op">=</span> <span class="va">store</span>.<span class="at">subscribe</span>(handleChange)<span class="op">;</span></a></code></pre></div></li>
<li><p>replaceReducer</p>
<p>createStoreで関連付けたReducerを、別のReducerに差し替えるメソッドです。</p>
<p>createStoreで関連付けることができるReducerは1つだけです。 複数あるReducerを動的にロードしたいときにこのメソッドで差し替えをします。</p>
<p>Storeに関連付けられているReducerのみしか適用されないので、特別な理由がない限り、combineReducerによって一つにまとめたReducerを関連付けてしまう方が楽。</p>
<p>combineReducer : Reduxに備わっているメソッドで、複数のReducerを合成します。</p>
<pre><code>  通常、一つのReducer内で処理分岐して定義して問題ありませんが、規模が大きくなってくると見通しが悪くなってくるのでReducerを分割したくなります。
  そんなときにどうぞ。
  
  Storeはアプリケーション内で一つということに変わりはありませんが、Reducerを分割することで、Storeを擬似的に分割できる点がメリットです。
</code></pre></li>
</ul>
<h3 id="reactと組み合わせる">Reactと組み合わせる</h3>
<p>次の機能を持たせます。</p>
<ul>
<li>Reactを使って状態の変化をViewに反映する。</li>
<li>ブラウザからのタスク入力を可能にする。</li>
</ul>
<ol>
<li><p>タスク入力用のActionCreatorの定義</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb68-1" title="1"><span class="co">// タスク入力用のActionCreator</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="kw">const</span> inputTask <span class="op">=</span> (task) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb68-3" title="3">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;INPUT_TASK&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb68-4" title="4">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb68-5" title="5">    task</a>
<a class="sourceLine" id="cb68-6" title="6">  <span class="op">}</span></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div></li>
<li><p>タスク入力用のActionを受け取りStoreを変更できるように、Reducerを変更する</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">const</span> initialState <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-2" title="2">  <span class="dt">task</span><span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">,</span>       <span class="co">// ←追加</span></a>
<a class="sourceLine" id="cb69-3" title="3">  <span class="dt">tasks</span><span class="op">:</span> []</a>
<a class="sourceLine" id="cb69-4" title="4"><span class="op">};</span></a>
<a class="sourceLine" id="cb69-5" title="5"></a>
<a class="sourceLine" id="cb69-6" title="6"><span class="kw">function</span> <span class="at">tasksReducer</span>(state <span class="op">=</span> initialState<span class="op">,</span> action) <span class="op">{</span></a>
<a class="sourceLine" id="cb69-7" title="7">  <span class="cf">switch</span> (<span class="va">action</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb69-8" title="8">    <span class="cf">case</span> <span class="st">&#39;INPUT_TASK&#39;</span><span class="op">:</span>    <span class="co">// INPUT_TASKのCaseを追加</span></a>
<a class="sourceLine" id="cb69-9" title="9">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-10" title="10">        ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb69-11" title="11">        <span class="dt">task</span><span class="op">:</span> <span class="va">action</span>.<span class="va">payload</span>.<span class="at">task</span></a>
<a class="sourceLine" id="cb69-12" title="12">      <span class="op">};</span></a>
<a class="sourceLine" id="cb69-13" title="13">    <span class="cf">case</span> <span class="st">&#39;ADD_TASK&#39;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb69-14" title="14">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb69-15" title="15">        ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb69-16" title="16">        <span class="dt">tasks</span><span class="op">:</span> <span class="va">state</span>.<span class="va">tasks</span>.<span class="at">concat</span>([<span class="va">action</span>.<span class="va">payload</span>.<span class="at">task</span>])</a>
<a class="sourceLine" id="cb69-17" title="17">      <span class="op">};</span></a>
<a class="sourceLine" id="cb69-18" title="18">    <span class="dt">default</span><span class="op">:</span></a>
<a class="sourceLine" id="cb69-19" title="19">      <span class="cf">return</span> state<span class="op">;</span></a>
<a class="sourceLine" id="cb69-20" title="20">  <span class="op">}</span></a>
<a class="sourceLine" id="cb69-21" title="21"><span class="op">}</span></a></code></pre></div></li>
<li><p>Reactコンポーネントの定義を追加する</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">function</span> <span class="at">TodoApp</span>(<span class="op">{</span> store <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb70-2" title="2">  <span class="kw">const</span> <span class="op">{</span> task<span class="op">,</span> tasks <span class="op">}</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb70-3" title="3">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb70-4" title="4">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb70-5" title="5">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;text&quot;</span> onChange<span class="op">={</span>(e) <span class="op">=&gt;</span> <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">inputTask</span>(<span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span>))<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb70-6" title="6">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;button&quot;</span> value<span class="op">=</span><span class="st">&quot;add&quot;</span> onClick<span class="op">={</span>() <span class="op">=&gt;</span> <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">addTask</span>(task))<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb70-7" title="7">      <span class="op">&lt;</span>ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb70-8" title="8">        <span class="op">{</span></a>
<a class="sourceLine" id="cb70-9" title="9">          <span class="va">tasks</span>.<span class="at">map</span>(<span class="kw">function</span>(item<span class="op">,</span> i) <span class="op">{</span></a>
<a class="sourceLine" id="cb70-10" title="10">            <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb70-11" title="11">              <span class="op">&lt;</span>li key<span class="op">={</span>i<span class="op">}&gt;{</span>item<span class="op">}</span>&lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb70-12" title="12">            )<span class="op">;</span></a>
<a class="sourceLine" id="cb70-13" title="13">          <span class="op">}</span>)</a>
<a class="sourceLine" id="cb70-14" title="14">        <span class="op">}</span></a>
<a class="sourceLine" id="cb70-15" title="15">      &lt;/ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb70-16" title="16">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb70-17" title="17">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb70-18" title="18"><span class="op">}</span></a></code></pre></div></li>
<li><p>Reactコンポーネントを描画する関数の準備</p>
<p>importを次のように変更する。</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb71-1" title="1"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a></code></pre></div>
<p>↓</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb72-1" title="1"><span class="im">import</span> <span class="op">{</span> render <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a></code></pre></div>
<p>Viewを描画する関数を追加する。</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">function</span> <span class="at">renderApp</span>(store) <span class="op">{</span></a>
<a class="sourceLine" id="cb73-2" title="2">  <span class="at">render</span>(</a>
<a class="sourceLine" id="cb73-3" title="3">    <span class="op">&lt;</span>TodoApp store<span class="op">={</span>store<span class="op">}</span> /&gt;<span class="op">,</span></a>
<a class="sourceLine" id="cb73-4" title="4">    <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb73-5" title="5">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb73-6" title="6"><span class="op">}</span></a></code></pre></div>
<p>もともとあった描画の処理は削除する。</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb74-1" title="1"><span class="va">ReactDOM</span>.<span class="at">render</span>(<span class="op">&lt;</span>App /<span class="op">&gt;,</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb74-2" title="2"><span class="at">registerServiceWorker</span>()<span class="op">;</span></a></code></pre></div></li>
<li><p>Viewに反映する関数の準備</p>
<p>Storeの状態変化に応じてViewを変化させる関数を定義します。 Storeの<code>subscribe</code>メソッドを使います。</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb75-1" title="1"><span class="va">store</span>.<span class="at">subscribe</span>(() <span class="op">=&gt;</span> <span class="at">renderApp</span>(store))<span class="op">;</span></a></code></pre></div>
<p>上記処理の次に描画する関数の呼び出しを追加する。<br />
初期表示用？</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb76-1" title="1"><span class="at">renderApp</span>(store)<span class="op">;</span></a></code></pre></div></li>
</ol>
<h3 id="indexjsの全体">index.jsの全体</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb77-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="im">import</span> <span class="op">{</span> render <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb77-3" title="3"><span class="im">import</span> <span class="op">{</span> createStore <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb77-4" title="4"></a>
<a class="sourceLine" id="cb77-5" title="5"><span class="co">// Note: 使わないのでコメント化 &gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb77-6" title="6"><span class="co">// import &#39;./index.css&#39;;</span></a>
<a class="sourceLine" id="cb77-7" title="7"><span class="co">// import App from &#39;./App&#39;;</span></a>
<a class="sourceLine" id="cb77-8" title="8"><span class="co">// import registerServiceWorker from &#39;./registerServiceWorker&#39;;</span></a>
<a class="sourceLine" id="cb77-9" title="9"><span class="co">/// Note: &lt;&lt;&lt; 使わないのでコメント化</span></a>
<a class="sourceLine" id="cb77-10" title="10"></a>
<a class="sourceLine" id="cb77-11" title="11"><span class="kw">const</span> initialState <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb77-12" title="12">  <span class="dt">task</span><span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb77-13" title="13">  <span class="dt">tasks</span><span class="op">:</span> []</a>
<a class="sourceLine" id="cb77-14" title="14"><span class="op">};</span></a>
<a class="sourceLine" id="cb77-15" title="15"></a>
<a class="sourceLine" id="cb77-16" title="16"><span class="co">// Reducerの定義</span></a>
<a class="sourceLine" id="cb77-17" title="17"><span class="co">// 第1引数は、現在の状態を表すstateオブジェクト</span></a>
<a class="sourceLine" id="cb77-18" title="18"><span class="co">// 第2引数は、どのような操作をしたのかを示すActionオブジェクト</span></a>
<a class="sourceLine" id="cb77-19" title="19"><span class="kw">function</span> <span class="at">tasksReducer</span>(state <span class="op">=</span> initialState<span class="op">,</span> action) <span class="op">{</span></a>
<a class="sourceLine" id="cb77-20" title="20">  <span class="cf">switch</span> (<span class="va">action</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb77-21" title="21">    <span class="cf">case</span> <span class="st">&#39;INPUT_TASK&#39;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb77-22" title="22">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb77-23" title="23">        ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb77-24" title="24">        <span class="dt">task</span><span class="op">:</span> <span class="va">action</span>.<span class="va">payload</span>.<span class="at">task</span></a>
<a class="sourceLine" id="cb77-25" title="25">      <span class="op">};</span></a>
<a class="sourceLine" id="cb77-26" title="26">    <span class="cf">case</span> <span class="st">&#39;ADD_TASK&#39;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb77-27" title="27">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb77-28" title="28">        ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb77-29" title="29">        <span class="dt">tasks</span><span class="op">:</span> <span class="va">state</span>.<span class="va">tasks</span>.<span class="at">concat</span>([<span class="va">action</span>.<span class="va">payload</span>.<span class="at">task</span>])</a>
<a class="sourceLine" id="cb77-30" title="30">      <span class="op">};</span></a>
<a class="sourceLine" id="cb77-31" title="31">    <span class="dt">default</span><span class="op">:</span></a>
<a class="sourceLine" id="cb77-32" title="32">      <span class="cf">return</span> state<span class="op">;</span></a>
<a class="sourceLine" id="cb77-33" title="33">  <span class="op">}</span></a>
<a class="sourceLine" id="cb77-34" title="34"><span class="op">}</span></a>
<a class="sourceLine" id="cb77-35" title="35"></a>
<a class="sourceLine" id="cb77-36" title="36"></a>
<a class="sourceLine" id="cb77-37" title="37"><span class="co">// Storeの生成</span></a>
<a class="sourceLine" id="cb77-38" title="38"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(tasksReducer)<span class="op">;</span></a>
<a class="sourceLine" id="cb77-39" title="39"></a>
<a class="sourceLine" id="cb77-40" title="40"><span class="co">// ActionCreatorの定義</span></a>
<a class="sourceLine" id="cb77-41" title="41"><span class="co">// 追加するtaskを引数に取り、Actionオブジェクトを返す</span></a>
<a class="sourceLine" id="cb77-42" title="42"><span class="kw">const</span> addTask <span class="op">=</span> (task) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb77-43" title="43">  <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;ADD_TASK&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb77-44" title="44">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb77-45" title="45">    task</a>
<a class="sourceLine" id="cb77-46" title="46">  <span class="op">}</span></a>
<a class="sourceLine" id="cb77-47" title="47"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb77-48" title="48"></a>
<a class="sourceLine" id="cb77-49" title="49"></a>
<a class="sourceLine" id="cb77-50" title="50"><span class="co">// タスク入力用のActionCreator</span></a>
<a class="sourceLine" id="cb77-51" title="51"><span class="kw">const</span> inputTask <span class="op">=</span> (task) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb77-52" title="52">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;INPUT_TASK&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb77-53" title="53">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb77-54" title="54">    task</a>
<a class="sourceLine" id="cb77-55" title="55">  <span class="op">}</span></a>
<a class="sourceLine" id="cb77-56" title="56"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb77-57" title="57"></a>
<a class="sourceLine" id="cb77-58" title="58"></a>
<a class="sourceLine" id="cb77-59" title="59"><span class="kw">function</span> <span class="at">TodoApp</span>(<span class="op">{</span> store <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb77-60" title="60">  <span class="kw">const</span> <span class="op">{</span> task<span class="op">,</span> tasks <span class="op">}</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb77-61" title="61">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb77-62" title="62">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb77-63" title="63">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;text&quot;</span> onChange<span class="op">={</span>(e) <span class="op">=&gt;</span> <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">inputTask</span>(<span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span>))<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb77-64" title="64">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;button&quot;</span> value<span class="op">=</span><span class="st">&quot;add&quot;</span> onClick<span class="op">={</span>() <span class="op">=&gt;</span> <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">addTask</span>(task))<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb77-65" title="65">      <span class="op">&lt;</span>ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb77-66" title="66">        <span class="op">{</span></a>
<a class="sourceLine" id="cb77-67" title="67">          <span class="va">tasks</span>.<span class="at">map</span>(<span class="kw">function</span>(item<span class="op">,</span> i) <span class="op">{</span></a>
<a class="sourceLine" id="cb77-68" title="68">            <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb77-69" title="69">              <span class="op">&lt;</span>li key<span class="op">={</span>i<span class="op">}&gt;{</span>item<span class="op">}</span>&lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb77-70" title="70">            )<span class="op">;</span></a>
<a class="sourceLine" id="cb77-71" title="71">          <span class="op">}</span>)</a>
<a class="sourceLine" id="cb77-72" title="72">        <span class="op">}</span></a>
<a class="sourceLine" id="cb77-73" title="73">      &lt;/ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb77-74" title="74">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb77-75" title="75">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb77-76" title="76"><span class="op">}</span></a>
<a class="sourceLine" id="cb77-77" title="77"></a>
<a class="sourceLine" id="cb77-78" title="78"></a>
<a class="sourceLine" id="cb77-79" title="79"><span class="kw">function</span> <span class="at">renderApp</span>(store) <span class="op">{</span></a>
<a class="sourceLine" id="cb77-80" title="80">  <span class="at">render</span>(</a>
<a class="sourceLine" id="cb77-81" title="81">    <span class="op">&lt;</span>TodoApp store<span class="op">={</span>store<span class="op">}</span> /&gt;<span class="op">,</span></a>
<a class="sourceLine" id="cb77-82" title="82">    <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb77-83" title="83">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb77-84" title="84"><span class="op">}</span></a>
<a class="sourceLine" id="cb77-85" title="85"></a>
<a class="sourceLine" id="cb77-86" title="86"></a>
<a class="sourceLine" id="cb77-87" title="87"><span class="va">store</span>.<span class="at">subscribe</span>(() <span class="op">=&gt;</span> <span class="at">renderApp</span>(store))<span class="op">;</span></a>
<a class="sourceLine" id="cb77-88" title="88"><span class="at">renderApp</span>(store)<span class="op">;</span></a></code></pre></div>
<h3 id="ファイルを機能ごとに分割する">ファイルを機能ごとに分割する</h3>
<p>ActionCreator、Store、Reducer、Componentの定義を、1ファイルにまとめて書きました。 これを役割ごとにファイルを分割したほうが視認性がよくなります。</p>
<p>次のフォルダ構造でファイルを分割します。</p>
<pre><code>src/
+---index.js
+---containers/
|     ... Container Component を置く
+---components/
|     ... Presentational Component を置く
+---actions/
|     ... ActionCreator を置く
`---reducers/
      ... Reducer を置く
</code></pre>
<ol>
<li><p>Reducerの定義を<code>src/reducers/tasks.js</code>に移動します。</p>
<p>function には <code>export default</code> を付けてください。</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">const</span> initialState <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb79-2" title="2">  <span class="dt">task</span><span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb79-3" title="3">  <span class="dt">tasks</span><span class="op">:</span> []</a>
<a class="sourceLine" id="cb79-4" title="4"><span class="op">};</span></a>
<a class="sourceLine" id="cb79-5" title="5"></a>
<a class="sourceLine" id="cb79-6" title="6"><span class="co">// Reducerの定義</span></a>
<a class="sourceLine" id="cb79-7" title="7"><span class="co">// 第1引数は、現在の状態を表すstateオブジェクト</span></a>
<a class="sourceLine" id="cb79-8" title="8"><span class="co">// 第2引数は、どのような操作をしたのかを示すActionオブジェクト</span></a>
<a class="sourceLine" id="cb79-9" title="9"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">tasksReducer</span>(state <span class="op">=</span> initialState<span class="op">,</span> action) <span class="op">{</span></a>
<a class="sourceLine" id="cb79-10" title="10">  <span class="cf">switch</span> (<span class="va">action</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb79-11" title="11">    <span class="cf">case</span> <span class="st">&#39;INPUT_TASK&#39;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb79-12" title="12">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb79-13" title="13">        ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb79-14" title="14">        <span class="dt">task</span><span class="op">:</span> <span class="va">action</span>.<span class="va">payload</span>.<span class="at">task</span></a>
<a class="sourceLine" id="cb79-15" title="15">      <span class="op">};</span></a>
<a class="sourceLine" id="cb79-16" title="16">    <span class="cf">case</span> <span class="st">&#39;ADD_TASK&#39;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb79-17" title="17">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb79-18" title="18">        ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb79-19" title="19">        <span class="dt">tasks</span><span class="op">:</span> <span class="va">state</span>.<span class="va">tasks</span>.<span class="at">concat</span>([<span class="va">action</span>.<span class="va">payload</span>.<span class="at">task</span>])</a>
<a class="sourceLine" id="cb79-20" title="20">      <span class="op">};</span></a>
<a class="sourceLine" id="cb79-21" title="21">    <span class="dt">default</span><span class="op">:</span></a>
<a class="sourceLine" id="cb79-22" title="22">      <span class="cf">return</span> state<span class="op">;</span></a>
<a class="sourceLine" id="cb79-23" title="23">  <span class="op">}</span></a>
<a class="sourceLine" id="cb79-24" title="24"><span class="op">}</span></a></code></pre></div></li>
<li><p>ActionCreatorの定義を <code>src/actions/tasks.js</code> に移動します。</p>
<p>const に <code>export</code> を付けてください。</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb80-1" title="1"><span class="co">// ActionCreatorの定義</span></a>
<a class="sourceLine" id="cb80-2" title="2"><span class="co">// 追加するtaskを引数に取り、Actionオブジェクトを返す</span></a>
<a class="sourceLine" id="cb80-3" title="3"><span class="im">export</span> <span class="kw">const</span> addTask <span class="op">=</span> (task) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb80-4" title="4">  <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;ADD_TASK&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb80-5" title="5">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb80-6" title="6">    task</a>
<a class="sourceLine" id="cb80-7" title="7">  <span class="op">}</span></a>
<a class="sourceLine" id="cb80-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb80-9" title="9"></a>
<a class="sourceLine" id="cb80-10" title="10"></a>
<a class="sourceLine" id="cb80-11" title="11"><span class="co">// タスク入力用のActionCreator</span></a>
<a class="sourceLine" id="cb80-12" title="12"><span class="im">export</span> <span class="kw">const</span> inputTask <span class="op">=</span> (task) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb80-13" title="13">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;INPUT_TASK&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb80-14" title="14">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb80-15" title="15">    task</a>
<a class="sourceLine" id="cb80-16" title="16">  <span class="op">}</span></a>
<a class="sourceLine" id="cb80-17" title="17"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div></li>
<li><p>Componentの定義を <code>src/components/TodoApp.js</code> に移動します。</p>
<p>componentsからActionをDispatchするため、先ほど移動したActionCreatorのファイルをインポートします。</p>
<p>（<code>import { inputTask, addTask } from '../actions/tasks';</code> の部分）</p>
<p>関数には <code>export default</code> を付けてください。</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb81-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="im">import</span> <span class="op">{</span> inputTask<span class="op">,</span> addTask <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/tasks&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb81-3" title="3"></a>
<a class="sourceLine" id="cb81-4" title="4"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">TodoApp</span>(<span class="op">{</span> store <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb81-5" title="5">  <span class="kw">const</span> <span class="op">{</span> task<span class="op">,</span> tasks <span class="op">}</span> <span class="op">=</span> <span class="va">store</span>.<span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb81-6" title="6">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb81-7" title="7">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb81-8" title="8">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;text&quot;</span> onChange<span class="op">={</span>(e) <span class="op">=&gt;</span> <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">inputTask</span>(<span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span>))<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb81-9" title="9">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;button&quot;</span> value<span class="op">=</span><span class="st">&quot;add&quot;</span> onClick<span class="op">={</span>() <span class="op">=&gt;</span> <span class="va">store</span>.<span class="at">dispatch</span>(<span class="at">addTask</span>(task))<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb81-10" title="10">      <span class="op">&lt;</span>ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb81-11" title="11">        <span class="op">{</span></a>
<a class="sourceLine" id="cb81-12" title="12">          <span class="va">tasks</span>.<span class="at">map</span>(<span class="kw">function</span>(item<span class="op">,</span> i) <span class="op">{</span></a>
<a class="sourceLine" id="cb81-13" title="13">            <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb81-14" title="14">              <span class="op">&lt;</span>li key<span class="op">={</span>i<span class="op">}&gt;{</span>item<span class="op">}</span>&lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb81-15" title="15">            )<span class="op">;</span></a>
<a class="sourceLine" id="cb81-16" title="16">          <span class="op">}</span>)</a>
<a class="sourceLine" id="cb81-17" title="17">        <span class="op">}</span></a>
<a class="sourceLine" id="cb81-18" title="18">      &lt;/ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb81-19" title="19">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb81-20" title="20">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb81-21" title="21"><span class="op">}</span></a></code></pre></div></li>
<li><p><code>src\index.js</code> は、分割したファイルをインポートするように変更します。</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb82-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="im">import</span> <span class="op">{</span> render <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb82-3" title="3"><span class="im">import</span> tasksReducer <span class="im">from</span> <span class="st">&#39;./reducers/tasks&#39;</span><span class="op">;</span>    <span class="co">// Reducerのインポート</span></a>
<a class="sourceLine" id="cb82-4" title="4"><span class="im">import</span> TodoApp <span class="im">from</span> <span class="st">&#39;./components/TodoApp&#39;</span><span class="op">;</span>     <span class="co">// Componentのインポート</span></a>
<a class="sourceLine" id="cb82-5" title="5"><span class="im">import</span> <span class="op">{</span> createStore <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb82-6" title="6"></a>
<a class="sourceLine" id="cb82-7" title="7"><span class="co">// Note: 使わないのでコメント化 &gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb82-8" title="8"><span class="co">// import &#39;./index.css&#39;;</span></a>
<a class="sourceLine" id="cb82-9" title="9"><span class="co">// import App from &#39;./App&#39;;</span></a>
<a class="sourceLine" id="cb82-10" title="10"><span class="co">// import registerServiceWorker from &#39;./registerServiceWorker&#39;;</span></a>
<a class="sourceLine" id="cb82-11" title="11"><span class="co">/// Note: &lt;&lt;&lt; 使わないのでコメント化</span></a>
<a class="sourceLine" id="cb82-12" title="12"></a>
<a class="sourceLine" id="cb82-13" title="13"><span class="co">// Storeの生成</span></a>
<a class="sourceLine" id="cb82-14" title="14"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(tasksReducer)<span class="op">;</span></a>
<a class="sourceLine" id="cb82-15" title="15"></a>
<a class="sourceLine" id="cb82-16" title="16"><span class="kw">function</span> <span class="at">renderApp</span>(store) <span class="op">{</span></a>
<a class="sourceLine" id="cb82-17" title="17">  <span class="at">render</span>(</a>
<a class="sourceLine" id="cb82-18" title="18">    <span class="op">&lt;</span>TodoApp store<span class="op">={</span>store<span class="op">}</span> /&gt;<span class="op">,</span></a>
<a class="sourceLine" id="cb82-19" title="19">    <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb82-20" title="20">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb82-21" title="21"><span class="op">}</span></a>
<a class="sourceLine" id="cb82-22" title="22"></a>
<a class="sourceLine" id="cb82-23" title="23"><span class="va">store</span>.<span class="at">subscribe</span>(() <span class="op">=&gt;</span> <span class="at">renderApp</span>(store))<span class="op">;</span></a>
<a class="sourceLine" id="cb82-24" title="24"><span class="at">renderApp</span>(store)<span class="op">;</span></a></code></pre></div></li>
</ol>
<!-- TODO: p.108 「最終的な」と書いておきつつ、サンプルコードに最後の2行がない。 -->

<h3 id="react-redux">react-redux</h3>
<p><code>react-redux</code>は、ReactとReduxの連携をサポートするライブラリです。 Storeの状態変化に応じて該当部分のViewを再描画するのを手助けしてくれます。</p>
<h3 id="react-reduxのインストール">react-reduxのインストール</h3>
<pre><code>&gt; npm install --save react-redux
</code></pre>
<!-- TODO: p109 `-save`になっている。半角ハイフンがひとつ足りない。 -->

<p>ReactはViewを扱うライブラリなので、Reduxが有するStoreやActionの情報と疎結合になっていることが望ましい。 そのほうがコンポーネント単体としてもテストしやすいし、コードの可読性も上がります。</p>
<p>Container Component : Reactコンポーネントをラップしたコンポーネント。</p>
<pre><code>ReduxのStoreやActionを受け取り、ReactのPropsとして渡す役を担います。
Container Componentの責務は、ReactとReduxの橋渡しのみなので、JSXを記述するのは誤りです。
</code></pre>
<p>Presentational Component : Redux依存のない純粋なReactコンポーネント。</p>
<h3 id="react-reduxの機能">react-reduxの機能</h3>
<p>次の2つの機能があります。</p>
<ul>
<li>&lt;Provider&gt;</li>
<li>connect</li>
</ul>
<h4 id="provider-store">&lt;Provider store&gt;</h4>
<p>dispatchはStoreが持つメソッドなので、ReactコンポーネントからActionをdispatchさせるにはStoreが必要になります。 dispatchしたいコンポーネントすべてに対し、Storeを最上位から渡していくのは得策ではありません。</p>
<p>&lt;Provider&gt;を使うことで<code>connect</code>という関数を使えるようになり、任意のコンポーネントに対してStoreとの紐付けができるようになります。</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb85-1" title="1"><span class="co">// 最上位のコンポーネントを&lt;Provider&gt;でラップして、propsにStoreを与える</span></a>
<a class="sourceLine" id="cb85-2" title="2"><span class="co">// （内部的にはReactのcontext経由でStoreを保持する仕組み）</span></a>
<a class="sourceLine" id="cb85-3" title="3"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb85-4" title="4">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb85-5" title="5">    <span class="op">&lt;</span>MyRootComponent /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb85-6" title="6">  &lt;/Provider<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb85-7" title="7">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb85-8" title="8">)<span class="op">;</span></a></code></pre></div>
<h4 id="connectmapstatetoprops-mapdispatchtoprops-mergeprops-options">connect([mapStateToProps], [mapDispatchToProps], [mergeProps], [options])</h4>
<p>特定のComponentに対して、Reactのcontextで保持しているStoreを提供します。 Storeさえあれば<code>getState</code>で状態が取得できますし、Actionの<code>dispatch</code>もできます。</p>
<p>引数</p>
<p>mapStateToProps(state, [ownProps]) : Storeから必要なstateを取り出し、ComponentのPropsに割り当てる関数を指定します。</p>
<pre><code>第1引数はStoreのstate。
複数のReducerを組み合わせている場合は、必要な部分のstateのみ取り出して返すようにすれば、不要なコンポーネントを渡さずに済みます。

第2引数はオプションで、親コンポーネントから引き継がれてきたPropsが格納されています（下記の例では未使用）。

~~~javascript
function mapStateToProps({ task, tasks }) {
  return {
    task,
    tasks,
  };
}
~~~

戻り値のオブジェクトは、connect先のComponentのPropsとして受け取ることができます。
</code></pre>
<p>mapDispatchToProps(dispatch, [ownProps]) : Actionのdispatchを行う処理を指定します。そうすることでコンポーネントからdispatchの概念を隠蔽します。</p>
<pre><code>第1引数に、Storeのdispatchメソッドが渡されてくるので、これを使ってActionをdispatchします。

~~~javascript
// ActionCreator
const addTask = (task) =&gt; ({
  type: &quot;ADD_TASK&quot;,
  payload: {
    task
  }
});

function mapDispatchToProps(dispatch) {
  return {
    addTask(task) {
      dispatch(addTask(task));
    }
  };
}
~~~

&lt;!-- TODO: p.112 dispatch(addTask(task});　← } ではなく ) では？ --&gt;
</code></pre>
<p>mergeProps(stateProps, dispatchProps, ownProps) : <code>mapStateToProps</code>と<code>mapDispatchToProps</code>を経たそれぞれのPropsと、親から渡ってきた<code>ownProps</code>をマージして、コンポーネントに渡します。</p>
<pre><code>既定では、以下のように、`Object.assign`関数を使って単純に3つをマージしたものを返す処理が設定されています。

~~~javascript
function mergeProps(stateProps, dispatchProps, ownProps) {
  return Object.assign({}, ownProps, stateProps, dispatchProps);
}
~~~
</code></pre>
<p>options : オプションとして次の項目を設定できます。</p>
<pre><code>pure - Boolean
:   規定値はtrueです。trueの場合、関連するState/Propsに変化がなければ、connectは再描画および`mapStateToProps`/`mapDispatchToProps`/`mergeProp`を呼び出しません。
</code></pre>
<!-- TODO: p.114 mapStateToPrupsになっている。Propsでは？ -->

<pre><code>areStateEqual - Function
:   `pure`がtrueの場合、Storeの中身の差分判定をどのようにするか指定します。
    規定値は、strictEqual（===）です。

areOwnPropsEqual - Function
:   pureがtrueの場合、OwnPropの中身の差分判定をどのようにするか指定します。
    規定値は、shallowEqual（==）です。

areStatePropsEqual - Function
:   pureがtrueの場合、mapStateToPropsの結果の差分判定をどのようにするか指定します。
    規定値は、shallowEqual（==）です。

areMergedPropsEqual - Function
:   pureがtrueの場合、mergePropsの結果の差分判定をどのようにするか指定します。
    規定値は、shallowEqual（==）です。

storeKey - String
:   もし何らかの理由でStoreを複数用意したいときに指定します。

    通常であれば不要。
</code></pre>
<h3 id="react-reduxの組み込み">react-reduxの組み込み</h3>
<h4 id="container-componentの作成">Container Componentの作成</h4>
<p>ファイル<code>src\containers\TodoApp.js</code>を作ります。</p>
<p>これにより TodoApp コンポーネントには Prop として次の4つが渡されるようになります。</p>
<ul>
<li>task - フォームに入力されたタスク</li>
<li>tasks - タスクの配列</li>
<li>addTask - タスクを追加する関数</li>
<li>inputTask - タスクを入力する関数</li>
</ul>
<div class="sourceCode" id="cb91"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb91-1" title="1"><span class="im">import</span> <span class="op">{</span> connect <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="im">import</span> TodoApp <span class="im">from</span> <span class="st">&#39;../components/TodoApp&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb91-3" title="3"><span class="im">import</span> <span class="op">{</span> inputTask<span class="op">,</span> addTask <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/tasks&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb91-4" title="4"></a>
<a class="sourceLine" id="cb91-5" title="5"><span class="co">// Storeにある task と tasks という State を Props に渡す</span></a>
<a class="sourceLine" id="cb91-6" title="6"><span class="kw">function</span> <span class="at">mapStateToProps</span>(<span class="op">{</span> task<span class="op">,</span> tasks <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb91-7" title="7">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb91-8" title="8">    task<span class="op">,</span></a>
<a class="sourceLine" id="cb91-9" title="9">    tasks</a>
<a class="sourceLine" id="cb91-10" title="10">  <span class="op">};</span></a>
<a class="sourceLine" id="cb91-11" title="11"><span class="op">}</span></a>
<a class="sourceLine" id="cb91-12" title="12"></a>
<a class="sourceLine" id="cb91-13" title="13"><span class="co">// 該当のActionをDispatchさせる関数を Props に渡す</span></a>
<a class="sourceLine" id="cb91-14" title="14"><span class="kw">function</span> <span class="at">mapDispatchToProps</span>(dispatch) <span class="op">{</span></a>
<a class="sourceLine" id="cb91-15" title="15">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb91-16" title="16">    <span class="at">addTask</span>(task) <span class="op">{</span></a>
<a class="sourceLine" id="cb91-17" title="17">      <span class="at">dispatch</span>(<span class="at">addTask</span>(task))<span class="op">;</span></a>
<a class="sourceLine" id="cb91-18" title="18">    <span class="op">},</span></a>
<a class="sourceLine" id="cb91-19" title="19">    <span class="at">inputTask</span>(task) <span class="op">{</span></a>
<a class="sourceLine" id="cb91-20" title="20">      <span class="at">dispatch</span>(<span class="at">inputTask</span>(task))</a>
<a class="sourceLine" id="cb91-21" title="21">    <span class="op">}</span></a>
<a class="sourceLine" id="cb91-22" title="22">  <span class="op">};</span></a>
<a class="sourceLine" id="cb91-23" title="23"><span class="op">}</span></a>
<a class="sourceLine" id="cb91-24" title="24"></a>
<a class="sourceLine" id="cb91-25" title="25"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(TodoApp)<span class="op">;</span></a></code></pre></div>
<h4 id="todoappコンポーネントの修正">TodoAppコンポーネントの修正</h4>
<p><code>src/components/TodoApp.js</code></p>
<p>変更前 : StoreがPropsに渡ってきて、そこからStateを取得。</p>
<p>変更後 : containersから整形されたオブジェクトがPropsとして渡されてきます。 ActionCreatorやActionのDispatchもcontainers側でやるので、コンポーネント側はPropsで渡ってきたinputTaskとaddTaskを呼び出すだけになります。</p>
<pre><code>これにより、コンポーネントのRedux依存が消え、再利用性も高まりました。
</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb93-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb93-2" title="2"></a>
<a class="sourceLine" id="cb93-3" title="3"><span class="co">// 引数を store から変更</span></a>
<a class="sourceLine" id="cb93-4" title="4"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">TodoApp</span>(<span class="op">{</span> task<span class="op">,</span> tasks<span class="op">,</span> inputTask<span class="op">,</span> addTask <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb93-5" title="5">  <span class="co">// onChange、onClickの指定時にdispatchが不要になる</span></a>
<a class="sourceLine" id="cb93-6" title="6">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb93-7" title="7">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb93-8" title="8">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;text&quot;</span> onChange<span class="op">={</span>(e) <span class="op">=&gt;</span> <span class="at">inputTask</span>(<span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span>)<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb93-9" title="9">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;button&quot;</span> value<span class="op">=</span><span class="st">&quot;add&quot;</span> onClick<span class="op">={</span>() <span class="op">=&gt;</span> <span class="at">addTask</span>(task)<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb93-10" title="10">      <span class="op">&lt;</span>ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb93-11" title="11">        <span class="op">{</span></a>
<a class="sourceLine" id="cb93-12" title="12">          <span class="va">tasks</span>.<span class="at">map</span>(<span class="kw">function</span>(item<span class="op">,</span> i) <span class="op">{</span></a>
<a class="sourceLine" id="cb93-13" title="13">            <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb93-14" title="14">              <span class="op">&lt;</span>li key<span class="op">={</span>i<span class="op">}&gt;{</span>item<span class="op">}</span>&lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb93-15" title="15">            )<span class="op">;</span></a>
<a class="sourceLine" id="cb93-16" title="16">          <span class="op">}</span>)</a>
<a class="sourceLine" id="cb93-17" title="17">        <span class="op">}</span></a>
<a class="sourceLine" id="cb93-18" title="18">      &lt;/ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb93-19" title="19">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb93-20" title="20">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb93-21" title="21"><span class="op">}</span></a></code></pre></div>
<h4 id="indexjsの修正">index.jsの修正</h4>
<ul>
<li>Providerのimportを追加</li>
<li>TodoAppのimportをcomponentsではなくcontainersにする</li>
<li>Storeのsubscribeでコンポーネントの再描画を行っていた処理を削除する</li>
<li>function renderApp の処理を外に出す（render()をfunctionではなくする）</li>
</ul>
<div class="sourceCode" id="cb94"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb94-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="im">import</span> <span class="op">{</span> createStore <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb94-4" title="4"><span class="im">import</span> <span class="op">{</span> render <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb94-5" title="5"><span class="im">import</span> tasksReducer <span class="im">from</span> <span class="st">&#39;./reducers/tasks&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb94-6" title="6"><span class="im">import</span> TodoApp <span class="im">from</span> <span class="st">&#39;./containers/TodoApp&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb94-7" title="7"></a>
<a class="sourceLine" id="cb94-8" title="8"><span class="co">// Note: 使わないのでコメント化 &gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb94-9" title="9"><span class="co">// import &#39;./index.css&#39;;</span></a>
<a class="sourceLine" id="cb94-10" title="10"><span class="co">// import App from &#39;./App&#39;;</span></a>
<a class="sourceLine" id="cb94-11" title="11"><span class="co">// import registerServiceWorker from &#39;./registerServiceWorker&#39;;</span></a>
<a class="sourceLine" id="cb94-12" title="12"><span class="co">/// Note: &lt;&lt;&lt; 使わないのでコメント化</span></a>
<a class="sourceLine" id="cb94-13" title="13"></a>
<a class="sourceLine" id="cb94-14" title="14"><span class="co">// Storeの生成</span></a>
<a class="sourceLine" id="cb94-15" title="15"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(tasksReducer)<span class="op">;</span></a>
<a class="sourceLine" id="cb94-16" title="16"></a>
<a class="sourceLine" id="cb94-17" title="17"><span class="co">// &lt;Provider&gt;を追加</span></a>
<a class="sourceLine" id="cb94-18" title="18"><span class="at">render</span>(</a>
<a class="sourceLine" id="cb94-19" title="19">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb94-20" title="20">    <span class="op">&lt;</span>TodoApp /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb94-21" title="21">  &lt;/Provider<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb94-22" title="22">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb94-23" title="23">)<span class="op">;</span></a></code></pre></div>
<h4 id="connectadvanced">connectAdvanced</h4>
<p>通常の<code>connect</code>よりも自由度を高くpropsの受け渡しをしたい場合、<code>connectAdvanced</code>を使うことができます。</p>
<p><code>mapStateToProps</code>や<code>mapDispatchToProps</code>、<code>mergeProps</code>のあたりの処理を自前で行うイメージです。</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb95-1" title="1"><span class="at">connectAdvanced</span>(selectorFactory<span class="op">,</span> [connectOptions])</a></code></pre></div>
<p>これらについては必要なときに調べるとしましょう。</p>
<h2 id="ルーティング">ルーティング</h2>
<p>ユーザーからの入力をもとに表示させるページを出し分けることをルーティングといいます。</p>
<p>実装の方法は、どのページにいるのかという情報（URL）をStoreで保持し、変化があった場合にViewを差し替えるようにします。</p>
<h3 id="実装パターン">実装パターン</h3>
<p>URL遷移なし : URLを使わずにアプリの内部で状態を保持する方法。</p>
<pre><code>たとえば、Storeにpageというプロパティを用意し、ここでいまどのページにいるのかを管理します。
ですが、画面のリロードによって状態が元に戻ってしまうため現実的ではありません。
</code></pre>
<p>URL Hash : URL Hash（<code>#</code>)を使ってクライアントサイドのルーティングを実現する方法です。</p>
<pre><code>aタグによるページ内移動と同じ仕組みなので、サーバーにリクエストは投げられません。

Hashは`location.hash`で取得できます。
hashが変更されたときに発火する`hashchange`イベントをハンドリングしてコンポーネントを描画します。
</code></pre>
<p>history API : ブラウザの履歴情報を操作するAPI（history API）を使った方法です。</p>
<pre><code>- `pushState`で履歴を追加できます。このとき、サーバーにリクエストは飛びません。
- 画面をリロードされたときは、その時点のURLにリクエストが投げられます。そのため、URLに該当するリソースがないと404エラーになってしまいます。
- 404エラーに対応するため、サーバーサイトで常にSPAの基点となるべきテンプレートを返すようにします。
- `webpack-dev-server`を使っているときは、History API Fallback機能を使うとWebサーバーが返すリソースがない場合、自動で index.html を返してくれます。
- Reduxのconnectを使っている場合は`connect-history-api-fallback`というミドルウェアを使います。
</code></pre>
<h3 id="ルーティングライブラリ">ルーティングライブラリ</h3>
<p>React Router V4 : メジャーなルーティングライブラリ。react-nativeを使ったアプリ開発でも使うことができます。</p>
<pre><code>Webアプリでは`react-router-dom`パッケージを使います。
</code></pre>
<h4 id="インストール">インストール</h4>
<pre><code>&gt; npm install --save react-router-dom
</code></pre>
<p>react-router-redux : react-routerをReduxに最適化したもの。</p>
<pre><code>- react-routerのみでは、URLの変更を`&lt;Link&gt;`や`&lt;Redirect&gt;`経由でしかできません。
- react-router-reduxでは、ルーティング情報をStoreのStateで管理しつつ、pushやreplaceといったAPIを使ってURLを変更できます。
</code></pre>
<h4 id="インストール-1">インストール</h4>
<p>react-routerも動作に必要です。react-router-domパッケージも一緒にインストールします。</p>
<p>Note: : react-router 4.x を使う場合、react-router-redux 5.x が必要です。 react-router-reduxに〝@next〟をつけてインストールします。</p>
<pre><code>[react-router-redux - Installation](https://github.com/ReactTraining/react-router/tree/master/packages/react-router-redux#installation) より。
</code></pre>
<pre><code>&gt; npm install --save react-router-dom react-router-redux@next history
</code></pre>
<h4 id="特徴">特徴</h4>
<ul>
<li>react-routerのAPIはそのまま利用できます。</li>
<li>react-router-reduxがやっていることは、historyオブジェクトを強化し、その変更をStoreのStateに常に同期することです。</li>
</ul>
<h4 id="導入方法">導入方法</h4>
<p>Storeの生成処理が複雑なので別ファイルとして切り出します。 その中にStoreを生成する関数を定義します。</p>
<p><code>src/store/index.js</code>というファイルを作成します。</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb104-1" title="1"><span class="im">import</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb104-2" title="2">  <span class="co">// 名前が被るので別名でインポートする</span></a>
<a class="sourceLine" id="cb104-3" title="3">  createStore <span class="im">as</span> reduxCreateStore<span class="op">,</span></a>
<a class="sourceLine" id="cb104-4" title="4">  combineReducers<span class="op">,</span></a>
<a class="sourceLine" id="cb104-5" title="5">  applyMiddleware</a>
<a class="sourceLine" id="cb104-6" title="6"><span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb104-7" title="7"><span class="im">import</span> <span class="op">{</span> routerReducer<span class="op">,</span> routerMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb104-8" title="8"><span class="im">import</span> tasksReducer <span class="im">from</span> <span class="st">&#39;../reducers/tasks&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb104-9" title="9"></a>
<a class="sourceLine" id="cb104-10" title="10"><span class="co">// Storeを生成するための関数を定義</span></a>
<a class="sourceLine" id="cb104-11" title="11"><span class="co">// historyはsrc/index.jsからもらう</span></a>
<a class="sourceLine" id="cb104-12" title="12"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">createStore</span>(history) <span class="op">{</span></a>
<a class="sourceLine" id="cb104-13" title="13">  <span class="cf">return</span> <span class="at">reduxCreateStore</span>(</a>
<a class="sourceLine" id="cb104-14" title="14">    <span class="at">combineReducers</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb104-15" title="15">      <span class="co">// tasksReducersをtasksというキーに割り当てる</span></a>
<a class="sourceLine" id="cb104-16" title="16">      <span class="dt">tasks</span><span class="op">:</span> tasksReducer<span class="op">,</span></a>
<a class="sourceLine" id="cb104-17" title="17">      <span class="co">// react-router-reduxのReducer</span></a>
<a class="sourceLine" id="cb104-18" title="18">      <span class="dt">router</span><span class="op">:</span> routerReducer</a>
<a class="sourceLine" id="cb104-19" title="19">    <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb104-20" title="20">    <span class="at">applyMiddleware</span>(</a>
<a class="sourceLine" id="cb104-21" title="21">      <span class="co">// react-router-reduxのRedux Middleware</span></a>
<a class="sourceLine" id="cb104-22" title="22">      <span class="at">routerMiddleware</span>(history)</a>
<a class="sourceLine" id="cb104-23" title="23">    )</a>
<a class="sourceLine" id="cb104-24" title="24">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb104-25" title="25"><span class="op">}</span></a></code></pre></div>
<ul>
<li>react-router-reduxは<code>routerReducer</code>というルーティングのためのReducerを持っています。</li>
<li>自前のReducerと一緒に使うために、combineReducerを使ってReducerを合成します。</li>
<li>react-router-reduxはルーティングのための<code>routerMiddleware</code>というMiddlewareも提供しています。 このMiddlewareにより、ReduxのAction経由でルーティングを制御できるようになります。</li>
<li><code>applyMiddleware</code>を使って、<code>routerMiddleware</code>を適用します。</li>
</ul>
<p>Storeの生成</p>
<p><code>src/index.js</code>を変更します。</p>
<ul>
<li><code>import { createStore } from 'redux';</code>を消す。</li>
<li><code>import tasksReducer from './reducers/tasks';</code> を消す。</li>
<li><code>react-router-redux</code>と<code>history</code>、<code>src/store/index.js</code>のインポートを追加。</li>
<li>historyのインスタンス生成を追加。</li>
<li>&lt;ConnectedRouter&gt;にhistoryを渡す処理を追加。</li>
<li>createStoreの引数を<code>tasksReducer</code>から<code>history</code>に変更。</li>
</ul>
<div class="sourceCode" id="cb105"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb105-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="im">import</span> <span class="op">{</span> render <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="im">import</span> <span class="op">{</span> ConnectedRouter <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span><span class="op">;</span>             <span class="co">// 追加</span></a>
<a class="sourceLine" id="cb105-5" title="5"><span class="im">import</span> createBrowserHistory <span class="im">from</span> <span class="st">&#39;history/createBrowserHistory&#39;</span><span class="op">;</span>  <span class="co">// 追加</span></a>
<a class="sourceLine" id="cb105-6" title="6"><span class="im">import</span> TodoApp <span class="im">from</span> <span class="st">&#39;./containers/TodoApp&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb105-7" title="7"><span class="im">import</span> createStore <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span>                                <span class="co">// 追加</span></a>
<a class="sourceLine" id="cb105-8" title="8"></a>
<a class="sourceLine" id="cb105-9" title="9"><span class="co">// Note: 使わないのでコメント化 &gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb105-10" title="10"><span class="co">// import &#39;./index.css&#39;;</span></a>
<a class="sourceLine" id="cb105-11" title="11"><span class="co">// import App from &#39;./App&#39;;</span></a>
<a class="sourceLine" id="cb105-12" title="12"><span class="co">// import registerServiceWorker from &#39;./registerServiceWorker&#39;;</span></a>
<a class="sourceLine" id="cb105-13" title="13"><span class="co">/// Note: &lt;&lt;&lt; 使わないのでコメント化</span></a>
<a class="sourceLine" id="cb105-14" title="14"></a>
<a class="sourceLine" id="cb105-15" title="15"><span class="co">// history のインスタンスを生成</span></a>
<a class="sourceLine" id="cb105-16" title="16"><span class="kw">const</span> history <span class="op">=</span> <span class="at">createBrowserHistory</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb105-17" title="17"></a>
<a class="sourceLine" id="cb105-18" title="18"><span class="co">// Storeの生成</span></a>
<a class="sourceLine" id="cb105-19" title="19"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(history)<span class="op">;</span></a>
<a class="sourceLine" id="cb105-20" title="20"></a>
<a class="sourceLine" id="cb105-21" title="21"><span class="co">// &lt;ConnectedRouter&gt;を追加</span></a>
<a class="sourceLine" id="cb105-22" title="22"><span class="at">render</span>(</a>
<a class="sourceLine" id="cb105-23" title="23">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb105-24" title="24">    <span class="op">&lt;</span>ConnectedRouter history<span class="op">={</span>history<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb105-25" title="25">      <span class="op">&lt;</span>TodoApp /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb105-26" title="26">    &lt;/ConnectedRouter<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb105-27" title="27">  &lt;/Provider<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb105-28" title="28">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb105-29" title="29">)<span class="op">;</span></a></code></pre></div>
<p><code>src/store/index.js</code>でReducerの合成をしたため、Reducerの構成が変更になっています。</p>
<p>Storeの構成</p>
<p>↓</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb106-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb106-2" title="2">  <span class="dt">tasks</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb106-3" title="3">    <span class="dt">task</span><span class="op">:</span> <span class="st">&quot;&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb106-4" title="4">    <span class="dt">tasks</span><span class="op">:</span> []</a>
<a class="sourceLine" id="cb106-5" title="5">  <span class="op">},</span></a>
<a class="sourceLine" id="cb106-6" title="6">  <span class="dt">router</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb106-7" title="7">    <span class="dt">location</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb106-8" title="8">      <span class="co">// ルーティング情報</span></a>
<a class="sourceLine" id="cb106-9" title="9">    <span class="op">}</span></a>
<a class="sourceLine" id="cb106-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb106-11" title="11"><span class="op">}</span></a></code></pre></div>
<p>そのため、<code>src/containers/TodoApp.js</code>の<code>mapStateToProps</code>も変更する必要があります。</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">function</span> <span class="at">mapStateToProps</span>(<span class="op">{</span> tasks <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb107-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb107-3" title="3">    <span class="dt">task</span><span class="op">:</span> <span class="va">tasks</span>.<span class="at">task</span><span class="op">,</span></a>
<a class="sourceLine" id="cb107-4" title="4">    <span class="dt">tasks</span><span class="op">:</span> <span class="va">tasks</span>.<span class="at">tasks</span></a>
<a class="sourceLine" id="cb107-5" title="5">  <span class="op">};</span></a>
<a class="sourceLine" id="cb107-6" title="6"><span class="op">}</span></a></code></pre></div>
<h4 id="action経由によるルーティング">Action経由によるルーティング</h4>
<p><code>routerMiddleware</code>を適用することで、Action経由でルーティングをすることができます。</p>
<p><code>react-router-redux</code>が用意している次のようなActionCreatorを用いたルーティングができるようになります。</p>
<p>push : 履歴に新しいlocationを追加します。</p>
<p>replace : 現在の履歴を新しいlocationに置き換えます。</p>
<p>go : 相対値（1 や -2 など）を指定して、履歴を移動します。</p>
<p>goForward : 履歴を1つ進めます。</p>
<p>goBack : 履歴を1つ戻ります。</p>
<h4 id="ボタンを押すとエラーページに移動するサンプル">ボタンを押すとエラーページに移動するサンプル</h4>
<p><code>src/components/Error.js</code>ファイルを作成します。</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb108-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="im">import</span> <span class="op">{</span> Link <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb108-3" title="3"></a>
<a class="sourceLine" id="cb108-4" title="4"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">Error</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb108-5" title="5">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb108-6" title="6">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb108-7" title="7">      <span class="op">&lt;</span>h1<span class="op">&gt;</span>エラーページ&lt;/h1<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb108-8" title="8">      <span class="op">&lt;</span>Link to<span class="op">=</span><span class="st">&quot;/&quot;</span><span class="op">&gt;</span>戻る&lt;/Link<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb108-9" title="9">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb108-10" title="10">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb108-11" title="11"><span class="op">}</span></a></code></pre></div>
<p><code>src/index.js</code>を変更して、エラーページに移動できるようにします。</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb109-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="im">import</span> <span class="op">{</span> render <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-3" title="3"><span class="im">import</span> <span class="op">{</span> Route <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-dom&#39;</span><span class="op">;</span>     <span class="co">// 追加</span></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-5" title="5"><span class="im">import</span> <span class="op">{</span> ConnectedRouter <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-6" title="6"><span class="im">import</span> createBrowserHistory <span class="im">from</span> <span class="st">&#39;history/createBrowserHistory&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-7" title="7"><span class="im">import</span> TodoApp <span class="im">from</span> <span class="st">&#39;./containers/TodoApp&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-8" title="8"><span class="im">import</span> Error <span class="im">from</span> <span class="st">&#39;./components/Error&#39;</span><span class="op">;</span>       <span class="co">// 追加</span></a>
<a class="sourceLine" id="cb109-9" title="9"><span class="im">import</span> createStore <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb109-10" title="10"></a>
<a class="sourceLine" id="cb109-11" title="11"><span class="co">// Note: 使わないのでコメント化 &gt;&gt;&gt;</span></a>
<a class="sourceLine" id="cb109-12" title="12"><span class="co">// import &#39;./index.css&#39;;</span></a>
<a class="sourceLine" id="cb109-13" title="13"><span class="co">// import App from &#39;./App&#39;;</span></a>
<a class="sourceLine" id="cb109-14" title="14"><span class="co">// import registerServiceWorker from &#39;./registerServiceWorker&#39;;</span></a>
<a class="sourceLine" id="cb109-15" title="15"><span class="co">/// Note: &lt;&lt;&lt; 使わないのでコメント化</span></a>
<a class="sourceLine" id="cb109-16" title="16"></a>
<a class="sourceLine" id="cb109-17" title="17"><span class="co">// history のインスタンスを生成</span></a>
<a class="sourceLine" id="cb109-18" title="18"><span class="kw">const</span> history <span class="op">=</span> <span class="at">createBrowserHistory</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb109-19" title="19"></a>
<a class="sourceLine" id="cb109-20" title="20"><span class="co">// Storeの生成</span></a>
<a class="sourceLine" id="cb109-21" title="21"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(history)<span class="op">;</span></a>
<a class="sourceLine" id="cb109-22" title="22"></a>
<a class="sourceLine" id="cb109-23" title="23"><span class="co">// &lt;ConnectedRouter&gt;を追加</span></a>
<a class="sourceLine" id="cb109-24" title="24"><span class="at">render</span>(</a>
<a class="sourceLine" id="cb109-25" title="25">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb109-26" title="26">    <span class="op">&lt;</span>ConnectedRouter history<span class="op">={</span>history<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb109-27" title="27">      <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb109-28" title="28">        <span class="op">{</span> <span class="co">/* ルーティングさせる */</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb109-29" title="29">        <span class="op">&lt;</span>Route exact path<span class="op">=</span><span class="st">&quot;/&quot;</span> component<span class="op">={</span>TodoApp<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb109-30" title="30">        <span class="op">&lt;</span>Route exact path<span class="op">=</span><span class="st">&quot;/error&quot;</span> component<span class="op">={</span>Error<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb109-31" title="31">      &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb109-32" title="32">    &lt;/ConnectedRouter<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb109-33" title="33">  &lt;/Provider<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb109-34" title="34">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb109-35" title="35">)<span class="op">;</span></a></code></pre></div>
<p><code>react-router-dom</code>のRouteコンポーネントを使ってルーティングを用意しています。</p>
<p><code>/</code> であれば、Todoアプリを表示。 <code>/error</code>であれば、エラーページを表示。</p>
<p><code>src/containers/TodoApp.js</code>にエラーページにリダイレクトさせる処理を追加します。</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb110-1" title="1"><span class="im">import</span> <span class="op">{</span> connect <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="im">import</span> <span class="op">{</span> push <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span><span class="op">;</span>    <span class="co">// 追加</span></a>
<a class="sourceLine" id="cb110-3" title="3"><span class="im">import</span> TodoApp <span class="im">from</span> <span class="st">&#39;../components/TodoApp&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb110-4" title="4"><span class="im">import</span> <span class="op">{</span> inputTask<span class="op">,</span> addTask <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;../actions/tasks&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb110-5" title="5"></a>
<a class="sourceLine" id="cb110-6" title="6"><span class="co">// Storeにある task と tasks という State を Props に渡す</span></a>
<a class="sourceLine" id="cb110-7" title="7"><span class="kw">function</span> <span class="at">mapStateToProps</span>(<span class="op">{</span> tasks <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb110-8" title="8">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb110-9" title="9">    <span class="dt">task</span><span class="op">:</span> <span class="va">tasks</span>.<span class="at">task</span><span class="op">,</span></a>
<a class="sourceLine" id="cb110-10" title="10">    <span class="dt">tasks</span><span class="op">:</span> <span class="va">tasks</span>.<span class="at">tasks</span></a>
<a class="sourceLine" id="cb110-11" title="11">  <span class="op">};</span></a>
<a class="sourceLine" id="cb110-12" title="12"><span class="op">}</span></a>
<a class="sourceLine" id="cb110-13" title="13"></a>
<a class="sourceLine" id="cb110-14" title="14"><span class="co">// 該当のActionをDispatchさせる関数を Props に渡す</span></a>
<a class="sourceLine" id="cb110-15" title="15"><span class="kw">function</span> <span class="at">mapDispatchToProps</span>(dispatch) <span class="op">{</span></a>
<a class="sourceLine" id="cb110-16" title="16">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb110-17" title="17">    <span class="at">addTask</span>(task) <span class="op">{</span></a>
<a class="sourceLine" id="cb110-18" title="18">      <span class="at">dispatch</span>(<span class="at">addTask</span>(task))<span class="op">;</span></a>
<a class="sourceLine" id="cb110-19" title="19">    <span class="op">},</span></a>
<a class="sourceLine" id="cb110-20" title="20">    <span class="at">inputTask</span>(task) <span class="op">{</span></a>
<a class="sourceLine" id="cb110-21" title="21">      <span class="at">dispatch</span>(<span class="at">inputTask</span>(task))</a>
<a class="sourceLine" id="cb110-22" title="22">    <span class="op">},</span></a>
<a class="sourceLine" id="cb110-23" title="23">    <span class="co">// リダイレクト処理を追加</span></a>
<a class="sourceLine" id="cb110-24" title="24">    <span class="co">// react-router-reduxが提供しているpushというActionCreatorを使う</span></a>
<a class="sourceLine" id="cb110-25" title="25">    <span class="at">redirectToError</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb110-26" title="26">      <span class="at">dispatch</span>(<span class="at">push</span>(<span class="st">&#39;/error&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb110-27" title="27">    <span class="op">},</span></a>
<a class="sourceLine" id="cb110-28" title="28">  <span class="op">};</span></a>
<a class="sourceLine" id="cb110-29" title="29"><span class="op">}</span></a>
<a class="sourceLine" id="cb110-30" title="30"></a>
<a class="sourceLine" id="cb110-31" title="31"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(TodoApp)<span class="op">;</span></a></code></pre></div>
<p>リダイレクトする処理を呼び出せるように、<code>src/components/TodoApp.js</code>を変更します。</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb111-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb111-2" title="2"></a>
<a class="sourceLine" id="cb111-3" title="3"><span class="co">// 引数に redirectToError を追加</span></a>
<a class="sourceLine" id="cb111-4" title="4"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">TodoApp</span>(<span class="op">{</span> task<span class="op">,</span> tasks<span class="op">,</span> inputTask<span class="op">,</span> addTask<span class="op">,</span> redirectToError <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb111-5" title="5">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb111-6" title="6">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb111-7" title="7">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;text&quot;</span> onChange<span class="op">={</span>(e) <span class="op">=&gt;</span> <span class="at">inputTask</span>(<span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span>)<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb111-8" title="8">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;button&quot;</span> value<span class="op">=</span><span class="st">&quot;add&quot;</span> onClick<span class="op">={</span>() <span class="op">=&gt;</span> <span class="at">addTask</span>(task)<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb111-9" title="9">      <span class="op">&lt;</span>ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb111-10" title="10">        <span class="op">{</span></a>
<a class="sourceLine" id="cb111-11" title="11">          <span class="va">tasks</span>.<span class="at">map</span>(<span class="kw">function</span>(item<span class="op">,</span> i) <span class="op">{</span></a>
<a class="sourceLine" id="cb111-12" title="12">            <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb111-13" title="13">              <span class="op">&lt;</span>li key<span class="op">={</span>i<span class="op">}&gt;{</span>item<span class="op">}</span>&lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb111-14" title="14">            )<span class="op">;</span></a>
<a class="sourceLine" id="cb111-15" title="15">          <span class="op">}</span>)</a>
<a class="sourceLine" id="cb111-16" title="16">        <span class="op">}</span></a>
<a class="sourceLine" id="cb111-17" title="17">      &lt;/ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb111-18" title="18">      <span class="op">{</span> <span class="co">/* 追加 */</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb111-19" title="19">      <span class="op">&lt;</span>button onClick<span class="op">={</span>() <span class="op">=&gt;</span> <span class="at">redirectToError</span>()<span class="op">}&gt;</span>エラーページへ移動&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb111-20" title="20">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb111-21" title="21">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb111-22" title="22"><span class="op">}</span></a></code></pre></div>
<h2 id="redux-middleware">Redux Middleware</h2>
<p>Redux Middleware とは、Reduxの機能を拡張する仕組みです。</p>
<p>Middleware ＝ 拡張機能</p>
<p>Redux自体は軽量なアーキテクチャなので、単体では提供していない機能もある。</p>
<ul>
<li>Actionのログを取るミドルウェア</li>
<li>非同期処理を可能にするミドルウェア</li>
<li>クラッシュレポートを送信するためのミドルウェア</li>
<li>ルーティングのためのミドルウェア</li>
<li>etc...</li>
</ul>
<h3 id="actionのログを取るミドルウェア">Actionのログを取るミドルウェア</h3>
<p><code>redux-logger</code>はActionがDispatchされる前後のstateと、DispatchされたActionをコンソールに表示します。 開発時に有用なミドルウェアなのでインストールしたほうがよいでしょう。</p>
<h4 id="インストール-2">インストール</h4>
<pre><code>&gt; npm install --save redux-logger
</code></pre>
<!-- TODO: p.143 install が insta'l になっている -->

<h4 id="ミドルウェアの適用">ミドルウェアの適用</h4>
<p>Reduxにミドルウェアを適用するには、<code>applyMiddleware</code>関数を利用します。</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb113-1" title="1"><span class="co">// ミドルウェアの適用に必要な applyMiddleware 関数をインポートします</span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-3" title="3"></a>
<a class="sourceLine" id="cb113-4" title="4"><span class="co">// ミドルウェアをインポートします</span></a>
<a class="sourceLine" id="cb113-5" title="5"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb113-6" title="6"></a>
<a class="sourceLine" id="cb113-7" title="7"><span class="co">// createStoreの第2引数に applyMiddleware を指定し、その引数にミドルウェアを指定します</span></a>
<a class="sourceLine" id="cb113-8" title="8"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb113-9" title="9">  reducer<span class="op">,</span></a>
<a class="sourceLine" id="cb113-10" title="10">  <span class="at">applyMiddleware</span>(logger)</a>
<a class="sourceLine" id="cb113-11" title="11">)<span class="op">;</span></a></code></pre></div>
<p><code>applyMiddleware</code>の引数は可変数なので、複数のミドルウェアを指定するときは、以下のようにカンマ区切りで並べて指定します。</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb114-1" title="1"><span class="at">applyMiddleware</span>(middleware1<span class="op">,</span> middleware2<span class="op">,</span> middleware3)</a></code></pre></div>
<h2 id="非同期処理">非同期処理</h2>
<h3 id="同期処理と非同期処理">同期処理と非同期処理</h3>
<p>同期処理 : 書いた順に実行される処理</p>
<pre><code>~~~Javascript
console.log(&quot;start&quot;);
console.log(1 + 1);
console.log(&quot;end&quot;);
~~~
</code></pre>
<p>非同期処理 : 必ずしも書いた順には実行されない処理</p>
<pre><code>~~~javascript
console.log(&quot;start&quot;);
setTimeout(function () {
  console.log(1 + 1);
}, 1000);
console.log(&quot;end&quot;);
~~~

非同期処理のあとに任意の処理を実行する方法として、コールバック関数やPromise、Async/Awaitなどがあります。
</code></pre>
<h3 id="redux-thunkによる非同期処理">redux-thunkによる非同期処理</h3>
<p>ReduxではAPIから何かレスポンスが返ってきたら、これをActionとして扱うという作法があります。 これを通常のActionCreatorで記述しようとすると、実はうまく書けません。</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb117-1" title="1"><span class="kw">const</span> requestAPI <span class="op">=</span> (parameter) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb117-2" title="2">  <span class="kw">const</span> response <span class="op">=</span> </a>
<a class="sourceLine" id="cb117-3" title="3">    <span class="at">fetch</span>(<span class="st">&#39;APIのURL&#39;</span><span class="op">,</span> parameter).<span class="at">then</span>((response) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb117-4" title="4">      <span class="co">// ここで返してもうまく動かない</span></a>
<a class="sourceLine" id="cb117-5" title="5">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb117-6" title="6">        <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;REQUEST_API&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb117-7" title="7">        <span class="dt">data</span><span class="op">:</span> response</a>
<a class="sourceLine" id="cb117-8" title="8">      <span class="op">};</span></a>
<a class="sourceLine" id="cb117-9" title="9">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb117-10" title="10"><span class="op">};</span></a></code></pre></div>
<p>Action自体は単なるオブジェクトです。これをstore.dispatch()に与えることでActionが実行されます。 どうにかしてdispatch関数をコード中で使いたい。というときにこのミドルウェアの出番です。</p>
<h3 id="thunk-ミドルウェア">thunk ミドルウェア</h3>
<p>Reduxで非同期処理をする代表的なミドルウェア。</p>
<pre><code>&gt; npm install --save redux-thunk
</code></pre>
<p>インストールできたらミドルウェアを適用します。</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb119-1" title="1"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb119-2" title="2"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb119-3" title="3"><span class="im">import</span> thunk <span class="im">from</span> <span class="st">&#39;redux-thunk&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb119-4" title="4"><span class="im">import</span> reducers <span class="im">from</span> <span class="st">&#39;./reducers&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb119-5" title="5"></a>
<a class="sourceLine" id="cb119-6" title="6"><span class="kw">const</span> middlewares <span class="op">=</span> [logger<span class="op">,</span> thunk]<span class="op">;</span></a>
<a class="sourceLine" id="cb119-7" title="7"></a>
<a class="sourceLine" id="cb119-8" title="8"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb119-9" title="9">  reducers<span class="op">,</span></a>
<a class="sourceLine" id="cb119-10" title="10">  <span class="at">applyMiddleware</span>(...<span class="at">middlewares</span>)</a>
<a class="sourceLine" id="cb119-11" title="11">)<span class="op">;</span></a>
<a class="sourceLine" id="cb119-12" title="12"></a>
<a class="sourceLine" id="cb119-13" title="13"><span class="im">export</span> <span class="im">default</span> store<span class="op">;</span></a></code></pre></div>
<h3 id="非同期アクション">非同期アクション</h3>
<p>thunkミドルウェアの適用により、非同期で実行されるActionを書けるようになりました。</p>
<p>次のコードサンプルで使っているshortidパッケージはユニークなIDを自動で生成してくれるものです。 インストールは <code>npm install --save shortid</code> でできます。</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb120-1" title="1"><span class="im">import</span> shortid <span class="im">from</span> <span class="st">&#39;shortid&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb120-2" title="2"></a>
<a class="sourceLine" id="cb120-3" title="3"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> types <span class="im">from</span> <span class="st">&#39;../types/todo&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb120-4" title="4"></a>
<a class="sourceLine" id="cb120-5" title="5"><span class="co">// 同期 ActionCreator</span></a>
<a class="sourceLine" id="cb120-6" title="6"><span class="im">export</span> <span class="kw">function</span> <span class="at">addTodo</span>(title) <span class="op">{</span></a>
<a class="sourceLine" id="cb120-7" title="7">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb120-8" title="8">    <span class="dt">type</span><span class="op">:</span> <span class="va">types</span>.<span class="at">ADD_TODO</span><span class="op">,</span></a>
<a class="sourceLine" id="cb120-9" title="9">    <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb120-10" title="10">      <span class="dt">id</span><span class="op">:</span> <span class="va">shortid</span>.<span class="at">generate</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb120-11" title="11">      title</a>
<a class="sourceLine" id="cb120-12" title="12">    <span class="op">},</span></a>
<a class="sourceLine" id="cb120-13" title="13">  <span class="op">};</span></a>
<a class="sourceLine" id="cb120-14" title="14"><span class="op">}</span></a>
<a class="sourceLine" id="cb120-15" title="15"></a>
<a class="sourceLine" id="cb120-16" title="16"><span class="co">// 非同期 ActionCreator</span></a>
<a class="sourceLine" id="cb120-17" title="17"><span class="im">export</span> <span class="kw">function</span> <span class="at">asyncAddTodo</span>(title) <span class="op">{</span></a>
<a class="sourceLine" id="cb120-18" title="18">  <span class="cf">return</span> (dispatch<span class="op">,</span> getState) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb120-19" title="19">    <span class="at">setTimeout</span>(() <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb120-20" title="20">      <span class="at">dispatch</span>(<span class="at">addTodo</span>(title))<span class="op">;</span></a>
<a class="sourceLine" id="cb120-21" title="21">    <span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb120-22" title="22">  <span class="op">};</span></a>
<a class="sourceLine" id="cb120-23" title="23"><span class="op">}</span></a></code></pre></div>
<p>同期 ActionCreator はActionオブジェクトを返しています。</p>
<p>非同期 ActionCreator は関数を返しています。 thunkミドルウェアにより、通常のActionオブジェクト以外に関数を返せるようになります。 ここで返した関数は、引数としてdispatch関数とgetState関数を取ります。</p>
<p>dispatch関数はActionオブジェクトを受け取りさえすれば、同期的にreducerに処理を移します。</p>
<p>dispatch関数にさらに関数を渡すこともできます。このときも関数の引数としてdispatch関数とgetState関数を取ります。</p>
<p>ポイント : Reduxアプリでは、最終的にdispatch関数にActionオブジェクトを渡せばreducerに処理が移るという原則がある。</p>
<h3 id="thunk-と-promiseasyncawait">thunk と Promise、Async/Await</h3>
<p>Promise :<br />
~~~javascript const sleep1000ms = () =&gt; { return new Promise(resolve =&gt; { setTimeout(() =&gt; { resolve(); }, 1000); }); };</p>
<pre><code>export function addTodo(title) {
  return {
    type: types.ADD_TODO,
    payload: {
      id: shortid.generate(),
      title,
    },
  };
}

// Promise 版
export function asyncAddTodo(title) {
  return (dispatch) =&gt; {
    sleep1000ms().then(() =&gt; {
      dispatch(addTodo(title));
    });
  };
}
~~~
</code></pre>
<p>Async/Await :<br />
~~~javascript const sleep1000ms = () =&gt; { ... 上記サンプルと同じ };</p>
<pre><code>export function addTodo(title) {
  ... 上記サンプルと同じ
}

// Async/Await 版
export function asyncAddTodo(title) {
  return async(dispatch) =&gt; {
    await sleep1000ms();
    dispatch(addTodo(title));
  };
}
~~~
</code></pre>
<h3 id="複数のアクションをまとめる">複数のアクションをまとめる</h3>
<p>通常のActionCreatorでは、1つの関数では1つのActionしか返せませんでした。 thunkはこれらを1つにまとめたActionとして返すことができます。</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">function</span> <span class="at">addTodo</span>(title) <span class="op">{</span></a>
<a class="sourceLine" id="cb123-2" title="2">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb123-3" title="3">    <span class="dt">type</span><span class="op">:</span> <span class="va">types</span>.<span class="at">ADD_TODO</span><span class="op">,</span></a>
<a class="sourceLine" id="cb123-4" title="4">    <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb123-5" title="5">      <span class="dt">id</span><span class="op">:</span> <span class="va">shortid</span>.<span class="at">generate</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb123-6" title="6">      title<span class="op">,</span></a>
<a class="sourceLine" id="cb123-7" title="7">    <span class="op">},</span></a>
<a class="sourceLine" id="cb123-8" title="8">  <span class="op">};</span></a>
<a class="sourceLine" id="cb123-9" title="9"><span class="op">}</span></a>
<a class="sourceLine" id="cb123-10" title="10"></a>
<a class="sourceLine" id="cb123-11" title="11"><span class="kw">function</span> <span class="at">updateInput</span>(value) <span class="op">{</span></a>
<a class="sourceLine" id="cb123-12" title="12">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb123-13" title="13">    <span class="dt">type</span><span class="op">:</span> <span class="va">types</span>.<span class="at">UPDATE_INPUT</span><span class="op">,</span></a>
<a class="sourceLine" id="cb123-14" title="14">    <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb123-15" title="15">      value<span class="op">,</span></a>
<a class="sourceLine" id="cb123-16" title="16">    <span class="op">},</span></a>
<a class="sourceLine" id="cb123-17" title="17">  <span class="op">};</span></a>
<a class="sourceLine" id="cb123-18" title="18"><span class="op">}</span></a>
<a class="sourceLine" id="cb123-19" title="19"></a>
<a class="sourceLine" id="cb123-20" title="20"><span class="co">// 上の2つのActionを1つにまとめる</span></a>
<a class="sourceLine" id="cb123-21" title="21"><span class="co">// これをReactコンポーネントにバインドする</span></a>
<a class="sourceLine" id="cb123-22" title="22"><span class="im">export</span> <span class="kw">function</span> <span class="at">addTodoAndClear</span>(title) <span class="op">{</span></a>
<a class="sourceLine" id="cb123-23" title="23">  <span class="cf">return</span> (dispatch) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb123-24" title="24">    <span class="at">dispatch</span>(<span class="at">addTodo</span>(title))<span class="op">;</span></a>
<a class="sourceLine" id="cb123-25" title="25">    <span class="at">dispatch</span>(<span class="at">updateInput</span>(<span class="st">&#39;&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb123-26" title="26">  <span class="op">};</span></a>
<a class="sourceLine" id="cb123-27" title="27"><span class="op">}</span></a></code></pre></div>
<p>1つの操作で複数の処理を行うときのアプローチとして、以下が考えられます。</p>
<ul>
<li>ActionCreatorでまとめる。</li>
<li>1つのActionとして記述し、reducerで2つの操作を行う。</li>
<li>複数のActionをReactコンポーネントのボタンにバインドする。</li>
</ul>
<p>ActionCreatorでまとめるのがベターな方法です。 理由は次の2つです。</p>
<ol>
<li><p>それぞれのActionの処理を独立して考えられる。</p>
<p>サンプルコードの場合、TODOを追加することと、フォームをクリアすることに直接の関係はありません。 TODOをコピーするときなどフォームを使わずにTODOを追加する方法を増やすときは、addTodo関数については再利用ができそうです。</p></li>
<li><p>ActionCreatorをユーザー操作とひも付けられる。</p>
<p>ActionCreatorはContainerコンポーネントからpropsとしてUI要素を持つプレゼンテーショナルコンポーネントに渡されるはずです。 このとき、プレゼンテーショナルコンポーネントは「このボタンを押すと何が起きるかはわからないが、渡された関数を叩けばよい」というように作られているべきです。</p>
<p>ボタンを押したら「TODOを追加する関数を叩く」のと「フォームをクリアする関数を叩く」ことをプレゼンテーショナルコンポーネントに書いてしまうと、コンポーネントはビジネスロジックや仕様を反映し、汎用性を失ってしまいます。</p></li>
</ol>
<h3 id="getstate関数">getState関数</h3>
<p>getState関数はstoreが持つ関数と同一で、すべてのstateを返します。 ActionCreator内でstoreの内容を知ることで、できることが広がります。</p>
<p>たとえば、登録済みのTODOは追加しないようにする。など。</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb124-1" title="1"><span class="im">export</span> <span class="kw">function</span> <span class="at">addUniqueTodo</span>(title) <span class="op">{</span></a>
<a class="sourceLine" id="cb124-2" title="2">  <span class="cf">return</span> (dispatch<span class="op">,</span> getState) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb124-3" title="3">    <span class="kw">const</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb124-4" title="4">      <span class="dt">todo</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb124-5" title="5">        todos<span class="op">,</span></a>
<a class="sourceLine" id="cb124-6" title="6">      <span class="op">},</span></a>
<a class="sourceLine" id="cb124-7" title="7">    <span class="op">}</span> <span class="op">=</span> <span class="at">getState</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb124-8" title="8">    </a>
<a class="sourceLine" id="cb124-9" title="9">    <span class="co">// stateに保存されたTodoに同一のタイトルがあったら登録済み</span></a>
<a class="sourceLine" id="cb124-10" title="10">    <span class="kw">const</span> isDuplicated <span class="op">=</span> <span class="va">todos</span>.<span class="at">some</span>(todo <span class="op">=&gt;</span> <span class="va">todo</span>.<span class="at">title</span> <span class="op">===</span> title)<span class="op">;</span></a>
<a class="sourceLine" id="cb124-11" title="11">    </a>
<a class="sourceLine" id="cb124-12" title="12">    <span class="cf">if</span> (isDuplicated) <span class="op">{</span></a>
<a class="sourceLine" id="cb124-13" title="13">      <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb124-14" title="14">    <span class="op">}</span></a>
<a class="sourceLine" id="cb124-15" title="15">    <span class="at">dispatch</span>(<span class="at">addTodo</span>(title))<span class="op">;</span></a>
<a class="sourceLine" id="cb124-16" title="16">  <span class="op">};</span></a>
<a class="sourceLine" id="cb124-17" title="17"><span class="op">}</span></a></code></pre></div>
<p>この処理はReducerでもできますが、ActionCreatorで処理すると次のメリットがあります。</p>
<ol>
<li><p>すべてのstateを参照できる</p>
<p>分割されたReducerは、ほかのReducerが持っているstateを参照することができません。 ほかのReducerが持っているstateを使ってActionの動作を振り分けたいときは、ActionCreatorでgetStateするのがよいでしょう。</p></li>
<li><p>Action、Reducerの処理を簡潔にできる</p>
<p>〝ActionをどうDispatchするか〟の部分をActionCreatorとして切り出しておくことで、アクションとそれに対応するReducerの処理を簡潔にできます。</p></li>
</ol>
<h2 id="uiをきれいにする">UIをきれいにする</h2>
<h3 id="style属性を使う方法">style属性を使う方法</h3>
<p>※style属性を使っての指定は非推奨です。</p>
<ul>
<li><p>JSXのstyle属性を使って、直接スタイルを適用できる。</p></li>
<li><p>オブジェクトのキーにCSSプロパティをキャメルケースで指定、オブジェクトの値にCSSの値を指定します。</p></li>
<li><p>値にNumber型を指定したときは自動でpxが追加されます。px以外の単位を指定するときは、単位付きの値を文字列で指定します。</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb125-1" title="1"><span class="co">// font-size: 20px</span></a>
<a class="sourceLine" id="cb125-2" title="2"><span class="op">&lt;</span>div style<span class="op">={{</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="dv">20</span> <span class="op">}}&gt;</span></a>
<a class="sourceLine" id="cb125-3" title="3">  Hello World</a>
<a class="sourceLine" id="cb125-4" title="4">&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb125-5" title="5"></a>
<a class="sourceLine" id="cb125-6" title="6"><span class="co">// font-size: 2em</span></a>
<a class="sourceLine" id="cb125-7" title="7"><span class="op">&lt;</span>div style<span class="op">={{</span> <span class="dt">fontSize</span><span class="op">:</span> <span class="st">&quot;2em&quot;</span> <span class="op">}}&gt;</span></a>
<a class="sourceLine" id="cb125-8" title="8">  Hello World</a>
<a class="sourceLine" id="cb125-9" title="9">&lt;/div<span class="op">&gt;</span></a></code></pre></div></li>
<li><p>ベンダープレフィクスは自動で付与されません。自分で指定する必要があります。</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">const</span> style <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb126-2" title="2">  <span class="co">// ベンダープレフィクス付きのスタイル</span></a>
<a class="sourceLine" id="cb126-3" title="3">  <span class="dt">WebkitTransition</span><span class="op">:</span> <span class="st">&quot;all&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb126-4" title="4">  <span class="co">// 通常のスタイル</span></a>
<a class="sourceLine" id="cb126-5" title="5">  <span class="dt">transition</span><span class="op">:</span> <span class="st">&quot;all&quot;</span></a>
<a class="sourceLine" id="cb126-6" title="6"><span class="op">};</span></a>
<a class="sourceLine" id="cb126-7" title="7"></a>
<a class="sourceLine" id="cb126-8" title="8"><span class="kw">const</span> HelloWorldComponent <span class="op">=</span> () <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb126-9" title="9">  <span class="cf">return</span> <span class="op">&lt;</span>div style<span class="op">={</span> style <span class="op">}&gt;</span>Hello World&lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb126-10" title="10"><span class="op">}</span></a></code></pre></div></li>
</ul>
<h3 id="classname属性を使う方法">className属性を使う方法</h3>
<p>JSXのclassName属性を使って、CSSクラスの指定ができます。className属性に指定した内容が、HTMLのclass属性となります。</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">const</span> Button <span class="op">=</span> () <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb127-2" title="2">  <span class="cf">return</span> <span class="op">&lt;</span>button className<span class="op">=</span><span class="st">&quot;normal-button&quot;</span><span class="op">&gt;</span>追加&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb127-3" title="3"><span class="op">}</span></a></code></pre></div>
<!-- TODO: p.169 リスト9.4　<button>要素で始まっているのに、閉じタグが</div>　リスト9.6も同様 -->

<p><code>webpack</code>、<code>css-loader</code>、<code>style-loader</code>などのライブラリを組み合わせることで、JavaScriptからCSSファイルの読み込みができるようになります。 <code>create-react-app</code>では、標準でCSSファイルのインポートがサポートされています。</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb128-1" title="1"><span class="im">import</span> <span class="st">&quot;./style.css&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb128-2" title="2"></a>
<a class="sourceLine" id="cb128-3" title="3"><span class="kw">const</span> Button <span class="op">=</span> () <span class="op">=&gt;</span></a>
<a class="sourceLine" id="cb128-4" title="4">  <span class="op">&lt;</span>button className<span class="op">=</span><span class="st">&quot;normal-button&quot;</span><span class="op">&gt;</span>追加&lt;/button<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb128-5" title="5"></a>
<a class="sourceLine" id="cb128-6" title="6"><span class="im">export</span> <span class="im">default</span> Button<span class="op">;</span></a></code></pre></div>
<h3 id="uiライブラリを使う">UIライブラリを使う</h3>
<ul>
<li><p>Material-UI</p>
<p>マテリアルデザインに沿って作られたUIライブラリ。</p></li>
<li><p>React-Bootstrap</p>
<p>BootstrapをReact向けのUIライブラリとして実装したもの。</p></li>
<li><p>React Desktop</p>
<p>デスクトップネイティブアプリの開発を想定したReact向けUIライブラリ。 Electronなどで利用します。</p></li>
<li><p>Onsen UI</p>
<p>ネイティブアプリライクなモバイルウェブアプリの作成に特化したUIライブラリ。</p></li>
</ul>
<h3 id="material-ui">Material-UI</h3>
<p>マテリアルデザインに則ったUIを簡単に実装することができます。 ボタンやフォームなどの基本的なUIパーツが網羅されています。</p>
<p>各UIパーツはReactコンポーネントとして実装されており、props経由でコンポーネントをカスタマイズできます。</p>
<p>パッケージは、次のコマンドでインストールできます。</p>
<p>こちらだと v0.20.0 がインストールされます。</p>
<pre><code>&gt; npm install --save material-ui
</code></pre>
<p>最新をインストールしたければ次のコマンドにします。 2018年3月8日時点で v1.0.0-beta.36がインストールされました。</p>
<pre><code>&gt; npm install --save material-ui@next
</code></pre>
<p>※以降のサンプルは<code>@next</code>でインストールしたものを対象としています。</p>
<h4 id="使い方">使い方</h4>
<p><code>src/components/TodoApp.js</code>を修正します。</p>
<ol>
<li><p>インポートを追加します。</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb131-1" title="1"><span class="im">import</span> Reboot <span class="im">from</span> <span class="st">&#39;material-ui/Reboot&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb131-2" title="2"><span class="im">import</span> Button <span class="im">from</span> <span class="st">&#39;material-ui/Button&#39;</span><span class="op">;</span></a></code></pre></div></li>
<li><p>Rebootコンポーネントを追加します。 場所はどこでもよいですが、今回はルート要素の最初の子要素にしました。</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb132-1" title="1"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">TodoApp</span>(<span class="op">{</span> task<span class="op">,</span> tasks<span class="op">,</span> inputTask<span class="op">,</span> addTask<span class="op">,</span> redirectToError <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb132-2" title="2">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb132-3" title="3">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb132-4" title="4">      <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;text&quot;</span> onChange<span class="op">={</span>(e) <span class="op">=&gt;</span> <span class="at">inputTask</span>(<span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span>)<span class="op">}</span> /&gt;</a></code></pre></div>
<p>↓</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb133-1" title="1"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">TodoApp</span>(<span class="op">{</span> task<span class="op">,</span> tasks<span class="op">,</span> inputTask<span class="op">,</span> addTask<span class="op">,</span> redirectToError <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb133-2" title="2"> <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb133-3" title="3">   <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb133-4" title="4">     <span class="op">&lt;</span>Reboot /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb133-5" title="5">     <span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;text&quot;</span> onChange<span class="op">={</span>(e) <span class="op">=&gt;</span> <span class="at">inputTask</span>(<span class="va">e</span>.<span class="va">target</span>.<span class="at">value</span>)<span class="op">}</span> /&gt;</a></code></pre></div></li>
<li><p>input要素で作っていたボタンを、Buttonコンポーネントに変更します。</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb134-1" title="1"><span class="op">&lt;</span>input type<span class="op">=</span><span class="st">&quot;button&quot;</span> value<span class="op">=</span><span class="st">&quot;add&quot;</span> onClick<span class="op">={</span>() <span class="op">=&gt;</span> <span class="at">addTask</span>(task)<span class="op">}</span> /&gt;</a></code></pre></div>
<p>↓</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb135-1" title="1"><span class="op">&lt;</span>Button variant<span class="op">=</span><span class="st">&quot;raised&quot;</span> className<span class="op">=</span><span class="st">&quot;default&quot;</span> onClick<span class="op">={</span>() <span class="op">=&gt;</span> <span class="at">addTask</span>(task)<span class="op">}&gt;</span>add&lt;/Button<span class="op">&gt;</span></a></code></pre></div></li>
</ol>
<h2 id="note">Note</h2>
<h3 id="reduxの三原則">Reduxの三原則</h3>
<p>Single source of truth : アプリケーション内のすべての状態を一つの大きなオブジェクトとして管理します。</p>
<p>State in read-only : アプリケーションの状態はコンポーネントから直接参照できますが、直接変更することはできません。 Action（どんな動作を行ったのかを示す単純なオブジェクト）をdispatch（発行）することが、アプリケーションの状態を変更する唯一の方法です。</p>
<p>Changes are made with pure functions : アプリケーションの状態の変更は、副作用のない純粋関数によって行われます。 〝純粋関数〟とは〝同じ入力を渡せば、同じ出力が得られる関数〟のことです。</p>
<h3 id="ie11-arrayprototypefind-メソッドがエラーになる">IE11 Array.prototype.find メソッドがエラーになる</h3>
<p>IE11 では Array.prototype.find メソッドがサポートされていないのでエラーになります。</p>
<p>対応させるためには Polyfill で代替コードを実装する必要があります。</p>
<h2 id="一連の流れを通しで">一連の流れを通しで</h2>
<ol>
<li><p>プロジェクトを作成して、ルートフォルダに移動します。</p>
<pre><code>&gt; .\node_modules\.bin\create-react-app app-1st
&gt; cd app-1st
</code></pre></li>
<li><p>propTypesをインストールします。</p>
<pre><code>&gt; npm install --save prop-types
</code></pre>
<p>propTypesはpropsの型チェック機能を持つパッケージです。</p></li>
<li><p>アプリケーションを開発モードで起動します。</p>
<p>ブラウザが自動で起動して、<code>http://localhost:3000/</code>にアクセスします。</p>
<pre><code>&gt; npm start
</code></pre></li>
<li><p>ファイル/フォルダ構成に則り、フォルダを作ります。 あとから作り直せばいいので、構成はあまり悩まなくてよいです。</p>
<p>今回はサンプルと同じにします。</p>
<pre><code>src/
+---index.js  ... エントリポイント
+---App.js    ... ルートコンポーネント
+---components/
|     ... Presentational Component を置く
+---containers/
|     ... Container Component を置く
+---actions/
|     ... ActionCreator を置く
+---reducers/
|     ... Reducer を置く
`---store/
      ... Store を置く（createStore関数）
</code></pre>
<pre><code>&gt; mkdir .\src\containers
&gt; mkdir .\src\components
&gt; mkdir .\src\actions
&gt; mkdir .\src\reducers
&gt; mkdir .\src\store
</code></pre></li>
<li><p>Reduxをインストールします。</p>
<p>Reduxを開発で使う場合、開発が進んでからインストールするのは導入コストが高くなるため、開発開始時に導入しておきます。</p>
<pre><code>&gt; npm install --save redux react-redux redux-logger
</code></pre>
<p>ReduxのStoreの作成にはReducerが必要です。 ［<code>src\reducers\index.js</code>］にReducerを追加します。</p>
<p>この時点では、単純に受け取ったstateをそのまま返すReducerを定義しておきます。</p>
<p>1つのReducerでアプリケーションが完結することはまずないので、［<code>src\reducers\index.js</code>］に各Reducerの参照を束ねて、<code>import * as reducers from "./reducers"</code>でまとめてimportできる作りにしておきます。</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb142-1" title="1"><span class="co">// 受け取ったstateをそのまま返すReducer</span></a>
<a class="sourceLine" id="cb142-2" title="2"><span class="im">export</span> <span class="kw">const</span> noop <span class="op">=</span> (state <span class="op">=</span> <span class="op">{}</span>) <span class="op">=&gt;</span> state<span class="op">;</span></a></code></pre></div>
<p>[<code>src\store\index.js</code>]にreduxのcreateStore関数を定義します。</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb143-1" title="1"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> combineReducers<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb143-2" title="2"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb143-3" title="3"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> reducers <span class="im">from</span> <span class="st">&#39;../reducers&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb143-4" title="4"></a>
<a class="sourceLine" id="cb143-5" title="5"><span class="co">// Storeを生成するための関数を定義</span></a>
<a class="sourceLine" id="cb143-6" title="6"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">createStoreEx</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb143-7" title="7">  <span class="cf">return</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb143-8" title="8">    <span class="co">// 複数のReducerをまとめる</span></a>
<a class="sourceLine" id="cb143-9" title="9">    <span class="at">combineReducers</span>(reducers)<span class="op">,</span></a>
<a class="sourceLine" id="cb143-10" title="10">    <span class="co">// ミドルウェアを適用する</span></a>
<a class="sourceLine" id="cb143-11" title="11">    <span class="at">applyMiddleware</span>(logger)</a>
<a class="sourceLine" id="cb143-12" title="12">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb143-13" title="13"><span class="op">}</span></a></code></pre></div>
<p>［<code>src\index.js</code>］でStoreを生成し、react-reduxのProviderコンポーネントでAppコンポーネントに関連付ける処理を記述します。</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb144-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb144-2" title="2"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb144-3" title="3"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb144-4" title="4"><span class="im">import</span> App <span class="im">from</span> <span class="st">&#39;./App&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb144-5" title="5"><span class="im">import</span> createStoreEx <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb144-6" title="6"></a>
<a class="sourceLine" id="cb144-7" title="7"><span class="co">// Storeの生成</span></a>
<a class="sourceLine" id="cb144-8" title="8"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStoreEx</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb144-9" title="9"></a>
<a class="sourceLine" id="cb144-10" title="10"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb144-11" title="11">  <span class="co">// Providerコンポーネントを使って、StoreをAppコンポーネントに関連付ける</span></a>
<a class="sourceLine" id="cb144-12" title="12">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb144-13" title="13">    <span class="op">&lt;</span>App /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb144-14" title="14">  &lt;/Provider<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb144-15" title="15">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb144-16" title="16">)<span class="op">;</span></a></code></pre></div></li>
<li><p>ルーティングライブラリの導入</p>
<p>こちらも開発開始時に導入しておきます。</p>
<p>Note : 最新版の React Router （ver 4.x）に対応した react-router-redux パッケージのバージョンは ver 5.x なので、<code>@next</code>をつけてインストールします（2018年3月8日時点）。</p>
<pre><code>&gt; npm install --save react-router-dom history react-router-redux@next
</code></pre>
<p>Storeを生成する関数に、routerReducerとrouterMiddlewareを追加します。</p>
<p>[<code>src\store\index.js</code>]</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb146-1" title="1"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> combineReducers<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb146-2" title="2"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb146-3" title="3"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> reducers <span class="im">from</span> <span class="st">&#39;../reducers&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb146-4" title="4"><span class="im">import</span> <span class="op">{</span> routerReducer<span class="op">,</span> routerMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb146-5" title="5"></a>
<a class="sourceLine" id="cb146-6" title="6"><span class="co">// Storeを生成するための関数を定義</span></a>
<a class="sourceLine" id="cb146-7" title="7"><span class="co">// history は src/index.js から受け渡す</span></a>
<a class="sourceLine" id="cb146-8" title="8"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">createStoreEx</span>(history) <span class="op">{</span></a>
<a class="sourceLine" id="cb146-9" title="9">  <span class="cf">return</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb146-10" title="10">    <span class="co">// 複数のReducerをまとめる</span></a>
<a class="sourceLine" id="cb146-11" title="11">    <span class="co">//   ・自前で定義したReducer</span></a>
<a class="sourceLine" id="cb146-12" title="12">    <span class="co">//   ・react-router-redux の Reducer</span></a>
<a class="sourceLine" id="cb146-13" title="13">    <span class="at">combineReducers</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb146-14" title="14">      ...<span class="at">reducers</span><span class="op">,</span></a>
<a class="sourceLine" id="cb146-15" title="15">      <span class="dt">router</span><span class="op">:</span> routerReducer<span class="op">,</span></a>
<a class="sourceLine" id="cb146-16" title="16">    <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb146-17" title="17">    <span class="co">// ミドルウェアを適用する</span></a>
<a class="sourceLine" id="cb146-18" title="18">    <span class="co">// react-router-redux の Redux Middleware</span></a>
<a class="sourceLine" id="cb146-19" title="19">    <span class="at">applyMiddleware</span>(</a>
<a class="sourceLine" id="cb146-20" title="20">      logger<span class="op">,</span></a>
<a class="sourceLine" id="cb146-21" title="21">      <span class="at">routerMiddleware</span>(history)</a>
<a class="sourceLine" id="cb146-22" title="22">    )</a>
<a class="sourceLine" id="cb146-23" title="23">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb146-24" title="24"><span class="op">}</span></a></code></pre></div>
<p>[<code>src\index.js</code>]</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb147-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-2" title="2"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-3" title="3"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-4" title="4"><span class="im">import</span> <span class="op">{</span> ConnectedRouter <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-5" title="5"><span class="im">import</span> createBrowserHistory <span class="im">from</span> <span class="st">&#39;history/createBrowserHistory&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-6" title="6"><span class="im">import</span> App <span class="im">from</span> <span class="st">&#39;./App&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-7" title="7"><span class="im">import</span> createStoreEx <span class="im">from</span> <span class="st">&#39;./store&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb147-8" title="8"></a>
<a class="sourceLine" id="cb147-9" title="9"><span class="co">// history のインスタンスを生成</span></a>
<a class="sourceLine" id="cb147-10" title="10"><span class="kw">const</span> history <span class="op">=</span> <span class="at">createBrowserHistory</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb147-11" title="11"></a>
<a class="sourceLine" id="cb147-12" title="12"><span class="co">// Storeの生成</span></a>
<a class="sourceLine" id="cb147-13" title="13"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStoreEx</span>(history)<span class="op">;</span></a>
<a class="sourceLine" id="cb147-14" title="14"></a>
<a class="sourceLine" id="cb147-15" title="15"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb147-16" title="16">  <span class="co">// Providerコンポーネントを使って、StoreをAppコンポーネントに関連付ける</span></a>
<a class="sourceLine" id="cb147-17" title="17">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb147-18" title="18">    <span class="op">{</span></a>
<a class="sourceLine" id="cb147-19" title="19">      <span class="co">/* Link コンポーネントなどが動作するように、</span></a>
<a class="sourceLine" id="cb147-20" title="20"><span class="co">         react-router-dom の Router ではなく</span></a>
<a class="sourceLine" id="cb147-21" title="21"><span class="co">         react-router-redux の ConnectedRouter を使う</span></a>
<a class="sourceLine" id="cb147-22" title="22"><span class="co">       */</span></a>
<a class="sourceLine" id="cb147-23" title="23">    <span class="op">}</span></a>
<a class="sourceLine" id="cb147-24" title="24">    <span class="op">&lt;</span>ConnectedRouter history<span class="op">={</span>history<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb147-25" title="25">      <span class="op">&lt;</span>App /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb147-26" title="26">    &lt;/ConnectedRouter<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb147-27" title="27">  &lt;/Provider<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb147-28" title="28">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb147-29" title="29">)<span class="op">;</span></a></code></pre></div></li>
<li><p>ルーティングの実装</p>
<p>コンポーネントを作ります。</p>
<p>[<code>src\components\Ranking.js</code>]</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb148-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb148-2" title="2"><span class="im">import</span> PropTypes <span class="im">from</span> <span class="st">&#39;prop-types&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb148-3" title="3"></a>
<a class="sourceLine" id="cb148-4" title="4"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">Ranking</span>(<span class="op">{</span> categoryId <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb148-5" title="5">  <span class="co">// </span><span class="al">TODO</span><span class="co">: 最終的には categoryId をもとにAPIから情報を取得する</span></a>
<a class="sourceLine" id="cb148-6" title="6">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb148-7" title="7">    <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb148-8" title="8">      <span class="op">&lt;</span>h2<span class="op">&gt;</span>Ranking Component&lt;/h2<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb148-9" title="9">      <span class="op">&lt;</span>p<span class="op">&gt;</span>Category <span class="dt">Id</span><span class="op">:</span> <span class="op">{</span>categoryId<span class="op">}</span>&lt;/p<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb148-10" title="10">    &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb148-11" title="11">  )</a>
<a class="sourceLine" id="cb148-12" title="12"><span class="op">}</span></a>
<a class="sourceLine" id="cb148-13" title="13"></a>
<a class="sourceLine" id="cb148-14" title="14"><span class="co">// propsのデータ型を定義</span></a>
<a class="sourceLine" id="cb148-15" title="15"><span class="va">Ranking</span>.<span class="at">propTypes</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb148-16" title="16">  <span class="dt">categoryId</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">string</span></a>
<a class="sourceLine" id="cb148-17" title="17"><span class="op">};</span></a>
<a class="sourceLine" id="cb148-18" title="18"></a>
<a class="sourceLine" id="cb148-19" title="19"><span class="co">// 未指定時の既定値を定義</span></a>
<a class="sourceLine" id="cb148-20" title="20"><span class="va">Ranking</span>.<span class="at">defaultProps</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb148-21" title="21">  <span class="dt">categoryId</span><span class="op">:</span> <span class="st">&quot;1&quot;</span></a>
<a class="sourceLine" id="cb148-22" title="22"><span class="op">};</span></a></code></pre></div>
<p>ルーティングの設定は [<code>src\App.js</code>] に記述します。</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb149-1" title="1"><span class="im">import</span> React<span class="op">,</span> <span class="op">{</span> Component <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb149-2" title="2"><span class="im">import</span> <span class="op">{</span> Route<span class="op">,</span> Link <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb149-3" title="3"><span class="im">import</span> Ranking <span class="im">from</span> <span class="st">&#39;./components/Ranking&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb149-4" title="4"></a>
<a class="sourceLine" id="cb149-5" title="5"><span class="kw">class</span> App <span class="kw">extends</span> Component <span class="op">{</span></a>
<a class="sourceLine" id="cb149-6" title="6">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb149-7" title="7">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb149-8" title="8">      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;App&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb149-9" title="9">        <span class="op">{</span> <span class="co">/* カテゴリ名、IDはハードコード。本来であればAPIから取得するのが望ましい。 */</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb149-10" title="10">        <span class="op">&lt;</span>ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb149-11" title="11">          <span class="op">&lt;</span>li<span class="op">&gt;&lt;</span>Link to<span class="op">=</span><span class="st">&quot;/all&quot;</span><span class="op">&gt;</span>Category All&lt;/Link<span class="op">&gt;</span>&lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb149-12" title="12">          <span class="op">&lt;</span>li<span class="op">&gt;&lt;</span>Link to<span class="op">=</span><span class="st">&quot;/category/2502&quot;</span><span class="op">&gt;</span>Category <span class="dv">2502</span>&lt;/Link<span class="op">&gt;</span>&lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb149-13" title="13">          <span class="op">&lt;</span>li<span class="op">&gt;&lt;</span>Link to<span class="op">=</span><span class="st">&quot;/category/10002&quot;</span><span class="op">&gt;</span>Category <span class="dv">10002</span>&lt;/Link<span class="op">&gt;</span>&lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb149-14" title="14">        &lt;/ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb149-15" title="15">        </a>
<a class="sourceLine" id="cb149-16" title="16">        <span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/all&quot;</span> component<span class="op">={</span>Ranking<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb149-17" title="17">        <span class="op">&lt;</span>Route</a>
<a class="sourceLine" id="cb149-18" title="18">          path<span class="op">=</span><span class="st">&quot;/category/:id&quot;</span></a>
<a class="sourceLine" id="cb149-19" title="19">          render<span class="op">={</span></a>
<a class="sourceLine" id="cb149-20" title="20">            (<span class="op">{</span> match <span class="op">}</span>) <span class="op">=&gt;</span> <span class="op">&lt;</span>Ranking categoryId<span class="op">={</span><span class="va">match</span>.<span class="va">params</span>.<span class="at">id</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb149-21" title="21">          <span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb149-22" title="22">      &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb149-23" title="23">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb149-24" title="24">  <span class="op">}</span></a>
<a class="sourceLine" id="cb149-25" title="25"><span class="op">}</span></a>
<a class="sourceLine" id="cb149-26" title="26"></a>
<a class="sourceLine" id="cb149-27" title="27"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div></li>
<li><p>非同期処理の実装</p>
<p>インストール</p>
<pre><code>&gt; npm install --save redux-thunk fetch-jsonp qs
</code></pre>
<p>fetch-jsonp : XMLHttpRequestの後継であるfetch関数と同じインターフェースでJSONPのAPIで通信できるライブラリ。</p>
<p>qs : URLのクエリ文字列（URLの ? のあとにつく key=value&amp;hoge=fuga の部分）を扱うライブラリ。</p>
<p>ミドルウェアに redux-thunk を追加するため、[<code>src\store\index.js</code>]を修正します。</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb151-1" title="1"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> combineReducers<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb151-2" title="2"><span class="im">import</span> logger <span class="im">from</span> <span class="st">&#39;redux-logger&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb151-3" title="3"><span class="im">import</span> thunk <span class="im">from</span> <span class="st">&#39;redux-thunk&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb151-4" title="4"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> reducers <span class="im">from</span> <span class="st">&#39;../reducers&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb151-5" title="5"><span class="im">import</span> <span class="op">{</span> routerReducer<span class="op">,</span> routerMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb151-6" title="6"></a>
<a class="sourceLine" id="cb151-7" title="7"><span class="co">// Storeを生成するための関数を定義</span></a>
<a class="sourceLine" id="cb151-8" title="8"><span class="co">// history は src/index.js から受け渡す</span></a>
<a class="sourceLine" id="cb151-9" title="9"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">createStoreEx</span>(history) <span class="op">{</span></a>
<a class="sourceLine" id="cb151-10" title="10">  <span class="cf">return</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb151-11" title="11">    <span class="co">// 複数のReducerをまとめる</span></a>
<a class="sourceLine" id="cb151-12" title="12">    <span class="co">//   ・自前で定義したReducer</span></a>
<a class="sourceLine" id="cb151-13" title="13">    <span class="co">//   ・react-router-redux の Reducer</span></a>
<a class="sourceLine" id="cb151-14" title="14">    <span class="at">combineReducers</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb151-15" title="15">      ...<span class="at">reducers</span><span class="op">,</span></a>
<a class="sourceLine" id="cb151-16" title="16">      <span class="dt">router</span><span class="op">:</span> routerReducer<span class="op">,</span></a>
<a class="sourceLine" id="cb151-17" title="17">    <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb151-18" title="18">    <span class="co">// ミドルウェアを適用する</span></a>
<a class="sourceLine" id="cb151-19" title="19">    <span class="co">// react-router-redux の Redux Middleware</span></a>
<a class="sourceLine" id="cb151-20" title="20">    <span class="at">applyMiddleware</span>(</a>
<a class="sourceLine" id="cb151-21" title="21">      logger<span class="op">,</span></a>
<a class="sourceLine" id="cb151-22" title="22">      thunk<span class="op">,</span></a>
<a class="sourceLine" id="cb151-23" title="23">      <span class="at">routerMiddleware</span>(history)</a>
<a class="sourceLine" id="cb151-24" title="24">    )</a>
<a class="sourceLine" id="cb151-25" title="25">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb151-26" title="26"><span class="op">}</span></a></code></pre></div>
<p>APIからデータを取得し、ReduxのStoreを経由してコンポーネントに表示する処理を実装します。</p>
<p>ComponentからActionを呼び出す部分。</p>
<p>[<code>src\components\Ranking.js</code>]</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb152-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb152-2" title="2"><span class="im">import</span> PropTypes <span class="im">from</span> <span class="st">&#39;prop-types&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb152-3" title="3"></a>
<a class="sourceLine" id="cb152-4" title="4"><span class="co">// ライフサイクルメソッドを使うので function から class に変更</span></a>
<a class="sourceLine" id="cb152-5" title="5"><span class="im">export</span> <span class="im">default</span> <span class="kw">class</span> Ranking <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb152-6" title="6"></a>
<a class="sourceLine" id="cb152-7" title="7">  <span class="at">componentWillMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb152-8" title="8">    <span class="kw">this</span>.<span class="va">props</span>.<span class="at">onMount</span>(<span class="kw">this</span>.<span class="va">props</span>.<span class="at">categoryId</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb152-9" title="9">  <span class="op">}</span></a>
<a class="sourceLine" id="cb152-10" title="10">  </a>
<a class="sourceLine" id="cb152-11" title="11">  <span class="at">componentWillReceiveProps</span>(nextProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb152-12" title="12">    <span class="cf">if</span> (<span class="kw">this</span>.<span class="va">props</span>.<span class="at">categoryId</span> <span class="op">!==</span> <span class="va">nextProps</span>.<span class="at">categoryId</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb152-13" title="13">      <span class="co">// props.categoryId に変化があるので、ページ移動が発生している</span></a>
<a class="sourceLine" id="cb152-14" title="14">      <span class="kw">this</span>.<span class="va">props</span>.<span class="at">onUpdate</span>(<span class="va">nextProps</span>.<span class="at">categoryId</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb152-15" title="15">    <span class="op">}</span></a>
<a class="sourceLine" id="cb152-16" title="16">  <span class="op">}</span></a>
<a class="sourceLine" id="cb152-17" title="17">  </a>
<a class="sourceLine" id="cb152-18" title="18">  <span class="co">// </span><span class="al">TODO</span><span class="co">: 最終的には categoryId をもとにAPIから情報を取得する</span></a>
<a class="sourceLine" id="cb152-19" title="19">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb152-20" title="20">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb152-21" title="21">      <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb152-22" title="22">        <span class="op">&lt;</span>h2<span class="op">&gt;</span>Ranking Component&lt;/h2<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb152-23" title="23">        <span class="op">&lt;</span>p<span class="op">&gt;</span>Category <span class="dt">Id</span><span class="op">:</span> <span class="op">{</span><span class="kw">this</span>.<span class="va">props</span>.<span class="at">categoryId</span><span class="op">}</span>&lt;/p<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb152-24" title="24">      &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb152-25" title="25">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb152-26" title="26">  <span class="op">}</span></a>
<a class="sourceLine" id="cb152-27" title="27"><span class="op">}</span></a>
<a class="sourceLine" id="cb152-28" title="28"></a>
<a class="sourceLine" id="cb152-29" title="29"><span class="co">// propsのデータ型を定義</span></a>
<a class="sourceLine" id="cb152-30" title="30"><span class="va">Ranking</span>.<span class="at">propTypes</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb152-31" title="31">  <span class="dt">categoryId</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">string</span><span class="op">,</span></a>
<a class="sourceLine" id="cb152-32" title="32">  <span class="dt">onMount</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">func</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb152-33" title="33">  <span class="dt">onUpdate</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">func</span>.<span class="at">isRequired</span></a>
<a class="sourceLine" id="cb152-34" title="34"><span class="op">};</span></a>
<a class="sourceLine" id="cb152-35" title="35"></a>
<a class="sourceLine" id="cb152-36" title="36"><span class="co">// 未指定時の既定値を定義</span></a>
<a class="sourceLine" id="cb152-37" title="37"><span class="va">Ranking</span>.<span class="at">defaultProps</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb152-38" title="38">  <span class="dt">categoryId</span><span class="op">:</span> <span class="st">&quot;1&quot;</span></a>
<a class="sourceLine" id="cb152-39" title="39"><span class="op">};</span></a></code></pre></div>
<p>[<code>src\actions\Ranking.js</code>]</p>
<p>ActionCreator を定義します。</p>
<ul>
<li>コンポーネントのprops.onMount、props.onUpdateが呼び出されたときに実行するfetchRanking ※redux-thunkを使った非同期処理</li>
<li>リクエスト開始 Action - startRequest</li>
<li>レスポンス受信 Action - receiveData</li>
<li>リクエスト完了 Action - finishRequest</li>
</ul>
<div class="sourceCode" id="cb153"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb153-1" title="1"><span class="im">import</span> fetchJsonp <span class="im">from</span> <span class="st">&#39;fetch-jsonp&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb153-2" title="2"><span class="im">import</span> qs <span class="im">from</span> <span class="st">&#39;qs&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb153-3" title="3"></a>
<a class="sourceLine" id="cb153-4" title="4"><span class="kw">const</span> API_URL <span class="op">=</span> <span class="st">&quot;http://hoge.co.jp/v1/json/hoge&quot;</span><span class="op">;</span> <span class="co">// </span><span class="al">TODO</span><span class="co">: api のURL</span></a>
<a class="sourceLine" id="cb153-5" title="5"><span class="kw">const</span> APP_ID <span class="op">=</span> <span class="st">&quot;APP_ID&quot;</span><span class="op">;</span>                          <span class="co">// </span><span class="al">TODO</span><span class="co">: 不要だが定義しておく</span></a>
<a class="sourceLine" id="cb153-6" title="6"></a>
<a class="sourceLine" id="cb153-7" title="7"><span class="co">// リクエスト開始 Action</span></a>
<a class="sourceLine" id="cb153-8" title="8"><span class="kw">const</span> startRequest <span class="op">=</span> categoryId <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb153-9" title="9">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;START_REQUEST&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb153-10" title="10">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span> categoryId <span class="op">},</span></a>
<a class="sourceLine" id="cb153-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb153-12" title="12"></a>
<a class="sourceLine" id="cb153-13" title="13"><span class="co">// レスポンス受信 Action</span></a>
<a class="sourceLine" id="cb153-14" title="14"><span class="kw">const</span> receiveData <span class="op">=</span> (categoryId<span class="op">,</span> error<span class="op">,</span> response) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb153-15" title="15">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;RECEIVE_DATA&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb153-16" title="16">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span> categoryId<span class="op">,</span> error<span class="op">,</span> response <span class="op">},</span></a>
<a class="sourceLine" id="cb153-17" title="17"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb153-18" title="18"></a>
<a class="sourceLine" id="cb153-19" title="19"><span class="co">// リクエスト完了 Action</span></a>
<a class="sourceLine" id="cb153-20" title="20"><span class="kw">const</span> finishRequest <span class="op">=</span> categoryId <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb153-21" title="21">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;FINISH_REQUEST&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb153-22" title="22">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span> categoryId <span class="op">},</span></a>
<a class="sourceLine" id="cb153-23" title="23"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb153-24" title="24"></a>
<a class="sourceLine" id="cb153-25" title="25"><span class="co">// データ取得</span></a>
<a class="sourceLine" id="cb153-26" title="26"><span class="im">export</span> <span class="kw">const</span> fetchRanking <span class="op">=</span> categoryId <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb153-27" title="27">  <span class="co">// redux-thunkを使った非同期処理</span></a>
<a class="sourceLine" id="cb153-28" title="28">  <span class="cf">return</span> async dispatch <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb153-29" title="29">    <span class="at">dispatch</span>(<span class="at">startRequest</span>(categoryId))<span class="op">;</span></a>
<a class="sourceLine" id="cb153-30" title="30">    </a>
<a class="sourceLine" id="cb153-31" title="31">    <span class="kw">const</span> queryString <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb153-32" title="32">      <span class="dt">appid</span><span class="op">:</span> APP_ID<span class="op">,</span></a>
<a class="sourceLine" id="cb153-33" title="33">      <span class="dt">category_id</span><span class="op">:</span> categoryId<span class="op">,</span></a>
<a class="sourceLine" id="cb153-34" title="34">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb153-35" title="35">    </a>
<a class="sourceLine" id="cb153-36" title="36">    <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb153-37" title="37">      <span class="kw">const</span> response <span class="op">=</span> await <span class="at">fetchJsonp</span>(<span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">?</span><span class="sc">${</span>queryString<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb153-38" title="38">      <span class="kw">const</span> data <span class="op">=</span> await <span class="va">response</span>.<span class="at">json</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb153-39" title="39">      <span class="at">dispatch</span>(<span class="at">receiveData</span>(categoryId<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> data))<span class="op">;</span></a>
<a class="sourceLine" id="cb153-40" title="40">      </a>
<a class="sourceLine" id="cb153-41" title="41">    <span class="op">}</span> <span class="cf">catch</span> (ex) <span class="op">{</span></a>
<a class="sourceLine" id="cb153-42" title="42">      <span class="at">dispatch</span>(<span class="at">receiveData</span>(categoryId<span class="op">,</span> ex))<span class="op">;</span></a>
<a class="sourceLine" id="cb153-43" title="43">    <span class="op">}</span></a>
<a class="sourceLine" id="cb153-44" title="44">    </a>
<a class="sourceLine" id="cb153-45" title="45">    <span class="at">dispatch</span>(<span class="at">finishRequest</span>(categoryId))<span class="op">;</span></a>
<a class="sourceLine" id="cb153-46" title="46">  <span class="op">};</span></a>
<a class="sourceLine" id="cb153-47" title="47"><span class="op">};</span></a></code></pre></div>
<p>[<code>src\containers\Ranking.js</code>]</p>
<ul>
<li>ActionCreator をコンポーネントのprops.onMountedから呼び出すため、Container Component を定義します。</li>
<li>mapDispatchToPropsで、props.onMountedとactions.fetchRankingを接続します。</li>
</ul>
<div class="sourceCode" id="cb154"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb154-1" title="1"><span class="im">import</span> <span class="op">{</span> connect <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb154-2" title="2"><span class="im">import</span> Ranking <span class="im">from</span> <span class="st">&#39;../components/Ranking&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb154-3" title="3"><span class="im">import</span> <span class="op">*</span> <span class="im">as</span> actions <span class="im">from</span> <span class="st">&#39;../actions/Ranking&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb154-4" title="4"></a>
<a class="sourceLine" id="cb154-5" title="5"><span class="co">// </span><span class="al">TODO</span><span class="co">: Reducerを定義するまでの仮の処理</span></a>
<a class="sourceLine" id="cb154-6" title="6"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb154-7" title="7">  <span class="dt">categoryId</span><span class="op">:</span> <span class="va">ownProps</span>.<span class="at">categoryId</span></a>
<a class="sourceLine" id="cb154-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb154-9" title="9"></a>
<a class="sourceLine" id="cb154-10" title="10"><span class="kw">const</span> mapDispatchToProps <span class="op">=</span> dispatch <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb154-11" title="11">  <span class="at">onMount</span>(categoryId) <span class="op">{</span></a>
<a class="sourceLine" id="cb154-12" title="12">    <span class="at">dispatch</span>(<span class="va">actions</span>.<span class="at">fetchRanking</span>(categoryId))<span class="op">;</span></a>
<a class="sourceLine" id="cb154-13" title="13">  <span class="op">},</span></a>
<a class="sourceLine" id="cb154-14" title="14">  <span class="at">onUpdate</span>(categoryId) <span class="op">{</span></a>
<a class="sourceLine" id="cb154-15" title="15">    <span class="at">dispatch</span>(<span class="va">actions</span>.<span class="at">fetchRanking</span>(categoryId))<span class="op">;</span></a>
<a class="sourceLine" id="cb154-16" title="16">  <span class="op">}</span></a>
<a class="sourceLine" id="cb154-17" title="17"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb154-18" title="18"></a>
<a class="sourceLine" id="cb154-19" title="19"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(mapStateToProps<span class="op">,</span> mapDispatchToProps)(Ranking)<span class="op">;</span></a></code></pre></div>
<p>[<code>src\App.js</code>]</p>
<p>定義したContainer Componentを使うように修正します。</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb155-1" title="1"><span class="im">import</span> Ranking <span class="im">from</span> <span class="st">&#39;./components/Ranking&#39;</span><span class="op">;</span></a></code></pre></div>
<p>↓</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb156-1" title="1"><span class="im">import</span> Ranking <span class="im">from</span> <span class="st">&#39;./containers/Ranking&#39;</span><span class="op">;</span></a></code></pre></div></li>
<li><p>Reducerの実装</p>
<p>Reducerを実装し、取得したデータを表示します。</p>
<ul>
<li><p><code>src\reducers\shopping.js</code></p>
<p>カテゴリ名、カテゴリIDを保持する。 ランキングページにもカテゴリ名を表示したいので、<code>src\App.js</code>のハードコードをこちらに移動する。</p></li>
<li><p><code>src\reducers\Ranking.js</code></p>
<p>Ranking コンポーネント用のReducer。 ランキング情報を保持します。</p></li>
</ul>
<p>[<code>src\reducers\shopping.js</code>]</p>
<p>固定のJSONを常に返すReducerとして実装します。</p>
<p>※本来はAPIから取得した情報を返すようにするべきです。</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb157-1" title="1"><span class="kw">const</span> initialState <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb157-2" title="2">  <span class="co">// カテゴリ情報</span></a>
<a class="sourceLine" id="cb157-3" title="3">  <span class="co">// 本来はAPIから取得した情報を返すべき</span></a>
<a class="sourceLine" id="cb157-4" title="4">  <span class="dt">categories</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb157-5" title="5">    <span class="op">{</span></a>
<a class="sourceLine" id="cb157-6" title="6">      <span class="dt">id</span><span class="op">:</span> <span class="st">&quot;1&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb157-7" title="7">      <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;ALL&quot;</span></a>
<a class="sourceLine" id="cb157-8" title="8">    <span class="op">},</span></a>
<a class="sourceLine" id="cb157-9" title="9">    <span class="op">{</span></a>
<a class="sourceLine" id="cb157-10" title="10">      <span class="dt">id</span><span class="op">:</span> <span class="st">&quot;2502&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb157-11" title="11">      <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Category 2502&quot;</span></a>
<a class="sourceLine" id="cb157-12" title="12">    <span class="op">},</span></a>
<a class="sourceLine" id="cb157-13" title="13">    <span class="op">{</span></a>
<a class="sourceLine" id="cb157-14" title="14">      <span class="dt">id</span><span class="op">:</span> <span class="st">&quot;10002&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb157-15" title="15">      <span class="dt">name</span><span class="op">:</span> <span class="st">&quot;Category 10002&quot;</span></a>
<a class="sourceLine" id="cb157-16" title="16">    <span class="op">},</span></a>
<a class="sourceLine" id="cb157-17" title="17">  ]</a>
<a class="sourceLine" id="cb157-18" title="18"><span class="op">}</span></a>
<a class="sourceLine" id="cb157-19" title="19"></a>
<a class="sourceLine" id="cb157-20" title="20"><span class="im">export</span> <span class="im">default</span> () <span class="op">=&gt;</span> initialState<span class="op">;</span></a></code></pre></div>
<p>[<code>src\reducers\Ranking.js</code>]</p>
<ul>
<li>START_REQUEST Action にフックして、リクエスト開始時に状態をリセットします。</li>
<li>RECEIVE_DATA Action にフックして、レスポンスからランキング情報を取得し、状態に設定します。 リクエストが失敗したときはエラーフラグを立てます。</li>
<li>getRanking関数は、レスポンスから商品名、商品URL、商品画像のURLを抜き出します。</li>
</ul>
<div class="sourceCode" id="cb158"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb158-1" title="1"><span class="co">// レスポンスからランキング情報だけを抜き出す</span></a>
<a class="sourceLine" id="cb158-2" title="2"><span class="kw">const</span> getRanking <span class="op">=</span> response <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-3" title="3">  <span class="kw">const</span> ranking <span class="op">=</span> []<span class="op">;</span></a>
<a class="sourceLine" id="cb158-4" title="4">  <span class="kw">const</span> itemLength <span class="op">=</span> <span class="va">response</span>.<span class="va">ResultSet</span>.<span class="at">totalResultsReturned</span><span class="op">;</span></a>
<a class="sourceLine" id="cb158-5" title="5">  <span class="co">// </span><span class="al">TODO</span><span class="co">: p.206 ↑末尾にセミコロン必要では？</span></a>
<a class="sourceLine" id="cb158-6" title="6">  <span class="co">// </span><span class="al">TODO</span><span class="co">: ダウンロードできるサンプルに第10章が含まれていない</span></a>
<a class="sourceLine" id="cb158-7" title="7">  </a>
<a class="sourceLine" id="cb158-8" title="8">  <span class="cf">for</span> (<span class="kw">let</span> index <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> index <span class="op">&lt;</span> itemLength<span class="op">;</span> index<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb158-9" title="9">    <span class="kw">const</span> item <span class="op">=</span> <span class="va">response</span>.<span class="at">ResultSet</span>[<span class="st">&#39;0&#39;</span>].<span class="at">Result</span>[index <span class="op">+</span> <span class="st">&quot;&quot;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb158-10" title="10">    <span class="va">ranking</span>.<span class="at">push</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb158-11" title="11">      <span class="dt">code</span><span class="op">:</span> <span class="va">item</span>.<span class="at">Code</span><span class="op">,</span></a>
<a class="sourceLine" id="cb158-12" title="12">      <span class="dt">name</span><span class="op">:</span> <span class="va">item</span>.<span class="at">Name</span><span class="op">,</span></a>
<a class="sourceLine" id="cb158-13" title="13">      <span class="dt">url</span><span class="op">:</span> <span class="va">item</span>.<span class="at">Url</span><span class="op">,</span></a>
<a class="sourceLine" id="cb158-14" title="14">      <span class="dt">imageUrl</span><span class="op">:</span> <span class="va">item</span>.<span class="va">Image</span>.<span class="at">Medium</span></a>
<a class="sourceLine" id="cb158-15" title="15">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb158-16" title="16">  <span class="op">}</span></a>
<a class="sourceLine" id="cb158-17" title="17">  <span class="cf">return</span> ranking<span class="op">;</span></a>
<a class="sourceLine" id="cb158-18" title="18"><span class="op">};</span></a>
<a class="sourceLine" id="cb158-19" title="19"></a>
<a class="sourceLine" id="cb158-20" title="20"></a>
<a class="sourceLine" id="cb158-21" title="21"><span class="co">// 初期状態</span></a>
<a class="sourceLine" id="cb158-22" title="22"><span class="kw">const</span> initialState <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-23" title="23">  <span class="dt">categoryId</span><span class="op">:</span> <span class="kw">undefined</span><span class="op">,</span></a>
<a class="sourceLine" id="cb158-24" title="24">  <span class="dt">ranking</span><span class="op">:</span> <span class="kw">undefined</span><span class="op">,</span></a>
<a class="sourceLine" id="cb158-25" title="25">  <span class="dt">error</span><span class="op">:</span> <span class="kw">false</span></a>
<a class="sourceLine" id="cb158-26" title="26"><span class="op">};</span></a>
<a class="sourceLine" id="cb158-27" title="27"></a>
<a class="sourceLine" id="cb158-28" title="28"></a>
<a class="sourceLine" id="cb158-29" title="29"><span class="im">export</span> <span class="im">default</span> (state <span class="op">=</span> initialState<span class="op">,</span> action) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-30" title="30">  <span class="cf">switch</span> (<span class="va">action</span>.<span class="at">type</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb158-31" title="31">    <span class="co">// リクエスト開始時に状態をリセット</span></a>
<a class="sourceLine" id="cb158-32" title="32">    <span class="cf">case</span> <span class="st">&quot;START_REQUEST&quot;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb158-33" title="33">      <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-34" title="34">        <span class="dt">categoryId</span><span class="op">:</span> <span class="va">action</span>.<span class="va">payload</span>.<span class="at">categoryId</span><span class="op">,</span></a>
<a class="sourceLine" id="cb158-35" title="35">        <span class="dt">ranking</span><span class="op">:</span> <span class="kw">undefined</span><span class="op">,</span></a>
<a class="sourceLine" id="cb158-36" title="36">        <span class="dt">error</span><span class="op">:</span> <span class="kw">false</span></a>
<a class="sourceLine" id="cb158-37" title="37">      <span class="op">};</span></a>
<a class="sourceLine" id="cb158-38" title="38">    </a>
<a class="sourceLine" id="cb158-39" title="39">    <span class="co">// データ受信</span></a>
<a class="sourceLine" id="cb158-40" title="40">    <span class="cf">case</span> <span class="st">&quot;RECEIVE_DATA&quot;</span><span class="op">:</span></a>
<a class="sourceLine" id="cb158-41" title="41">      <span class="cf">return</span> <span class="va">action</span>.<span class="va">payload</span>.<span class="at">error</span></a>
<a class="sourceLine" id="cb158-42" title="42">        <span class="op">?</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb158-43" title="43">            ...<span class="at">state</span><span class="op">,</span> </a>
<a class="sourceLine" id="cb158-44" title="44">            <span class="dt">error</span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb158-45" title="45">          <span class="op">}</span></a>
<a class="sourceLine" id="cb158-46" title="46">        : <span class="op">{</span></a>
<a class="sourceLine" id="cb158-47" title="47">            ...<span class="at">state</span><span class="op">,</span></a>
<a class="sourceLine" id="cb158-48" title="48">            <span class="dt">ranking</span><span class="op">:</span> <span class="at">getRanking</span>(<span class="va">action</span>.<span class="va">payload</span>.<span class="at">response</span>)</a>
<a class="sourceLine" id="cb158-49" title="49">          <span class="op">};</span></a>
<a class="sourceLine" id="cb158-50" title="50">    </a>
<a class="sourceLine" id="cb158-51" title="51">    <span class="dt">default</span><span class="op">:</span></a>
<a class="sourceLine" id="cb158-52" title="52">      <span class="cf">return</span> state<span class="op">;</span></a>
<a class="sourceLine" id="cb158-53" title="53">  <span class="op">}</span></a>
<a class="sourceLine" id="cb158-54" title="54"><span class="op">}</span></a></code></pre></div>
<p>2つのReducerの参照を [<code>src\reducers\index.js</code>] に追加します。</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb159-1" title="1"><span class="co">// 受け取ったstateをそのまま返すReducer</span></a>
<a class="sourceLine" id="cb159-2" title="2"><span class="im">export</span> <span class="kw">const</span> noop <span class="op">=</span> (state <span class="op">=</span> <span class="op">{}</span>) <span class="op">=&gt;</span> state<span class="op">;</span></a>
<a class="sourceLine" id="cb159-3" title="3"></a>
<a class="sourceLine" id="cb159-4" title="4"><span class="im">export</span> <span class="op">{</span> <span class="im">default</span> <span class="im">as</span> shopping <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./shopping&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb159-5" title="5"><span class="im">export</span> <span class="op">{</span> <span class="im">default</span> <span class="im">as</span> Ranking <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;./Ranking&#39;</span><span class="op">;</span></a></code></pre></div>
<p>[<code>src\App.js</code>] のリンクの部分を Nav コンポーネントに移動する。</p>
<p>[<code>src\components\Nav.js</code>]</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb160-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb160-2" title="2"><span class="im">import</span> PropTypes <span class="im">from</span> <span class="st">&#39;prop-types&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="im">import</span> <span class="op">{</span> Link <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb160-4" title="4"></a>
<a class="sourceLine" id="cb160-5" title="5"><span class="im">export</span> <span class="im">default</span> <span class="kw">function</span> <span class="at">Nav</span>(<span class="op">{</span> categories <span class="op">}</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb160-6" title="6">  <span class="co">// 移動先パスの生成</span></a>
<a class="sourceLine" id="cb160-7" title="7">  <span class="co">//   カテゴリID = &quot;1&quot; であれば &quot;/all&quot;</span></a>
<a class="sourceLine" id="cb160-8" title="8">  <span class="co">//   上記以外であれば &quot;/category/&lt;カテゴリID&gt;&quot;</span></a>
<a class="sourceLine" id="cb160-9" title="9">  <span class="kw">const</span> to <span class="op">=</span> category <span class="op">=&gt;</span> (</a>
<a class="sourceLine" id="cb160-10" title="10">    <span class="va">category</span>.<span class="at">id</span> <span class="op">===</span> <span class="st">&quot;1&quot;</span></a>
<a class="sourceLine" id="cb160-11" title="11">      <span class="op">?</span> <span class="st">&quot;/all&quot;</span></a>
<a class="sourceLine" id="cb160-12" title="12">      : <span class="vs">`/category/</span><span class="sc">${</span><span class="va">category</span>.<span class="at">id</span><span class="sc">}</span><span class="vs">`</span></a>
<a class="sourceLine" id="cb160-13" title="13">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb160-14" title="14">  </a>
<a class="sourceLine" id="cb160-15" title="15">  <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb160-16" title="16">    <span class="op">&lt;</span>ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb160-17" title="17">      <span class="op">{</span> <span class="co">/* props.categories からリンク一覧を生成 */</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb160-18" title="18">      <span class="op">{</span><span class="va">categories</span>.<span class="at">map</span>(category <span class="op">=&gt;</span> (</a>
<a class="sourceLine" id="cb160-19" title="19">        <span class="op">&lt;</span>li key<span class="op">={</span><span class="vs">`nav-item-</span><span class="sc">${</span><span class="va">category</span>.<span class="at">id</span><span class="sc">}</span><span class="vs">`</span><span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb160-20" title="20">          <span class="op">&lt;</span>Link to<span class="op">={</span><span class="at">to</span>(category)<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb160-21" title="21">            <span class="op">{</span><span class="va">category</span>.<span class="at">name</span><span class="op">}</span></a>
<a class="sourceLine" id="cb160-22" title="22">          &lt;/Link<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb160-23" title="23">        &lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb160-24" title="24">      ))<span class="op">}</span></a>
<a class="sourceLine" id="cb160-25" title="25">    &lt;/ul<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb160-26" title="26">  )<span class="op">;</span></a>
<a class="sourceLine" id="cb160-27" title="27"><span class="op">}</span></a>
<a class="sourceLine" id="cb160-28" title="28"></a>
<a class="sourceLine" id="cb160-29" title="29"><span class="va">Nav</span>.<span class="at">propTypes</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb160-30" title="30">  <span class="co">// state.shopping.categories の構造</span></a>
<a class="sourceLine" id="cb160-31" title="31">  <span class="dt">categories</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">arrayOf</span>(</a>
<a class="sourceLine" id="cb160-32" title="32">    <span class="va">PropTypes</span>.<span class="at">shape</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb160-33" title="33">      <span class="dt">id</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb160-34" title="34">      <span class="dt">name</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span></a>
<a class="sourceLine" id="cb160-35" title="35">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb160-36" title="36">  ).<span class="at">isRequired</span></a>
<a class="sourceLine" id="cb160-37" title="37"><span class="op">};</span></a></code></pre></div>
<p>Nav コンポーネントの Container Component を作成します。</p>
<p>[<code>src\containers\Nav.js</code>]</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb161-1" title="1"><span class="im">import</span> <span class="op">{</span> connect <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb161-2" title="2"><span class="im">import</span> Nav <span class="im">from</span> <span class="st">&#39;../components/Nav&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb161-3" title="3"></a>
<a class="sourceLine" id="cb161-4" title="4"><span class="kw">const</span> mapStateToProps <span class="op">=</span> state <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb161-5" title="5">  <span class="co">// state.shopping.categories を props.categories に関連付ける</span></a>
<a class="sourceLine" id="cb161-6" title="6">  <span class="dt">categories</span><span class="op">:</span> <span class="va">state</span>.<span class="va">shopping</span>.<span class="at">categories</span></a>
<a class="sourceLine" id="cb161-7" title="7"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb161-8" title="8"></a>
<a class="sourceLine" id="cb161-9" title="9"><span class="im">export</span> <span class="im">default</span> <span class="at">connect</span>(mapStateToProps)(Nav)<span class="op">;</span></a></code></pre></div>
<p>App コンポーネントに Nav コンポーネントを組み込みます。</p>
<p>[<code>src\App.js</code>]</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb162-1" title="1"><span class="im">import</span> React<span class="op">,</span> <span class="op">{</span> Component <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb162-2" title="2"><span class="im">import</span> <span class="op">{</span> Route<span class="op">,</span> Switch<span class="op">,</span> Redirect <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-dom&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb162-3" title="3"><span class="im">import</span> Ranking <span class="im">from</span> <span class="st">&#39;./containers/Ranking&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb162-4" title="4"><span class="im">import</span> Nav <span class="im">from</span> <span class="st">&#39;./containers/Nav&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb162-5" title="5"></a>
<a class="sourceLine" id="cb162-6" title="6"><span class="kw">class</span> App <span class="kw">extends</span> Component <span class="op">{</span></a>
<a class="sourceLine" id="cb162-7" title="7">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb162-8" title="8">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb162-9" title="9">      <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;App&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb162-10" title="10">        <span class="op">{</span> <span class="co">/* Nav コンポーネントに差し替える */</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb162-11" title="11">        <span class="op">{</span> <span class="co">/*</span></a>
<a class="sourceLine" id="cb162-12" title="12"><span class="co">        &lt;ul&gt;</span></a>
<a class="sourceLine" id="cb162-13" title="13"><span class="co">          &lt;li&gt;&lt;Link to=&quot;/all&quot;&gt;Category All&lt;/Link&gt;&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb162-14" title="14"><span class="co">          &lt;li&gt;&lt;Link to=&quot;/category/2502&quot;&gt;Category 2502&lt;/Link&gt;&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb162-15" title="15"><span class="co">          &lt;li&gt;&lt;Link to=&quot;/category/10002&quot;&gt;Category 10002&lt;/Link&gt;&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb162-16" title="16"><span class="co">        &lt;/ul&gt;</span></a>
<a class="sourceLine" id="cb162-17" title="17"><span class="co">        */</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb162-18" title="18">        <span class="op">&lt;</span>Nav /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb162-19" title="19">        </a>
<a class="sourceLine" id="cb162-20" title="20">        <span class="op">&lt;</span>Switch<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb162-21" title="21">          <span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/all&quot;</span> component<span class="op">={</span>Ranking<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb162-22" title="22">          <span class="op">&lt;</span>Route</a>
<a class="sourceLine" id="cb162-23" title="23">            path<span class="op">=</span><span class="st">&quot;/category/1&quot;</span></a>
<a class="sourceLine" id="cb162-24" title="24">            render<span class="op">={</span></a>
<a class="sourceLine" id="cb162-25" title="25">              () <span class="op">=&gt;</span> <span class="op">&lt;</span>Redirect to<span class="op">=</span><span class="st">&quot;/all&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb162-26" title="26">            <span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb162-27" title="27">          <span class="op">&lt;</span>Route</a>
<a class="sourceLine" id="cb162-28" title="28">            path<span class="op">=</span><span class="st">&quot;/category/:id&quot;</span></a>
<a class="sourceLine" id="cb162-29" title="29">            render<span class="op">={</span></a>
<a class="sourceLine" id="cb162-30" title="30">              (<span class="op">{</span> match <span class="op">}</span>) <span class="op">=&gt;</span> <span class="op">&lt;</span>Ranking categoryId<span class="op">={</span><span class="va">match</span>.<span class="va">params</span>.<span class="at">id</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb162-31" title="31">            <span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb162-32" title="32">        &lt;/Switch<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb162-33" title="33">      &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb162-34" title="34">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb162-35" title="35">  <span class="op">}</span></a>
<a class="sourceLine" id="cb162-36" title="36"><span class="op">}</span></a>
<a class="sourceLine" id="cb162-37" title="37"></a>
<a class="sourceLine" id="cb162-38" title="38"><span class="im">export</span> <span class="im">default</span> App<span class="op">;</span></a></code></pre></div></li>
<li><p>機能拡張</p>
<ul>
<li>state.shopping.categoriesにないカテゴリIDへのアクセスは、トップページにリダイレクトする。</li>
<li>カテゴリ名を表示</li>
<li>ランキング情報の表示</li>
</ul>
<p>[<code>src\actions\Ranking.js</code>]</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb163-1" title="1"><span class="im">import</span> fetchJsonp <span class="im">from</span> <span class="st">&#39;fetch-jsonp&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb163-2" title="2"><span class="im">import</span> qs <span class="im">from</span> <span class="st">&#39;qs&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb163-3" title="3"><span class="im">import</span> <span class="op">{</span> replace <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb163-4" title="4"></a>
<a class="sourceLine" id="cb163-5" title="5"><span class="kw">const</span> API_URL <span class="op">=</span> <span class="st">&quot;http://hoge.co.jp/v1/json/hoge&quot;</span><span class="op">;</span> <span class="co">// </span><span class="al">TODO</span><span class="co">: api のURL</span></a>
<a class="sourceLine" id="cb163-6" title="6"><span class="kw">const</span> APP_ID <span class="op">=</span> <span class="st">&quot;APP_ID&quot;</span><span class="op">;</span>                          <span class="co">// </span><span class="al">TODO</span><span class="co">: 不要だが定義しておく</span></a>
<a class="sourceLine" id="cb163-7" title="7"></a>
<a class="sourceLine" id="cb163-8" title="8"><span class="co">// リクエスト開始 Action</span></a>
<a class="sourceLine" id="cb163-9" title="9"><span class="co">// categoryId ではなく category を含めるように変更</span></a>
<a class="sourceLine" id="cb163-10" title="10"><span class="kw">const</span> startRequest <span class="op">=</span> category <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb163-11" title="11">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;START_REQUEST&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb163-12" title="12">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span> category <span class="op">},</span></a>
<a class="sourceLine" id="cb163-13" title="13"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb163-14" title="14"></a>
<a class="sourceLine" id="cb163-15" title="15"><span class="co">// レスポンス受信 Action</span></a>
<a class="sourceLine" id="cb163-16" title="16"><span class="co">// categoryId ではなく category を含めるように変更</span></a>
<a class="sourceLine" id="cb163-17" title="17"><span class="kw">const</span> receiveData <span class="op">=</span> (category<span class="op">,</span> error<span class="op">,</span> response) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb163-18" title="18">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;RECEIVE_DATA&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb163-19" title="19">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span> category<span class="op">,</span> error<span class="op">,</span> response <span class="op">},</span></a>
<a class="sourceLine" id="cb163-20" title="20"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb163-21" title="21"></a>
<a class="sourceLine" id="cb163-22" title="22"><span class="co">// リクエスト完了 Action</span></a>
<a class="sourceLine" id="cb163-23" title="23"><span class="co">// categoryId ではなく category を含めるように変更</span></a>
<a class="sourceLine" id="cb163-24" title="24"><span class="kw">const</span> finishRequest <span class="op">=</span> category <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb163-25" title="25">  <span class="dt">type</span><span class="op">:</span> <span class="st">&quot;FINISH_REQUEST&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb163-26" title="26">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span> category <span class="op">},</span></a>
<a class="sourceLine" id="cb163-27" title="27"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb163-28" title="28"></a>
<a class="sourceLine" id="cb163-29" title="29"><span class="co">// データ取得</span></a>
<a class="sourceLine" id="cb163-30" title="30"><span class="im">export</span> <span class="kw">const</span> fetchRanking <span class="op">=</span> categoryId <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb163-31" title="31">  <span class="co">// redux-thunkを使った非同期処理</span></a>
<a class="sourceLine" id="cb163-32" title="32">  <span class="co">// getState関数を引数に追加する</span></a>
<a class="sourceLine" id="cb163-33" title="33">  <span class="cf">return</span> <span class="at">async</span> (dispatch<span class="op">,</span> getState) <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb163-34" title="34">    <span class="co">// カテゴリIDに対応する state.shopping.categories の要素を取得</span></a>
<a class="sourceLine" id="cb163-35" title="35">    <span class="kw">const</span> categories <span class="op">=</span> <span class="at">getState</span>().<span class="va">shopping</span>.<span class="at">categories</span><span class="op">;</span></a>
<a class="sourceLine" id="cb163-36" title="36">    <span class="kw">const</span> category <span class="op">=</span> <span class="va">categories</span>.<span class="at">find</span>(category <span class="op">=&gt;</span> (<span class="va">category</span>.<span class="at">id</span> <span class="op">===</span> categoryId))<span class="op">;</span></a>
<a class="sourceLine" id="cb163-37" title="37">    </a>
<a class="sourceLine" id="cb163-38" title="38">    <span class="co">// 対応する情報がなければトップページへリダイレクト</span></a>
<a class="sourceLine" id="cb163-39" title="39">    <span class="cf">if</span> (<span class="kw">typeof</span> category <span class="op">===</span> <span class="st">&quot;undefined&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb163-40" title="40">      <span class="at">dispatch</span>(<span class="at">replace</span>(<span class="st">&quot;/&quot;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb163-41" title="41">      <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb163-42" title="42">    <span class="op">}</span></a>
<a class="sourceLine" id="cb163-43" title="43">    </a>
<a class="sourceLine" id="cb163-44" title="44">    <span class="co">// startRequest Action の引数に category を受け渡す</span></a>
<a class="sourceLine" id="cb163-45" title="45">    <span class="at">dispatch</span>(<span class="at">startRequest</span>(category))<span class="op">;</span></a>
<a class="sourceLine" id="cb163-46" title="46">    </a>
<a class="sourceLine" id="cb163-47" title="47">    <span class="kw">const</span> queryString <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb163-48" title="48">      <span class="dt">appid</span><span class="op">:</span> APP_ID<span class="op">,</span></a>
<a class="sourceLine" id="cb163-49" title="49">      <span class="dt">category_id</span><span class="op">:</span> categoryId<span class="op">,</span></a>
<a class="sourceLine" id="cb163-50" title="50">    <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb163-51" title="51">    </a>
<a class="sourceLine" id="cb163-52" title="52">    <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb163-53" title="53">      <span class="kw">const</span> response <span class="op">=</span> await <span class="at">fetchJsonp</span>(<span class="vs">`</span><span class="sc">${</span>API_URL<span class="sc">}</span><span class="vs">?</span><span class="sc">${</span>queryString<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb163-54" title="54">      <span class="kw">const</span> data <span class="op">=</span> await <span class="va">response</span>.<span class="at">json</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb163-55" title="55">      <span class="at">dispatch</span>(<span class="at">receiveData</span>(category<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> data))<span class="op">;</span>  <span class="co">// categoryId ではなく category を受け渡す</span></a>
<a class="sourceLine" id="cb163-56" title="56">      </a>
<a class="sourceLine" id="cb163-57" title="57">    <span class="op">}</span> <span class="cf">catch</span> (ex) <span class="op">{</span></a>
<a class="sourceLine" id="cb163-58" title="58">      <span class="at">dispatch</span>(<span class="at">receiveData</span>(category<span class="op">,</span> ex))<span class="op">;</span>  <span class="co">// categoryId ではなく category を受け渡す</span></a>
<a class="sourceLine" id="cb163-59" title="59">    <span class="op">}</span></a>
<a class="sourceLine" id="cb163-60" title="60">    </a>
<a class="sourceLine" id="cb163-61" title="61">    <span class="at">dispatch</span>(<span class="at">finishRequest</span>(category))<span class="op">;</span>      <span class="co">// categoryId ではなく category を受け渡す</span></a>
<a class="sourceLine" id="cb163-62" title="62">  <span class="op">};</span></a>
<a class="sourceLine" id="cb163-63" title="63"><span class="op">};</span></a></code></pre></div>
<p>修正したActionに対応できるように、Reducerを変更します。</p>
<p>[<code>src\reducers\Ranking.js</code>] （変更する initialState の部分のみ抜粋）</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb164-1" title="1"><span class="co">// 初期状態</span></a>
<a class="sourceLine" id="cb164-2" title="2"><span class="kw">const</span> initialState <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb164-3" title="3">  <span class="co">// categoryId → category</span></a>
<a class="sourceLine" id="cb164-4" title="4">  <span class="dt">category</span><span class="op">:</span> <span class="kw">undefined</span><span class="op">,</span></a>
<a class="sourceLine" id="cb164-5" title="5">  <span class="dt">ranking</span><span class="op">:</span> <span class="kw">undefined</span><span class="op">,</span></a>
<a class="sourceLine" id="cb164-6" title="6">  <span class="dt">error</span><span class="op">:</span> <span class="kw">false</span></a>
<a class="sourceLine" id="cb164-7" title="7"><span class="op">};</span></a></code></pre></div>
<p>Rankingコンポーネントと Store の状態を関連付けます。</p>
<p>[<code>src\containers\Ranking.js</code>] （mapStateToProps の部分のみ抜粋）</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb165-1" title="1"><span class="kw">const</span> mapStateToProps <span class="op">=</span> (state<span class="op">,</span> ownProps) <span class="op">=&gt;</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb165-2" title="2">  <span class="dt">categoryId</span><span class="op">:</span> <span class="va">ownProps</span>.<span class="at">categoryId</span><span class="op">,</span></a>
<a class="sourceLine" id="cb165-3" title="3">  </a>
<a class="sourceLine" id="cb165-4" title="4">  <span class="co">// カテゴリ情報、ランキング情報を Ranking コンポーネントに渡す</span></a>
<a class="sourceLine" id="cb165-5" title="5">  <span class="dt">category</span><span class="op">:</span> <span class="va">state</span>.<span class="va">Ranking</span>.<span class="at">category</span><span class="op">,</span></a>
<a class="sourceLine" id="cb165-6" title="6">  <span class="dt">ranking</span><span class="op">:</span> <span class="va">state</span>.<span class="va">Ranking</span>.<span class="at">ranking</span><span class="op">,</span></a>
<a class="sourceLine" id="cb165-7" title="7">  <span class="dt">error</span><span class="op">:</span> <span class="va">state</span>.<span class="va">Ranking</span>.<span class="at">error</span></a>
<a class="sourceLine" id="cb165-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Rankingコンポーネントは、受け取ったカテゴリ情報、ランキング情報、エラーフラグを表示します。</p>
<p>[<code>src\components\Ranking.js</code>]</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb166-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb166-2" title="2"><span class="im">import</span> PropTypes <span class="im">from</span> <span class="st">&#39;prop-types&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb166-3" title="3"></a>
<a class="sourceLine" id="cb166-4" title="4"><span class="im">export</span> <span class="im">default</span> <span class="kw">class</span> Ranking <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb166-5" title="5"></a>
<a class="sourceLine" id="cb166-6" title="6">  <span class="at">componentWillMount</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb166-7" title="7">    <span class="kw">this</span>.<span class="va">props</span>.<span class="at">onMount</span>(<span class="kw">this</span>.<span class="va">props</span>.<span class="at">categoryId</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb166-9" title="9">  </a>
<a class="sourceLine" id="cb166-10" title="10">  <span class="at">componentWillReceiveProps</span>(nextProps) <span class="op">{</span></a>
<a class="sourceLine" id="cb166-11" title="11">    <span class="cf">if</span> (<span class="kw">this</span>.<span class="va">props</span>.<span class="at">categoryId</span> <span class="op">!==</span> <span class="va">nextProps</span>.<span class="at">categoryId</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb166-12" title="12">      <span class="co">// props.categoryId に変化があるので、ページ移動が発生している</span></a>
<a class="sourceLine" id="cb166-13" title="13">      <span class="kw">this</span>.<span class="va">props</span>.<span class="at">onUpdate</span>(<span class="va">nextProps</span>.<span class="at">categoryId</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb166-14" title="14">    <span class="op">}</span></a>
<a class="sourceLine" id="cb166-15" title="15">  <span class="op">}</span></a>
<a class="sourceLine" id="cb166-16" title="16">  </a>
<a class="sourceLine" id="cb166-17" title="17">  <span class="at">render</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb166-18" title="18">    <span class="kw">const</span> <span class="op">{</span> category<span class="op">,</span> ranking<span class="op">,</span> error <span class="op">}</span> <span class="op">=</span> <span class="kw">this</span>.<span class="at">props</span><span class="op">;</span></a>
<a class="sourceLine" id="cb166-19" title="19">    </a>
<a class="sourceLine" id="cb166-20" title="20">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb166-21" title="21">      <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb166-22" title="22">        <span class="op">&lt;</span>h2<span class="op">&gt;{</span></a>
<a class="sourceLine" id="cb166-23" title="23">          <span class="kw">typeof</span> category <span class="op">!==</span> <span class="st">&quot;undefined&quot;</span></a>
<a class="sourceLine" id="cb166-24" title="24">            <span class="op">?</span> <span class="vs">`Ranking: </span><span class="sc">${</span><span class="va">category</span>.<span class="at">name</span><span class="sc">}</span><span class="vs">`</span></a>
<a class="sourceLine" id="cb166-25" title="25">            : <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb166-26" title="26">        <span class="op">}</span>&lt;/h2<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb166-27" title="27">        </a>
<a class="sourceLine" id="cb166-28" title="28">        <span class="op">{</span>(() <span class="op">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb166-29" title="29">          <span class="cf">if</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb166-30" title="30">            <span class="co">// エラー表示</span></a>
<a class="sourceLine" id="cb166-31" title="31">            <span class="cf">return</span> <span class="op">&lt;</span>p<span class="op">&gt;</span>エラーが発生しました。リロードしてください。&lt;/p<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb166-32" title="32">            </a>
<a class="sourceLine" id="cb166-33" title="33">          <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">typeof</span> ranking <span class="op">===</span> <span class="st">&quot;undefined&quot;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb166-34" title="34">            <span class="co">// リクエスト完了前</span></a>
<a class="sourceLine" id="cb166-35" title="35">            <span class="cf">return</span> <span class="op">&lt;</span>p<span class="op">&gt;</span><span class="va">読み込み中</span>...&lt;/p<span class="op">&gt;;</span></a>
<a class="sourceLine" id="cb166-36" title="36">            </a>
<a class="sourceLine" id="cb166-37" title="37">          <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb166-38" title="38">            <span class="co">// ランキングの表示</span></a>
<a class="sourceLine" id="cb166-39" title="39">            <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb166-40" title="40">              <span class="op">&lt;</span>ol<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb166-41" title="41">                <span class="op">{</span><span class="va">ranking</span>.<span class="at">map</span>(item <span class="op">=&gt;</span> (</a>
<a class="sourceLine" id="cb166-42" title="42">                  <span class="op">&lt;</span>li key<span class="op">={</span><span class="vs">`ranking-item-</span><span class="sc">${</span><span class="va">item</span>.<span class="at">code</span><span class="sc">}</span><span class="vs">`</span><span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb166-43" title="43">                    <span class="op">&lt;</span>img alt<span class="op">={</span><span class="va">item</span>.<span class="at">name</span><span class="op">}</span> src<span class="op">={</span><span class="va">item</span>.<span class="at">imageUrl</span><span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb166-44" title="44">                    <span class="op">&lt;</span>a href<span class="op">={</span><span class="va">item</span>.<span class="at">url</span><span class="op">}</span> target<span class="op">=</span><span class="st">&quot;_blank&quot;</span><span class="op">&gt;{</span><span class="va">item</span>.<span class="at">name</span><span class="op">}</span>&lt;/a<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb166-45" title="45">                  &lt;/li<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb166-46" title="46">                ))<span class="op">}</span></a>
<a class="sourceLine" id="cb166-47" title="47">              &lt;/ol<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb166-48" title="48">            )<span class="op">;</span></a>
<a class="sourceLine" id="cb166-49" title="49">          <span class="op">}</span></a>
<a class="sourceLine" id="cb166-50" title="50">        <span class="op">}</span>)()<span class="op">}</span></a>
<a class="sourceLine" id="cb166-51" title="51">      &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb166-52" title="52">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb166-53" title="53">  <span class="op">}</span></a>
<a class="sourceLine" id="cb166-54" title="54"><span class="op">}</span></a>
<a class="sourceLine" id="cb166-55" title="55"></a>
<a class="sourceLine" id="cb166-56" title="56"><span class="co">// propsのデータ型を定義</span></a>
<a class="sourceLine" id="cb166-57" title="57"><span class="va">Ranking</span>.<span class="at">propTypes</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb166-58" title="58">  <span class="dt">categoryId</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">string</span><span class="op">,</span></a>
<a class="sourceLine" id="cb166-59" title="59">  <span class="dt">onMount</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">func</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb166-60" title="60">  <span class="dt">onUpdate</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">func</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb166-61" title="61">  </a>
<a class="sourceLine" id="cb166-62" title="62">  <span class="co">// category, ranking, error の型を追加</span></a>
<a class="sourceLine" id="cb166-63" title="63">  <span class="dt">category</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">shape</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb166-64" title="64">    <span class="dt">id</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb166-65" title="65">    <span class="dt">name</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb166-66" title="66">  <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb166-67" title="67">  <span class="dt">ranking</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="at">arrayOf</span>(</a>
<a class="sourceLine" id="cb166-68" title="68">    <span class="va">PropTypes</span>.<span class="at">shape</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb166-69" title="69">      <span class="dt">code</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb166-70" title="70">      <span class="dt">name</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb166-71" title="71">      <span class="dt">url</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span><span class="op">,</span></a>
<a class="sourceLine" id="cb166-72" title="72">      <span class="dt">imageUrl</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">string</span>.<span class="at">isRequired</span></a>
<a class="sourceLine" id="cb166-73" title="73">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb166-74" title="74">  )<span class="op">,</span></a>
<a class="sourceLine" id="cb166-75" title="75">  <span class="dt">error</span><span class="op">:</span> <span class="va">PropTypes</span>.<span class="va">bool</span>.<span class="at">isRequired</span></a>
<a class="sourceLine" id="cb166-76" title="76"><span class="op">};</span></a>
<a class="sourceLine" id="cb166-77" title="77"></a>
<a class="sourceLine" id="cb166-78" title="78"><span class="co">// 未指定時の既定値を定義</span></a>
<a class="sourceLine" id="cb166-79" title="79"><span class="va">Ranking</span>.<span class="at">defaultProps</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb166-80" title="80">  <span class="dt">categoryId</span><span class="op">:</span> <span class="st">&quot;1&quot;</span></a>
<a class="sourceLine" id="cb166-81" title="81"><span class="op">};</span></a></code></pre></div></li>
</ol>
<h2 id="日付を扱う">日付を扱う</h2>
<p><code>react-moment</code>を使います。 <code>moment</code>を使ったReactコンポーネントです。</p>
<h3 id="インストール-3">インストール</h3>
<pre><code>npm install --save moment react-moment
</code></pre>
<p>タイムゾーンを指定するのであれば、こちらのパッケージもインストールします。</p>
<pre><code>npm install --save moment-timezone
</code></pre>
<h2 id="note-react-router">Note: React Router</h2>
<p>Router : すべてのRouterコンポーネントに共通する低レベルインターフェース。根底クラスみたいなもんだと思えばよいでしょう。</p>
<pre><code>一般的にアプリでは次のRouterのうち、ひとつを使います。

- BrowserRouter
- HashRouter
- MemoryRouter
- NativeRouter
- StaticRouter
</code></pre>
<p>BrowserRouter : HTML5 の history API を使って、URLとUIを同期するRouterコンポーネント。</p>
<p>HashRouter : URLのハッシュ（＝window.location.hash）を使って、URLとUIを同期するRouterコンポーネント。</p>
<p>Link : ナビゲーションコンポーネント。</p>
<p>NavLink : 見た目（スタイルの属性）ができるLinkコンポーネント。</p>
<p>Route : パスと一致するときに、コンポーネントを描画するコンポーネント。</p>
<pre><code>Renderコンポーネントを使って、コンポーネントを描画するには次の3つの方法があります。
が、ほとんどのケースで使うことになるのは、`&lt;Route component&gt;`でしょう。

- `&lt;Route component&gt;`

    パスが一致したときに、指定したコンポーネントを描画します。
    
    ~~~javascript
    // Helloコンポーネントを描画
    &lt;Route path=&quot;/hello&quot; component={Hello}/&gt;
    ~~~

- `&lt;Route render&gt;`

    パスが一致したときに、render関数に従い描画します。
    
    ~~~javascript
    &lt;Route path=&quot;/hello&quot; render={() =&gt; &lt;div&gt;Hello&lt;/div&gt;}/&gt;
    ~~~

- `&lt;Route children&gt;`

    パスが一致するかどうかを描画するときに使います。
    
    `children`の関数の引数 `match`には、パスが一致したときはオブジェクト、それ以外は null が渡されます。
    
    [`match`の詳細は公式ドキュメントを参照。](https://reacttraining.com/react-router/web/api/match){target=&quot;_blank&quot;}
    
    ~~~javascript
    &lt;ul&gt;
      &lt;ListItemLink to=&quot;/somewhere&quot;/&gt;
      &lt;ListItemLink to=&quot;/somewhere-else&quot;/&gt;
    &lt;/ul&gt;

    const ListItemLink = ({ to, ...rest }) =&gt; (
      &lt;Route path={to} children={({ match }) =&gt; (
        &lt;li className={match ? &#39;active&#39; : &#39;&#39;}&gt;
          &lt;Link to={to} {...rest}/&gt;
        &lt;/li&gt;
      )}/&gt;
    )
    ~~~


すべての方法で、次の3つのpropsが渡されます。

- match
- location
- history
</code></pre>
<h2 id="react-router-redux">React Router Redux</h2>
<h3 id="基本的な考え方">基本的な考え方</h3>
<ol>
<li><p>history を作ります。<br />
HTML5 の history API を使うか、URLハッシュを使うか選べます。</p></li>
<li><p>ミドルウェアを構築します。<br />
ナビゲーションアクションのインターセプトとディスパッチのためのミドルウェアを構築。 噛み砕いて言うと？</p></li>
<li><p><code>createStore</code>関数にReducerとMiddlewareを適用します。<br />
Reducerの指定は「router」キーに「routerReducer」を指定します。</p></li>
</ol>
<div class="sourceCode" id="cb171"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb171-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&#39;react&#39;</span></a>
<a class="sourceLine" id="cb171-2" title="2"><span class="im">import</span> ReactDOM <span class="im">from</span> <span class="st">&#39;react-dom&#39;</span></a>
<a class="sourceLine" id="cb171-3" title="3"></a>
<a class="sourceLine" id="cb171-4" title="4"><span class="im">import</span> <span class="op">{</span> createStore<span class="op">,</span> combineReducers<span class="op">,</span> applyMiddleware <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;redux&#39;</span></a>
<a class="sourceLine" id="cb171-5" title="5"><span class="im">import</span> <span class="op">{</span> Provider <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-redux&#39;</span></a>
<a class="sourceLine" id="cb171-6" title="6"></a>
<a class="sourceLine" id="cb171-7" title="7"><span class="im">import</span> createHistory <span class="im">from</span> <span class="st">&#39;history/createBrowserHistory&#39;</span></a>
<a class="sourceLine" id="cb171-8" title="8"><span class="im">import</span> <span class="op">{</span> Route <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router&#39;</span></a>
<a class="sourceLine" id="cb171-9" title="9"></a>
<a class="sourceLine" id="cb171-10" title="10"><span class="im">import</span> <span class="op">{</span> ConnectedRouter<span class="op">,</span> routerReducer<span class="op">,</span> routerMiddleware<span class="op">,</span> push <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-router-redux&#39;</span></a>
<a class="sourceLine" id="cb171-11" title="11"></a>
<a class="sourceLine" id="cb171-12" title="12"><span class="im">import</span> reducers <span class="im">from</span> <span class="st">&#39;./reducers&#39;</span> <span class="co">// Or wherever you keep your reducers</span></a>
<a class="sourceLine" id="cb171-13" title="13"></a>
<a class="sourceLine" id="cb171-14" title="14"><span class="co">// (1) history の生成</span></a>
<a class="sourceLine" id="cb171-15" title="15"><span class="kw">const</span> history <span class="op">=</span> <span class="at">createHistory</span>()</a>
<a class="sourceLine" id="cb171-16" title="16"></a>
<a class="sourceLine" id="cb171-17" title="17"><span class="co">// (2) ミドルウェアを構築</span></a>
<a class="sourceLine" id="cb171-18" title="18"><span class="kw">const</span> middleware <span class="op">=</span> <span class="at">routerMiddleware</span>(history)</a>
<a class="sourceLine" id="cb171-19" title="19"></a>
<a class="sourceLine" id="cb171-20" title="20"><span class="co">// (3) storeの生成</span></a>
<a class="sourceLine" id="cb171-21" title="21"><span class="co">//      ・Reducerを指定します。router キーに routerReducer を指定します。</span></a>
<a class="sourceLine" id="cb171-22" title="22"><span class="co">//      ・構築したミドルウェアを適用します。</span></a>
<a class="sourceLine" id="cb171-23" title="23"><span class="kw">const</span> store <span class="op">=</span> <span class="at">createStore</span>(</a>
<a class="sourceLine" id="cb171-24" title="24">  <span class="at">combineReducers</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb171-25" title="25">    ...<span class="at">reducers</span><span class="op">,</span></a>
<a class="sourceLine" id="cb171-26" title="26">    <span class="dt">router</span><span class="op">:</span> routerReducer</a>
<a class="sourceLine" id="cb171-27" title="27">  <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb171-28" title="28">  <span class="at">applyMiddleware</span>(middleware)</a>
<a class="sourceLine" id="cb171-29" title="29">)</a>
<a class="sourceLine" id="cb171-30" title="30"></a>
<a class="sourceLine" id="cb171-31" title="31"><span class="co">// これでどこからでもナビゲーションのアクションを送信できます。</span></a>
<a class="sourceLine" id="cb171-32" title="32"><span class="co">// store.dispatch(push(&#39;/foo&#39;))</span></a>
<a class="sourceLine" id="cb171-33" title="33"></a>
<a class="sourceLine" id="cb171-34" title="34"><span class="va">ReactDOM</span>.<span class="at">render</span>(</a>
<a class="sourceLine" id="cb171-35" title="35">  <span class="op">&lt;</span>Provider store<span class="op">={</span>store<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb171-36" title="36">    <span class="op">{</span> <span class="co">/* ConnectedRouter は Provider コンポーネントに store を自動で使います */</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb171-37" title="37">    <span class="op">&lt;</span>ConnectedRouter history<span class="op">={</span>history<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb171-38" title="38">      <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb171-39" title="39">        <span class="op">&lt;</span>Route exact path<span class="op">=</span><span class="st">&quot;/&quot;</span> component<span class="op">={</span>Home<span class="op">}</span>/&gt;</a>
<a class="sourceLine" id="cb171-40" title="40">        <span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/about&quot;</span> component<span class="op">={</span>About<span class="op">}</span>/&gt;</a>
<a class="sourceLine" id="cb171-41" title="41">        <span class="op">&lt;</span>Route path<span class="op">=</span><span class="st">&quot;/topics&quot;</span> component<span class="op">={</span>Topics<span class="op">}</span>/&gt;</a>
<a class="sourceLine" id="cb171-42" title="42">      &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb171-43" title="43">    &lt;/ConnectedRouter<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb171-44" title="44">  &lt;/Provider<span class="op">&gt;,</span></a>
<a class="sourceLine" id="cb171-45" title="45">  <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb171-46" title="46">)</a></code></pre></div>
<h2 id="head要素内の各要素を書き換える">head要素内の各要素を書き換える</h2>
<p>React Helmet パッケージを使います。</p>
<h3 id="実施環境-1">実施環境</h3>
<ul>
<li>react-helmet 5.2.0</li>
</ul>
<h3 id="インストール-4">インストール</h3>
<pre><code>&gt; npm install --save react-helmet
</code></pre>
<h3 id="使い方-1">使い方</h3>
<ul>
<li><code>react-helmet</code>パッケージをインポートします。</li>
<li><code>Helmet</code>コンポーネントの子要素に書き換える要素を指定します。</li>
</ul>
<div class="sourceCode" id="cb173"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb173-1" title="1"><span class="im">import</span> React <span class="im">from</span> <span class="st">&quot;react&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb173-2" title="2"><span class="im">import</span> <span class="op">{</span>Helmet<span class="op">}</span> <span class="im">from</span> <span class="st">&quot;react-helmet&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb173-3" title="3"></a>
<a class="sourceLine" id="cb173-4" title="4"><span class="kw">class</span> Application <span class="kw">extends</span> <span class="va">React</span>.<span class="at">Component</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb173-5" title="5">  <span class="at">render</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb173-6" title="6">    <span class="cf">return</span> (</a>
<a class="sourceLine" id="cb173-7" title="7">        <span class="op">&lt;</span>div className<span class="op">=</span><span class="st">&quot;application&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb173-8" title="8">            <span class="op">&lt;</span>Helmet<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb173-9" title="9">                <span class="op">&lt;</span>meta charSet<span class="op">=</span><span class="st">&quot;utf-8&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb173-10" title="10">                <span class="op">&lt;</span>title<span class="op">&gt;</span>My Title&lt;/title<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb173-11" title="11">                <span class="op">&lt;</span>link rel<span class="op">=</span><span class="st">&quot;canonical&quot;</span> href<span class="op">=</span><span class="st">&quot;http://mysite.com/example&quot;</span> /&gt;</a>
<a class="sourceLine" id="cb173-12" title="12">            &lt;/Helmet<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb173-13" title="13">            ...</a>
<a class="sourceLine" id="cb173-14" title="14">        &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb173-15" title="15">    )<span class="op">;</span></a>
<a class="sourceLine" id="cb173-16" title="16">  <span class="op">}</span></a>
<a class="sourceLine" id="cb173-17" title="17"><span class="op">};</span></a></code></pre></div>
</div></article></div><footer class="jsx-3331426913 global-footer"><div class="jsx-3331426913 px2 center text-sm line-height-16 copyright">© 2019 <!-- -->NOTE:: 技術メモ</div></footer></div></div></div><script>__NEXT_DATA__ = {"props":{"pageProps":{"pageContent":{"datePublished":"2019-01-15T16:39+09:00","title":"JavaScript で\r\nabc\\","body":"\u003cp\u003eabc\r\nを\"\u003ccode\u003edangerouslySetInnerHTML\u003c/code\u003e\"に指定したとき、どのように表示されるか。確かめてください。\u003c/p\u003e\u003ch2 id=\"実施環境\"\u003e実施環境\u003c/h2\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eWindows 7 Professional Service Pack 1\u003c/li\u003e\r\n\u003cli\u003enode v8.9.4\u003c/li\u003e\r\n\u003cli\u003enpm 4.0.5\u003c/li\u003e\r\n\u003cli\u003ecreate-react-app 1.5.2\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch2 id=\"はじめに\"\u003eはじめに\u003c/h2\u003e\r\n\u003cp\u003eReact : Webの見た目を作ることに特化したJavaScriptライブラリ。 Viewに関連する機能だけを持つ。\u003c/p\u003e\r\n\u003cp\u003eFlux : 次のように、データの流れを一方向に限定する設計パターン。 不整合が発生しにくい仕組みになっている。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e                  ┌─── Action ←─┐\r\n                  ↓                  ｜\r\n    Action → Dispatcher → Store → View\r\n\r\n\u0026lt;!-- --\u0026gt;\r\n\r\n1. View はユーザーの入力から Action を作成する。\r\n2. Action を Dispatch することで Store にデータを保存する。\r\n3. Store を View に反映する。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eRedux : Fluxアーキテクチャの実装。\u003c/p\u003e\r\n\u003c!--\r\n- View\r\n- Action\r\n- Store\r\n- Dispatcher\r\n- Reducer\r\n    状態を変化させるための関数です。Actionの内容によって既存の状態を変化させます。\r\n--\u003e\r\n\r\n\u003cp\u003eオブジェクトや配列の操作を行う場合は、基本的には参照渡しでなく値のコピーを渡します。 参照を切る方法としてES2015で標準化された\u003ccode\u003eObject.assign()\u003c/code\u003eメソッドを使ってもよいです。\u003c/p\u003e\r\n\u003cp\u003eSpread Operatorでも可。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb2\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb2-1\" title=\"1\"\u003e\u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb2-2\" title=\"2\"\u003e  ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb2-3\" title=\"3\"\u003e  \u003cspan class=\"dt\"\u003estatus\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"dv\"\u003e1\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb2-4\" title=\"4\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb3\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb3-1\" title=\"1\"\u003e\u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"va\"\u003eObject\u003c/span\u003e.\u003cspan class=\"at\"\u003eassign\u003c/span\u003e(\u003cspan class=\"op\"\u003e{},\u003c/span\u003e state\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb3-2\" title=\"2\"\u003e  \u003cspan class=\"dt\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"dv\"\u003e1\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb3-3\" title=\"3\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch2 id=\"create-react-app\"\u003eCreate React App\u003c/h2\u003e\r\n\u003cp\u003e\u003ca href=\"https://github.com/facebook/create-react-app\"\u003eGitHub - facebook/create-react-app\u003c/a\u003e\u003c/p\u003e\r\n\u003ch2 id=\"環境構築\"\u003e環境構築\u003c/h2\u003e\r\n\u003ch3 id=\"nodejsのインストール\"\u003enode.jsのインストール\u003c/h3\u003e\r\n\u003cp\u003e割愛します。\u003c/p\u003e\r\n\u003cp\u003eWindowsユーザーであれば nodist を入れればよいかと。\u003c/p\u003e\r\n\u003ch3 id=\"create-react-app-のインストール\"\u003ecreate-react-app のインストール\u003c/h3\u003e\r\n\u003cp\u003e作業フォルダを作りその中にインストールします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; mkdir react1st \u0026amp; cd react1st\r\n\u0026gt; npm install create-react-app\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"アプリケーションの作成\"\u003eアプリケーションの作成\u003c/h3\u003e\r\n\u003cp\u003e\u003ccode\u003ecreate-react-app\u003c/code\u003eコマンドを使ってアプリケーションを作成します。\u003c/p\u003e\r\n\u003cp\u003e構文 : \u003ccode\u003ecreate-react-app \u0026lt;application-name\u0026gt;\u003c/code\u003e\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003emy-app\u003c/code\u003eアプリケーションを作成してみます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; .\\node_modules\\.bin\\create-react-app my-app\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e作成されたアプリケーションの構成は以下のようになっています。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e.\r\n+---node_modules\r\n+---public\r\n|   +---favicon.ico\r\n|   +---index.html\r\n|   `---manifest.json\r\n+---src\r\n|   +---App.css\r\n|   +---App.js\r\n|   +---App.test.js\r\n|   +---index.css\r\n|   +---index.js\r\n|   +---logo.svg\r\n|   `---registerServiceWorker.js\r\n+---.gitignore\r\n+---package.json\r\n`---README.md\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"開発モードでアプリケーションを起動\"\u003e開発モードでアプリケーションを起動\u003c/h3\u003e\r\n\u003cp\u003eアプリケーションのルートフォルダ（\u003ccode\u003emy-app\u003c/code\u003eフォルダ）に移動し、\u003ccode\u003enpm start\u003c/code\u003eコマンドを実行します。 ブラウザが自動で起動し、アプリケーションが表示されます。 もし、ブラウザが起動しなかったときは自分で起動して\u003ccode\u003ehttp://localhost:3000/\u003c/code\u003eにアクセスしてください。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; cd my-app\r\n\u0026gt; npm start\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch4 id=\"開発モードの機能\"\u003e開発モードの機能\u003c/h4\u003e\r\n\u003cp\u003e開発モードは次の動作になります。 開発モードを終了するには、Control＋Cキーを押します。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eソースコードの変更を監視し、アプリケーションを自動でビルドする。\u003c/li\u003e\r\n\u003cli\u003eブラウザを自動でリロードする。\u003c/li\u003e\r\n\u003cli\u003eコンソールにビルドエラーとlintの警告を表示する。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch3 id=\"hello-world-の表示\"\u003eHello, World! の表示\u003c/h3\u003e\r\n\u003cp\u003e\u003ccode\u003esrc\\App.js\u003c/code\u003eファイルを以下のように編集します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb8\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb8-1\" title=\"1\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eh1 className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;App-title\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eWelcome to React\u0026lt;/h1\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e↓\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb9\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb9-1\" title=\"1\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eh1 className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;App-title\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eHello\u003cspan class=\"op\"\u003e,\u003c/span\u003e World\u003cspan class=\"op\"\u003e!\u003c/span\u003e\u0026lt;/h1\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e保存に伴い、ブラウザが自動でリロードされ、修正内容が反映されます。\u003c/p\u003e\r\n\u003ch2 id=\"jsx\"\u003eJSX\u003c/h2\u003e\r\n\u003cp\u003eJSX : JavaScriptを拡張した言語。 ReactとJSXを一緒に使うことが推奨されています（必須ではない）。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eJSXでは、JavaScriptのなかにHTMLのタグや属性を（ほぼ）同じように書くことができる。\u003c/li\u003e\r\n\u003cli\u003e最終的にトランスパイラでJavaScriptに変換して使う。 このとき、JSXに書いたタグは、\u003ccode\u003eReact.createElement\u003c/code\u003e関数の呼び出しに変換される。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003eトランスパイラ : ソースコードを別のソースコードに変換するツールのことです。 BabelのほかCoffeeScriptやTypeScriptなどがあります。\u003c/p\u003e\r\n\u003ch3 id=\"jsxの使い方\"\u003eJSXの使い方\u003c/h3\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003cp\u003eJSXのタグは\u003ccode\u003eReact.createElement\u003c/code\u003eに変換されるため、Reactのインポートが必要です。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e  import React from \u0026#39;react\u0026#39;;\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e\u003ccode\u003e{}\u003c/code\u003eで囲むと式をJSXに埋め込むことができます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e  const fullnames = {\r\n    ryoma: \u0026#39;坂本竜馬\u0026#39;\r\n  };\r\n  const getFullname = nickname =\u0026gt; fullnames[nickname];\r\n  const element = \u0026lt;h1\u0026gt;Hello, {getFullname(\u0026#39;ryoma\u0026#39;)}\u0026lt;/h1\u0026gt;;\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch2 id=\"babelのインストール\"\u003ebabelのインストール\u003c/h2\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003e作業ディレクトリを作り、その中に移動します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e \u0026gt; mkdir babel-cli-example \u0026amp; cd babel-cli-example\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e空のpackage.jsonを作ります。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e \u0026gt; echo {} \u0026gt; package.json\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eBabel関連のパッケージをインストールします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e \u0026gt; npm install --save-dev babel-cli babel-preset-react\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003cp\u003ebabel-cli BabelをCLI上で動作させるためのパッケージです。 Babelを使ったソースコードの変換を行うbabelコマンドと、変換に加えて変換後のソースコードをそのままNode.jsで実行するbabel-nodeコマンドを含んでいます。\u003c/p\u003e\r\n\u003ch3 id=\"react向けに変換するコマンド\"\u003ereact向けに変換するコマンド\u003c/h3\u003e\r\n\u003cpre\u003e\u003ccode\u003e.\\node_modules\\.bin\\babel [Options...] target-file\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ee.g.,\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e.\\node_modules\\.bin\\babel --presets=react input.js\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e標準出力ではなくファイルに出力するときは、\u003ccode\u003e--out-file\u003c/code\u003eオプションにファイル名を指定します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e.\\node_modules\\.bin\\babel --presets=react input.js --out-file output.js\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ewebpack : モジュールバンドラー。\u003cbr /\u003e\r\nES ModulesやNode.jsで利用されているCommonJSのモジュール方式で記述されたソースファイルを束ねて、ブラウザで実行可能な静的なJavaScriptファイルを出力します。\u003c/p\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003e作業ディレクトリを作り、その中に移動します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e \u0026gt; mkdir webpack-example \u0026amp; cd webpack-example\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e空のpackage.jsonを作ります。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e \u0026gt; echo {} \u0026gt; package.json\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e開発に使うパッケージをインストールします（\u003ccode\u003e--save-dev\u003c/code\u003eオプションをつけます）。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e \u0026gt; npm install --save-dev ^\r\n   webpack ^\r\n   webpack-cli ^\r\n   babel-loader ^\r\n   babel-core ^\r\n   babel-preset-react\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e実行に使うパッケージをインストールします（\u003ccode\u003e--save\u003c/code\u003eオプションをつけます）。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e \u0026gt; npm install --save ^\r\n   react ^\r\n   react-dom\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003c!--\r\n--save-devインストール\r\n\r\n- webpack\r\n- webpack-cli\r\n- babel-loader\r\n- babel-core\r\n- babel-preset-react\r\n\r\n--saveインストール\r\n\r\n- react\r\n- react-dom\r\n--\u003e\r\n\r\n\u003cp\u003eWebpackのバージョンを表示\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e.\\node_modules\\.bin\\webpack --version\r\n4.1.0\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eHello.js :\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e~~~javascript\r\nimport React from \u0026#39;react\u0026#39;;\r\n\r\n// export default function で\r\n// Hello コンポーネントを持っていることを外部に知らせる\r\nexport default function Hello() {\r\n  return \u0026lt;h1\u0026gt;Hello! webpack\u0026lt;/h1\u0026gt;;\r\n}\r\n~~~\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eentry.js :\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e~~~javascript\r\nimport React from \u0026#39;react\u0026#39;;\r\nimport ReactDOM from \u0026#39;react-dom\u0026#39;;\r\nimport Hello from \u0026#39;./Hello\u0026#39;;    // ← Hello.js の読み込み\r\n\r\nReactDOM.render(\r\n  \u0026lt;Hello /\u0026gt;,\r\n  document.getElementById(\u0026#39;root\u0026#39;)\r\n);\r\n~~~\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eimportのパスが絶対パスでも相対パスでもない場合、webpackはnpmモジュールから読み込みます。\u003c/p\u003e\r\n\u003cp\u003ewebpack.config.js\u003c/p\u003e\r\n\u003cp\u003ewebpackの設定ファイルは、JSON、XML、YAMLなどのフォーマットを記述できます。\u003cbr /\u003e\r\nフォーマットの判別は設定ファイルの拡張子で行います。\u003c/p\u003e\r\n\u003cp\u003eJavaScriptであれば、Node.jsのモジュールとして扱うので、\u003ccode\u003emodule.exports\u003c/code\u003eに代入しているオブジェクトが設定ファイルとして利用されます。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb25\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb25-1\" title=\"1\"\u003e\u003cspan class=\"va\"\u003emodule\u003c/span\u003e.\u003cspan class=\"at\"\u003eexports\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-2\" title=\"2\"\u003e  \u003cspan class=\"co\"\u003e// entryフィールド\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-3\" title=\"3\"\u003e  \u003cspan class=\"co\"\u003e// 実行の起点となるファイルの指定\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-4\" title=\"4\"\u003e  \u003cspan class=\"dt\"\u003eentry\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./entry.js\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-5\" title=\"5\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-6\" title=\"6\"\u003e  \u003cspan class=\"co\"\u003e// outputフィールド\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-7\" title=\"7\"\u003e  \u003cspan class=\"co\"\u003e// 出力に関する設定\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-8\" title=\"8\"\u003e  \u003cspan class=\"dt\"\u003eoutput\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-9\" title=\"9\"\u003e    \u003cspan class=\"dt\"\u003efilename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;output.js\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-10\" title=\"10\"\u003e  \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-11\" title=\"11\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-12\" title=\"12\"\u003e  \u003cspan class=\"dt\"\u003emodule\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-13\" title=\"13\"\u003e    \u003cspan class=\"dt\"\u003erules\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e [\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-14\" title=\"14\"\u003e      \u003cspan class=\"co\"\u003e// babel-loader の設定\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-15\" title=\"15\"\u003e      \u003cspan class=\"co\"\u003e// ファイルごとに適応するLoaderの設定を書く\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-16\" title=\"16\"\u003e      \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-17\" title=\"17\"\u003e        \u003cspan class=\"dt\"\u003eloader\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;babel-loader\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-18\" title=\"18\"\u003e        \u003cspan class=\"dt\"\u003etest\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"ss\"\u003e/\u003c/span\u003e\u003cspan class=\"sc\"\u003e\\.\u003c/span\u003e\u003cspan class=\"ss\"\u003ejs\u003c/span\u003e\u003cspan class=\"sc\"\u003e$\u003c/span\u003e\u003cspan class=\"ss\"\u003e/\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-19\" title=\"19\"\u003e        \u003cspan class=\"dt\"\u003eoptions\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-20\" title=\"20\"\u003e          \u003cspan class=\"dt\"\u003epresets\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e [\u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e]\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-21\" title=\"21\"\u003e        \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-22\" title=\"22\"\u003e      \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-23\" title=\"23\"\u003e    ]\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-24\" title=\"24\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb25-25\" title=\"25\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003ewebpackを実行\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003edist\\output.js\u003c/code\u003eが出力されます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; .\\node_modules\\.bin\\webpack --config webpack.config.js\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e\u003ccode\u003edist\\index.html\u003c/code\u003eを作成します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb27\"\u003e\u003cpre class=\"sourceCode html\"\u003e\u003ccode class=\"sourceCode html\"\u003e\u003ca class=\"sourceLine\" id=\"cb27-1\" title=\"1\"\u003e\u003cspan class=\"dt\"\u003e\u0026lt;!DOCTYPE \u003c/span\u003ehtml\u003cspan class=\"dt\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-2\" title=\"2\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;html\u003c/span\u003e\u003cspan class=\"ot\"\u003e lang=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;ja\u0026quot;\u003c/span\u003e\u003cspan class=\"kw\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-3\" title=\"3\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;head\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-4\" title=\"4\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;meta\u003c/span\u003e\u003cspan class=\"ot\"\u003e http-equiv=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;X-UA-Compatible\u0026quot;\u003c/span\u003e\u003cspan class=\"ot\"\u003e content=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;IE=edge\u0026quot;\u003c/span\u003e\u003cspan class=\"kw\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-5\" title=\"5\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;title\u0026gt;\u003c/span\u003ewebpack test\u003cspan class=\"kw\"\u003e\u0026lt;/title\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-6\" title=\"6\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;meta\u003c/span\u003e\u003cspan class=\"ot\"\u003e charset=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;utf-8\u0026quot;\u003c/span\u003e\u003cspan class=\"kw\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-7\" title=\"7\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;meta\u003c/span\u003e\u003cspan class=\"ot\"\u003e name=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;viewport\u0026quot;\u003c/span\u003e\u003cspan class=\"ot\"\u003e content=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;width=device-width, initial-scale=1\u0026quot;\u003c/span\u003e\u003cspan class=\"kw\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-8\" title=\"8\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;/head\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-9\" title=\"9\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;body\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-10\" title=\"10\"\u003e  \u003cspan class=\"kw\"\u003e\u0026lt;div\u003c/span\u003e\u003cspan class=\"ot\"\u003e id=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;root\u0026quot;\u003c/span\u003e\u003cspan class=\"kw\"\u003e\u0026gt;\u0026lt;/div\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-11\" title=\"11\"\u003e  \u003cspan class=\"kw\"\u003e\u0026lt;script\u003c/span\u003e\u003cspan class=\"ot\"\u003e src=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;./output.js\u0026quot;\u003c/span\u003e\u003cspan class=\"kw\"\u003e\u0026gt;\u0026lt;/script\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-12\" title=\"12\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;/body\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb27-13\" title=\"13\"\u003e\u003cspan class=\"kw\"\u003e\u0026lt;/html\u0026gt;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eブラウザで表示。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003eoutput.js\u003c/code\u003eの読み込みだけで表示されました。 動作に必要なスクリプト（\u003ccode\u003ereact.min.js\u003c/code\u003eや\u003ccode\u003ereact-dom.min.js\u003c/code\u003e）が、webpackによってすべて\u003ccode\u003eoutput.js\u003c/code\u003eに束ねられているからです。\u003c/p\u003e\r\n\u003ch2 id=\"reactコンポーネント\"\u003eReactコンポーネント\u003c/h2\u003e\r\n\u003cp\u003ecreate-react-app による開発は、自動作成された「src\\index.js」や、その中で読み込んでいる「src\\App.js」を編集して動作を確かめます。 ファイルやフォルダを分けてコードを管理するのもありです。\u003c/p\u003e\r\n\u003ch3 id=\"reactコンポーネントの種類\"\u003eReactコンポーネントの種類\u003c/h3\u003e\r\n\u003ch4 id=\"functional-component\"\u003eFunctional Component\u003c/h4\u003e\r\n\u003cp\u003e関数によって定義されるコンポーネント。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb28\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb28-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb28-2\" title=\"2\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb28-3\" title=\"3\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e (props) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb28-4\" title=\"4\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは、\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003eさん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb28-5\" title=\"5\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch4 id=\"class-component\"\u003eClass Component\u003c/h4\u003e\r\n\u003cp\u003eクラスによって定義されるコンポーネント。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb29\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb29-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003eclass\u003c/span\u003e Hello \u003cspan class=\"kw\"\u003eextends\u003c/span\u003e \u003cspan class=\"va\"\u003eReact\u003c/span\u003e.\u003cspan class=\"at\"\u003eComponent\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb29-2\" title=\"2\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb29-3\" title=\"3\"\u003e    \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは、\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003eさん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb29-4\" title=\"4\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb29-5\" title=\"5\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch5 id=\"functional-componentとの違い\"\u003eFunctional Componentとの違い\u003c/h5\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003ccode\u003eReact.Component\u003c/code\u003eを明示的に継承している。\u003c/li\u003e\r\n\u003cli\u003epropsの受け取り方がthis.propsとなっている。\u003c/li\u003e\r\n\u003cli\u003eコンポーネントの状態を記録する仕組みがある（state）。\u003c/li\u003e\r\n\u003cli\u003eライフサイクルメソッドという特殊なメソッドが定義できる。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch3 id=\"コンポーネントの再利用\"\u003eコンポーネントの再利用\u003c/h3\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb30\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb30-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは、坂本竜馬さん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-3\" title=\"3\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-5\" title=\"5\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-6\" title=\"6\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-7\" title=\"7\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-8\" title=\"8\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-9\" title=\"9\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-10\" title=\"10\"\u003e  \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-11\" title=\"11\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026quot;root\u0026quot;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb30-12\" title=\"12\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eReactコンポーネント : 設計図のようなもの。 オブジェクト指向でいえば〝クラス〟にあたる。\u003c/p\u003e\r\n\u003cp\u003eReactエレメント : 設計図（Reactコンポーネント）を元に作られた実体のこと。 オブジェクト指向でいえば〝インスタンス〟にあたる。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb31\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb31-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// こちらはReactコンポーネント\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-2\" title=\"2\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-3\" title=\"3\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは、坂本竜馬さん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-4\" title=\"4\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-6\" title=\"6\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-7\" title=\"7\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-8\" title=\"8\"\u003e    \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"co\"\u003e/* 以下のHello3つはどれも React エレメント */\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-9\" title=\"9\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-10\" title=\"10\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-11\" title=\"11\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-12\" title=\"12\"\u003e  \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-13\" title=\"13\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026quot;root\u0026quot;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb31-14\" title=\"14\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"fragmentコンポーネント\"\u003eFragmentコンポーネント\u003c/h3\u003e\r\n\u003cp\u003eReactコンポーネントは単一の親からなる要素しか表現できません。 複数の要素をラップする要素を使ってもよいのですが、これではもともと表現したかったHTML構造にならないことがあります。\u003c/p\u003e\r\n\u003cp\u003eReact.Fragmentコンポーネントを使うとこの制約をクリアすることができます。\u003c/p\u003e\r\n\u003cp\u003e↓ ダメな例\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb32\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb32-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb32-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb32-3\" title=\"3\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb32-4\" title=\"4\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e坂本竜馬さん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb32-5\" title=\"5\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb32-6\" title=\"6\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e↓ ラップして対処する方法\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb33\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb33-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb33-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb33-3\" title=\"3\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb33-4\" title=\"4\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb33-5\" title=\"5\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e坂本竜馬さん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb33-6\" title=\"6\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb33-7\" title=\"7\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb33-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e↓ \u003ccode\u003eReact.Fragment\u003c/code\u003eで対処する方法\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb34\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb34-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb34-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb34-3\" title=\"3\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"va\"\u003eReact\u003c/span\u003e.\u003cspan class=\"at\"\u003eFragment\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb34-4\" title=\"4\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb34-5\" title=\"5\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e坂本竜馬さん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb34-6\" title=\"6\"\u003e    \u0026lt;/\u003cspan class=\"va\"\u003eReact\u003c/span\u003e.\u003cspan class=\"at\"\u003eFragment\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb34-7\" title=\"7\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb34-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"データの受け渡しprops\"\u003eデータの受け渡し（props）\u003c/h3\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb35\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb35-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e (props) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは、\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003eさん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-3\" title=\"3\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-5\" title=\"5\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-6\" title=\"6\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-7\" title=\"7\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello name\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;A\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-8\" title=\"8\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello name\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;B\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-9\" title=\"9\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello name\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;C\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-10\" title=\"10\"\u003e  \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-11\" title=\"11\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026quot;root\u0026quot;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb35-12\" title=\"12\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eHelloの関数の引数に\u003ccode\u003eprops\u003c/code\u003eを追加します。引数の名前はなんでもいいですが、\u003ccode\u003eprops\u003c/code\u003eにするのが一般的。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003eprops\u003c/code\u003eの引数にはコンポーネントを使う側で指定した内容が入ります。\u003c/p\u003e\r\n\u003cp\u003e上記でいえば、\u003ccode\u003e\u0026lt;Hello name=\"A\" /\u0026gt;\u003c/code\u003eとして使っているので、\u003ccode\u003eprops\u003c/code\u003eには\u003ccode\u003ename\u003c/code\u003eというプロパティが追加され、「A」が格納されます。同様に\u003ccode\u003e\u0026lt;Hello name=\"B\" /\u0026gt;\u003c/code\u003eであれば、\u003ccode\u003eprops.name\u003c/code\u003eの値は「B」になります。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003eprops\u003c/code\u003eには文字列、数値、配列、オブジェクト、関数など任意の値を指定できます。 渡す値は\u003ccode\u003e{}\u003c/code\u003eで囲みます。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb36\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb36-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// 文字列\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-2\" title=\"2\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent stringValue\u003cspan class=\"op\"\u003e={\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;坂本竜馬\u0026quot;\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-4\" title=\"4\"\u003e\u003cspan class=\"co\"\u003e// 数値\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-5\" title=\"5\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent numberValue\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"dv\"\u003e42\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// 真偽値\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent boolValue\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"kw\"\u003etrue\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-9\" title=\"9\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-10\" title=\"10\"\u003e\u003cspan class=\"co\"\u003e// 配列\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-11\" title=\"11\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent arrayValue\u003cspan class=\"op\"\u003e={\u003c/span\u003e[\u003cspan class=\"st\"\u003e\u0026quot;Aさん\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Bさん\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Cさん\u0026quot;\u003c/span\u003e]\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-12\" title=\"12\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-13\" title=\"13\"\u003e\u003cspan class=\"co\"\u003e// オブジェクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-14\" title=\"14\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent objectValue\u003cspan class=\"op\"\u003e={{\u003c/span\u003e\u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Aさん\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"dt\"\u003ebirthDay\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;1836/01/03\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e}}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-15\" title=\"15\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-16\" title=\"16\"\u003e\u003cspan class=\"co\"\u003e// 関数\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-17\" title=\"17\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent funcValue\u003cspan class=\"op\"\u003e={\u003c/span\u003e(name) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"va\"\u003econsole\u003c/span\u003e.\u003cspan class=\"at\"\u003elog\u003c/span\u003e(name)\u003cspan class=\"op\"\u003e;}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-18\" title=\"18\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-19\" title=\"19\"\u003e\u003cspan class=\"co\"\u003e// 変数\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-20\" title=\"20\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e name \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Aさん\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-21\" title=\"21\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent value\u003cspan class=\"op\"\u003e={\u003c/span\u003ename\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-22\" title=\"22\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-23\" title=\"23\"\u003e\u003cspan class=\"co\"\u003e// 複数の値も渡せます\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb36-24\" title=\"24\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent name\u003cspan class=\"op\"\u003e={\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Aさん\u0026quot;\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e birthDay\u003cspan class=\"op\"\u003e={\u003c/span\u003e \u003cspan class=\"kw\"\u003enew\u003c/span\u003e \u003cspan class=\"at\"\u003eDate\u003c/span\u003e(\u003cspan class=\"dv\"\u003e1836\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"dv\"\u003e0\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"dv\"\u003e3\u003c/span\u003e) \u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003eprops.children\u003c/code\u003e\u003c/p\u003e\r\n\u003cp\u003eReactコンポーネントの子要素が渡されるプロパティです。\u003c/p\u003e\r\n\u003cp\u003e次の場合、\u003ccode\u003eprops.children\u003c/code\u003eには「坂本竜馬」が渡されます。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb37\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb37-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e (props) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは、\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003echildren\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003eさん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-3\" title=\"3\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-5\" title=\"5\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-6\" title=\"6\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-7\" title=\"7\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHello\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-8\" title=\"8\"\u003e      坂本竜馬      ←Helloコンポーネントの子要素が渡される\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-9\" title=\"9\"\u003e    \u0026lt;/Hello\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-10\" title=\"10\"\u003e  \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-11\" title=\"11\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026quot;root\u0026quot;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb37-12\" title=\"12\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"propsの型チェック\"\u003epropsの型チェック\u003c/h3\u003e\r\n\u003cp\u003eコンポーネントがどのようなpropsを受け取るのか記述することができます。 インターフェイスに合わない値が渡されたときに、エディタや実行時に警告を受け取ることができます。\u003c/p\u003e\r\n\u003cp\u003e別パッケージになっているので追加でインストールします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save prop-types\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eReactコンポーネントのpropTypesプロパティに型情報を記述します。 Functional Component/Class Componentのどちらでも記述できます。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb39\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb39-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e PropTypes \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;prop-types\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-2\" title=\"2\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-3\" title=\"3\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Hello \u003cspan class=\"op\"\u003e=\u003c/span\u003e (props) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-4\" title=\"4\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eこんにちは、\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003eさん\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-5\" title=\"5\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// ここに型情報を書きます\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-8\" title=\"8\"\u003e\u003cspan class=\"co\"\u003e// ↓\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-9\" title=\"9\"\u003e\u003cspan class=\"va\"\u003eHello\u003c/span\u003e.\u003cspan class=\"at\"\u003epropTypes\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-10\" title=\"10\"\u003e  \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003estring\u003c/span\u003e    \u003cspan class=\"co\"\u003e// nameの型はstring\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb39-11\" title=\"11\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003epropTypesの種類\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb40\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb40-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e PropTypes \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;prop-types\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-4\" title=\"4\"\u003e\u003cspan class=\"kw\"\u003eclass\u003c/span\u003e SomeComponent \u003cspan class=\"kw\"\u003eextends\u003c/span\u003e \u003cspan class=\"va\"\u003eReact\u003c/span\u003e.\u003cspan class=\"at\"\u003eComponent\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-5\" title=\"5\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-7\" title=\"7\"\u003e\u003cspan class=\"va\"\u003eSomeComponent\u003c/span\u003e.\u003cspan class=\"at\"\u003epropTypes\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-8\" title=\"8\"\u003e  \u003cspan class=\"dt\"\u003esomeString\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003estring\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"co\"\u003e// 文字列\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-9\" title=\"9\"\u003e  \u003cspan class=\"dt\"\u003esomeNumber\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003enumber\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"co\"\u003e// 数値\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-10\" title=\"10\"\u003e  \u003cspan class=\"dt\"\u003esomeBool\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e   \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003ebool\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e   \u003cspan class=\"co\"\u003e// 真偽値\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-11\" title=\"11\"\u003e  \u003cspan class=\"dt\"\u003esomeArray\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e  \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003earray\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e  \u003cspan class=\"co\"\u003e// 配列\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-12\" title=\"12\"\u003e  \u003cspan class=\"dt\"\u003esomeObject\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eobject\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"co\"\u003e// オブジェクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-13\" title=\"13\"\u003e  \u003cspan class=\"dt\"\u003esomeFunc\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e   \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003efunc\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e   \u003cspan class=\"co\"\u003e// 関数\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-14\" title=\"14\"\u003e  \u003cspan class=\"dt\"\u003esomeSymbol\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003esymbol\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"co\"\u003e// シンボル\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-15\" title=\"15\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-16\" title=\"16\"\u003e  \u003cspan class=\"co\"\u003e// 配列の中身を指定\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-17\" title=\"17\"\u003e  \u003cspan class=\"dt\"\u003esomeArray2\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003earayOf\u003c/span\u003e(\u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003enumber\u003c/span\u003e)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-18\" title=\"18\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-19\" title=\"19\"\u003e  \u003cspan class=\"co\"\u003e// オブジェクトの中身を指定\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-20\" title=\"20\"\u003e  \u003cspan class=\"dt\"\u003esomeObj2\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e   \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eobjectOf\u003c/span\u003e(\u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003enumber\u003c/span\u003e)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-21\" title=\"21\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-22\" title=\"22\"\u003e  \u003cspan class=\"co\"\u003e// オブジェクトの個別のプロパティの中身を指定\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-23\" title=\"23\"\u003e  \u003cspan class=\"dt\"\u003esomeObj3\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e   \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eshape\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-24\" title=\"24\"\u003e    \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003estring\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-25\" title=\"25\"\u003e    \u003cspan class=\"dt\"\u003eage\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e  \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003enumber\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-26\" title=\"26\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-27\" title=\"27\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-28\" title=\"28\"\u003e  \u003cspan class=\"co\"\u003e// Reactエレメント\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-29\" title=\"29\"\u003e  \u003cspan class=\"dt\"\u003esomeElement\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eelement\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-30\" title=\"30\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-31\" title=\"31\"\u003e  \u003cspan class=\"co\"\u003e// コンポーネントの子要素となるもの\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-32\" title=\"32\"\u003e  \u003cspan class=\"co\"\u003e// （string, number, element, array ならOK）\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-33\" title=\"33\"\u003e  \u003cspan class=\"dt\"\u003esomeNode\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003enode\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-34\" title=\"34\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-35\" title=\"35\"\u003e  \u003cspan class=\"co\"\u003e// Helloコンポーネントのインスタンスを指定\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-36\" title=\"36\"\u003e  \u003cspan class=\"dt\"\u003ehelloElement\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003einstanceOf\u003c/span\u003e(Hello)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-37\" title=\"37\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-38\" title=\"38\"\u003e  \u003cspan class=\"co\"\u003e// 指定した値のいずれかであること\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-39\" title=\"39\"\u003e  \u003cspan class=\"dt\"\u003edayOfTheWeek\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eoneOf\u003c/span\u003e([\u003cspan class=\"st\"\u003e\u0026quot;月\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;火\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;水\u0026quot;\u003c/span\u003e])\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-40\" title=\"40\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-41\" title=\"41\"\u003e  \u003cspan class=\"co\"\u003e// 配列で指定した型のいずれかであること\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-42\" title=\"42\"\u003e  \u003cspan class=\"dt\"\u003eunion\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eoneOfType\u003c/span\u003e([\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-43\" title=\"43\"\u003e    \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003estring\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-44\" title=\"44\"\u003e    \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003enumber\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-45\" title=\"45\"\u003e    \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003einstanceOf\u003c/span\u003e(Hello)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-46\" title=\"46\"\u003e  ])\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-47\" title=\"47\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-48\" title=\"48\"\u003e  \u003cspan class=\"co\"\u003e// 何でもオーケー\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-49\" title=\"49\"\u003e  \u003cspan class=\"dt\"\u003eany\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eany\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-50\" title=\"50\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-51\" title=\"51\"\u003e  \u003cspan class=\"co\"\u003e// 必須項目\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-52\" title=\"52\"\u003e  \u003cspan class=\"dt\"\u003erequiredString\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-53\" title=\"53\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-54\" title=\"54\"\u003e  \u003cspan class=\"co\"\u003e// どんな型でもいいから何かしら指定\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-55\" title=\"55\"\u003e  \u003cspan class=\"dt\"\u003erequiredAny\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003eany\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-56\" title=\"56\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-57\" title=\"57\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-58\" title=\"58\"\u003e\u003cspan class=\"co\"\u003e// propsの値が undefined だったときの規定値を指定する\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-59\" title=\"59\"\u003e\u003cspan class=\"va\"\u003eSomeComponent\u003c/span\u003e.\u003cspan class=\"at\"\u003edefaultProps\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-60\" title=\"60\"\u003e  \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;坂本竜馬\u0026quot;\u003c/span\u003e    \u003cspan class=\"co\"\u003e// name が undefined のときに設定する内容\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb40-61\" title=\"61\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003eArray.map\u003c/code\u003eメソッド : 配列の各要素について、引数に与えられた関数の処理に従って処理をし、新たな配列を返すメソッド。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e~~~javascript\r\n// tasksの各要素をTodoItemコンポーネントにして返す\r\nconst list = this.props.tasks.map(todo =\u0026gt; {\r\n  return \u0026lt;TodoItem {...todo} key={todo.id} /\u0026gt;;\r\n});\r\n~~~\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"stateの初期値\"\u003estateの初期値\u003c/h3\u003e\r\n\u003cp\u003e\u003ccode\u003econstructor\u003c/code\u003eで設定します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb42\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb42-1\" title=\"1\"\u003e\u003cspan class=\"at\"\u003econstructor\u003c/span\u003e(props) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-2\" title=\"2\"\u003e  \u003cspan class=\"kw\"\u003esuper\u003c/span\u003e(props)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-3\" title=\"3\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003estate\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-4\" title=\"4\"\u003e    \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e [\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-5\" title=\"5\"\u003e      \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"dt\"\u003etitle\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Todo-1\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"dv\"\u003e0\u003c/span\u003e \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-6\" title=\"6\"\u003e      \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"dt\"\u003etitle\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Todo-2\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"dv\"\u003e1\u003c/span\u003e \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-7\" title=\"7\"\u003e    ]\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-8\" title=\"8\"\u003e    \u003cspan class=\"dt\"\u003euniqueId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"dv\"\u003e1\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-9\" title=\"9\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb42-10\" title=\"10\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003ccode\u003estate\u003c/code\u003eの名前は変更できません。\u003c/li\u003e\r\n\u003cli\u003e\u003ccode\u003ethis.state\u003c/code\u003eに直接値を入れていいのは\u003ccode\u003econstructor\u003c/code\u003eで初期値を設定するときだけです。 それ以外の場面で直接編集してしまうと、Reactコンポーネントに値の変更を通知することができません。\u003c/li\u003e\r\n\u003cli\u003e\u003ccode\u003ethis.state\u003c/code\u003eを更新するときは\u003ccode\u003ethis.setState\u003c/code\u003eメソッドを使います。 いまあるstateと比べて、変更があった内容を反映します。stateをごっそり置き換えるわけではありません。\u003c/li\u003e\r\n\u003cli\u003e\u003ccode\u003ethis.state\u003c/code\u003eを直接参照するのはありです。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb43\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb43-1\" title=\"1\"\u003e\u003cspan class=\"at\"\u003econstructor\u003c/span\u003e(props) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb43-2\" title=\"2\"\u003e  ...\u003cspan class=\"at\"\u003e略\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb43-3\" title=\"3\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb43-4\" title=\"4\"\u003e  \u003cspan class=\"co\"\u003e// bindメソッド\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb43-5\" title=\"5\"\u003e  \u003cspan class=\"co\"\u003e// 指定したメソッドでAppコンポーネントのstateを変更するために必要\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb43-6\" title=\"6\"\u003e  \u003cspan class=\"co\"\u003e// ↓\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb43-7\" title=\"7\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003emethodName\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003emethodName\u003c/span\u003e.\u003cspan class=\"at\"\u003ebind\u003c/span\u003e(\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003ebind\u003c/code\u003eメソッド : 関数の中で使用する\u003ccode\u003ethis\u003c/code\u003eを強制する（バインドする）メソッド。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003emethodNameメソッドを実行するのは、Appコンポーネントではない別のコンポーネントやDOMになります。\r\nそれらのコンテキストである`this`には`state`が存在しないのでエラーが発生します。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eほかのバインドの方法\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003cp\u003eアロー関数を使う\u003c/p\u003e\r\n\u003cp\u003eアロー関数を使うときは、constructorにbindメソッドを書く必要がありません。 ですが、同じメソッドを複数のコンポーネントに渡したい場合、その数だけアロー関数を書く必要があります。\u003c/p\u003e\r\n\u003cp\u003e毎回新しいアロー関数を作ることになるので、パフォーマンスも少し劣ります。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb45\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb45-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// アロー関数を使う\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb45-2\" title=\"2\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eComponent methodName\u003cspan class=\"op\"\u003e={\u003c/span\u003e (hoge) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003emethodName\u003c/span\u003e(hoge) \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eproperty initializer syntax を使う\u003c/p\u003e\r\n\u003cp\u003e最初からバインドされたメソッドを作ることができます。 アロー関数のようなパフォーマンスの懸念もありません。\u003c/p\u003e\r\n\u003cp\u003eただし、ECMAScriptに公式なシンタックスとして採用されていないため、babelにプラグインを追加しておく必要があります。\u003c/p\u003e\r\n\u003cp\u003eClass properties transform・Babel（transform-class-properties）\u003c/p\u003e\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch3 id=\"イベントハンドリング\"\u003eイベントハンドリング\u003c/h3\u003e\r\n\u003cp\u003eイベントハンドラを追加します。\u003c/p\u003e\r\n\u003cp\u003e下記の例では、クリック時のイベントを\u003ccode\u003ehandleClick\u003c/code\u003eメソッドに定義しています。 イベントとの関連付けは、button要素のonClick属性に\u003ccode\u003ehandleClick\u003c/code\u003eメソッドを設定しています。\u003c/p\u003e\r\n\u003cp\u003eReactでは\u003ccode\u003eonClick\u003c/code\u003eといった属性に関数を渡して、イベントの関連付けをします。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb46\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb46-1\" title=\"1\"\u003e\u003cspan class=\"at\"\u003econstructor\u003c/span\u003e(props) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-2\" title=\"2\"\u003e  \u003cspan class=\"kw\"\u003esuper\u003c/span\u003e(props)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-3\" title=\"3\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003ehandleClick\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003ehandleClick\u003c/span\u003e.\u003cspan class=\"at\"\u003ebind\u003c/span\u003e(\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e   \u003cspan class=\"co\"\u003e// バインドする\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-4\" title=\"4\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-5\" title=\"5\"\u003e\u003cspan class=\"co\"\u003e// Eventオブジェクトを引数に持つ\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-6\" title=\"6\"\u003e\u003cspan class=\"at\"\u003ehandleClick\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-7\" title=\"7\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003emethodName\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026quot;hoge\u0026quot;\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-9\" title=\"9\"\u003e\u003cspan class=\"at\"\u003erender\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-10\" title=\"10\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-11\" title=\"11\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-12\" title=\"12\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput placeholder\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;何か入力してください\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-13\" title=\"13\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ebutton onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003ehandleClick\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e登録\u0026lt;/button\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-14\" title=\"14\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb46-15\" title=\"15\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eイベントハンドラの引数は、Eventオブジェクトを受け取ります。 ブラウザ本来のEventオブジェクトとほぼ同じものです。\u003c/p\u003e\r\n\u003ch3 id=\"formの操作\"\u003eformの操作\u003c/h3\u003e\r\n\u003cp\u003eReactではフォームに入力された値も\u003ccode\u003estate\u003c/code\u003eとして扱います。\u003c/p\u003e\r\n\u003cp\u003e以下は、ユーザーの入力で state を変更するコードです。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb47\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb47-1\" title=\"1\"\u003e\u003cspan class=\"at\"\u003econstructor\u003c/span\u003e(props) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-2\" title=\"2\"\u003e  \u003cspan class=\"kw\"\u003esuper\u003c/span\u003e(props)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-3\" title=\"3\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003estate\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-4\" title=\"4\"\u003e    \u003cspan class=\"dt\"\u003einputValue\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-5\" title=\"5\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-6\" title=\"6\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003ehandleChange\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003ehandleChange\u003c/span\u003e.\u003cspan class=\"at\"\u003ebind\u003c/span\u003e(\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-7\" title=\"7\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003ehandleClick\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003ehandleClick\u003c/span\u003e.\u003cspan class=\"at\"\u003ebind\u003c/span\u003e(\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-9\" title=\"9\"\u003e\u003cspan class=\"at\"\u003ehandleChange\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-10\" title=\"10\"\u003e  \u003cspan class=\"co\"\u003e// ユーザーの入力した値をstate.inputValueに格納する\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-11\" title=\"11\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003esetState\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-12\" title=\"12\"\u003e    \u003cspan class=\"dt\"\u003einputValue\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ee\u003c/span\u003e.\u003cspan class=\"va\"\u003etarget\u003c/span\u003e.\u003cspan class=\"at\"\u003evalue\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-13\" title=\"13\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-14\" title=\"14\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-15\" title=\"15\"\u003e\u003cspan class=\"at\"\u003ehandleClick\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-16\" title=\"16\"\u003e  \u003cspan class=\"kw\"\u003econst\u003c/span\u003e inputValue \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"at\"\u003einputValue\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-17\" title=\"17\"\u003e  \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003emethodName\u003c/span\u003e(inputValue)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-18\" title=\"18\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-19\" title=\"19\"\u003e\u003cspan class=\"at\"\u003erender\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-20\" title=\"20\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-21\" title=\"21\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;TodoInput\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-22\" title=\"22\"\u003e      \u003cspan class=\"va\"\u003e▼valueにstate\u003c/span\u003e.\u003cspan class=\"at\"\u003einputValueを設定、onChangeにhandleChangeメソッドを関連付け\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-23\" title=\"23\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput placeholder\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;何か入力してください\u0026quot;\u003c/span\u003e value\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"at\"\u003einputValue\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e onChange\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003ehandleChange\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-24\" title=\"24\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ebutton onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003ehandleClick\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e登録\u0026lt;/button\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-25\" title=\"25\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-26\" title=\"26\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb47-27\" title=\"27\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"まとめ-reactコンポーネントの作成手順\"\u003eまとめ: Reactコンポーネントの作成手順\u003c/h3\u003e\r\n\u003col\u003e\r\n\u003cli\u003eUIをコンポーネントに分割する\u003c/li\u003e\r\n\u003cli\u003epropsやstateによって、どのようにUIが変化するかを定義する（JSXの作成）\u003c/li\u003e\r\n\u003cli\u003eユーザー操作によって、どのようにstateが変化するかを定義する（メソッドの作成）\u003c/li\u003e\r\n\u003cli\u003eUIとメソッドを関連付ける（onClick属性などを設定）\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003cp\u003eコンポーネントごとの責務を明らかにすること。\u003c/p\u003e\r\n\u003ch3 id=\"ライフサイクル\"\u003eライフサイクル\u003c/h3\u003e\r\n\u003cp\u003eReactコンポーネントにはライフサイクルメソッドと呼ばれる特殊なメソッドがあります。 Reactコンポーネントの状態に応じて、次の3つのうち対応するメソッドが呼ばれます。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eコンポーネントのマウントに対応して呼ばれるメソッド。\u003c/li\u003e\r\n\u003cli\u003eコンポーネントで扱うデータの変化に対応して呼ばれるメソッド。\u003c/li\u003e\r\n\u003cli\u003eエラーハンドリングに用いるメソッド。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch4 id=\"マウントに関するライフサイクルメソッド\"\u003eマウントに関するライフサイクルメソッド\u003c/h4\u003e\r\n\u003cp\u003eReactコンポーネントが新しく配置されるときに呼び出されるメソッドです。 コンポーネントの\u003ccode\u003erender\u003c/code\u003eメソッドが初めて呼ばれたときに、コンポーネントがマウントされた状態となります。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eコンポーネントのマウント ＝ コンポーネントの\u003ccode\u003erender\u003c/code\u003eメソッドが初めて呼ばれたとき\u003c/li\u003e\r\n\u003cli\u003eコンポーネントのアップデート ＝ 2回目以降の\u003ccode\u003erender\u003c/code\u003eメソッドの呼び出し\u003c/li\u003e\r\n\u003cli\u003eコンポーネントのアンマウント ＝ DOM上からなくなったとき\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003ecomponentWillMount : コンポーネントがマウントされる直前に呼ばれます。 コンポーネントを描画する\u003ccode\u003erender\u003c/code\u003eメソッドよりも先に呼ばれます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eただ、コンストラクターも`render`メソッドより先に呼ばれるので、マウント前にしたい処理はここではなくコンストラクターで実行すれば十分です。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ecomponentDidMount : コンポーネントがマウントされた直後に呼ばれます。 DOMがブラウザにレンダリングされたあとなので、DOMに対してイベントリスナーを設定したりサブスクライブなどの処理をしたりします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eTODO: サブスクライブって何でしょう？？\r\n\r\n`setState`は行わないこと。\r\n\r\nstateが変更されるとrenderメソッドが実行されます。\r\nrender → componentDidMount → setState → renderとなり、renderメソッドが2回実行されてしまうためです。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ecomponentWillUnmount : コンポーネントがアンマウントされる直前に呼ばれます。 各種コンポーネントに関連付けた処理の後始末をします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eたとえば、setInterval関数に対するclearIntervalの実行や、APIリクエストのキャンセルなどです。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch4 id=\"データのアップデートに関するライフサイクルメソッド\"\u003eデータのアップデートに関するライフサイクルメソッド\u003c/h4\u003e\r\n\u003cp\u003eアップデートはコンポーネントのpropsかstateが変更されたときに行われます。 初回のレンダリングはマウントとして扱われるため、マウント時にはこれらのメソッドは実行されません。\u003c/p\u003e\r\n\u003cp\u003ecomponentWillReceiveProps : 引数に受け取る予定のpropsをとります。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e~~~javascript\r\ncomponentWillReceiveProps(nextProps)\r\n~~~\r\n\r\npropsがアップデートされようとしているときのみ実行されます。\r\npropsの受け取りで実行されるため、変更の有無は関係なく実行されます。\r\n\r\nthis.propsには以前に受け取ったpropsが入っています。\r\n引数のnextPropsと比較する処理をすることができます。\r\n\r\nsetStateをすることも可能です。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eshouldComponentUpdate : propsやstateに変更が合った場合に呼ばれます。 引数は次に受け取るpropsとstateです。 this.propsとthis.stateには前回の内容が入っています。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e~~~javascript\r\nshouldComponentUpdate(nextProps, nextStaet)\r\n~~~\r\n\r\nrenderを行うべきかどうかをtrue/falseで返す必要があります。\r\n\r\nこのメソッドを指定しなかった場合、どのような変更でもrenderメソッドが呼び出されます（常にtrueを返すように指定したのと同じ）。\r\n\r\nこのメソッドはパフォーマンスチューニングをする際に利用します。\r\n表示に使っていないpropを受け取ったときや、そもそもpropsやstateに変更がなかったときは不要なrenderを行わないようにします。\r\n\r\n変更がないpropやstateを受け取ったときに再描画させないようにするもう一つの方法。\r\n\r\n`React.Component`を継承する代わりに`React.PureComponent`を継承すると、Reactが自動的に浅い比較（オブジェクトや配列の中身までは確認しない比較）を行うので、通常はこちらを利用する方が便利です。\r\nなにか特別な比較を行い、renderの有無を決めるときだけ`shouldComponentUpdate`を利用することを推奨します。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ecomponentWillUpdate : renderが呼ばれる前に呼ばれる最後のメソッドです。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e引数は次に受け取るpropsとstateです。\r\nthis.propsとthis.stateには前回の内容が入っています。\r\n\r\n~~~javascript\r\ncomponentWillUpdate(nextProps, nextStaet)\r\n~~~\r\n\r\n`setState`などコンポーネントの再レンダリングを促すような処理はしないこと。\r\n変更に対して`componentWillUpdate`、`render`が実行され、処理がループする可能性があるためです。\r\n\r\npropsの値を使ってstateを変更したいときは`componentWillReceiveProps`メソッドを使います。\r\n\r\n`shouldComponentUpdate`でfalseを返した場合、このメソッドは呼ばれません。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ecomponentDidUpdate : renderの直後に呼ばれます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e引数は前のpropsとstateです。\r\nthis.propsとthis.stateは、いまの値（renderに使った内容）が格納されています。\r\n\r\n~~~javascript\r\ncomponentDidUpdate(prevProps, prevStaet)\r\n~~~\r\n\r\nアップデート後のDOMにアクセスするときや、変更が完了したことをAPIに通知するときなどに利用します。\r\n\r\n`shouldComponentUpdate`でfalseを返した場合、このメソッドは呼ばれません。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch4 id=\"エラーハンドリングに関するライフサイクルメソッド\"\u003eエラーハンドリングに関するライフサイクルメソッド\u003c/h4\u003e\r\n\u003cp\u003eエラーが起きたときだけ呼ばれるライフサイクルメソッドです。 React v16 から実装されています。\u003c/p\u003e\r\n\u003cp\u003ecomponentDidCatch : 子コンポーネントでエラーが起こったときに呼ばれます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e~~~Javascript\r\ncomponentDidCatch(error, info)\r\n~~~\r\n\r\n引数にスタックとレースが入ったerror、その他の情報が入ったinfoをとります。\r\n\r\ninfoはオブジェクトで、現時点では`componentStack`プロパティしか持っていません。\r\nこれにはどのコンポーネントでエラーが発生したかが入っています。\r\n\r\nエラー解析の手がかりとなるので、どちらもログとして送信するようにしておくと便利。\r\n\r\n`setState`などの処理を行うことも可能。\r\n\r\nこのメソッドを記述したコンポーネント自体のエラーは検知できません。\r\n子コンポーネントのエラーを検知するためのメソッドです。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch2 id=\"reduxによるアプリケーションの状態管理\"\u003eReduxによるアプリケーションの状態管理\u003c/h2\u003e\r\n\u003cp\u003e\u003ccode\u003ecreate-react-app\u003c/code\u003eで新しいアプリケーションを作成します。\u003c/p\u003e\r\n\u003ch3 id=\"reduxのインストール\"\u003eReduxのインストール\u003c/h3\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save redux\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"reduxの構成\"\u003eReduxの構成\u003c/h3\u003e\r\n\u003cp\u003eStore : アプリケーションの状態（\u003ccode\u003estate\u003c/code\u003e）とロジックを保持している居場所。\u003c/p\u003e\r\n\u003cp\u003eReducer : Storeが保持している状態を変化させるための関数。\u003c/p\u003e\r\n\u003cp\u003eAction : 何らかの状態変化を引き起こす現象。たとえば、ユーザー入力、APIから取得した情報。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eActionの形式を標準化した〝Flux Standard Action〟というものがあります。\r\nActionを扱うライブラリ（`redux-actions`や`redux-promise`など）でも、これを採用したものが多いので、この形式に沿っておくのがよいでしょう。\r\n\r\nActionオブジェクトには、次のプロパティを持たせることができます。\r\n\r\n- type\r\n  \r\n  必須プロパティです。\r\n  どのような操作をしたのかが分かる内容を指定します。\r\n\r\n- payload\r\n  \r\n  Actionに伴うデータ。オブジェクト形式で扱うのが一般的。\r\n  errorプロパティがtrueのときはErrorオブジェクトを返すべき。\r\n  \r\n- error\r\n  \r\n  エラーを表現するときはtrueにします。\r\n  \r\n- meta\r\n  \r\n  payloadとは別に、ほかの情報をActionとして含めたいときに使う項目です。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"reducerの定義\"\u003eReducerの定義\u003c/h3\u003e\r\n\u003cp\u003eStoreの初期状態［index.js］\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb58\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb58-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb58-2\" title=\"2\"\u003e  \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e []\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb58-3\" title=\"3\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003etasksReducerの定義［index.js］\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb59\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb59-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// Reducerの定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-2\" title=\"2\"\u003e\u003cspan class=\"co\"\u003e// 第1引数は、現在の状態を表すstateオブジェクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-3\" title=\"3\"\u003e\u003cspan class=\"co\"\u003e// 第2引数は、どのような操作をしたのかを示すActionオブジェクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-4\" title=\"4\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003etasksReducer\u003c/span\u003e(state \u003cspan class=\"op\"\u003e=\u003c/span\u003e initialState\u003cspan class=\"op\"\u003e,\u003c/span\u003e action) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-5\" title=\"5\"\u003e  \u003cspan class=\"cf\"\u003eswitch\u003c/span\u003e (\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"at\"\u003etype\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-6\" title=\"6\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;ADD_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-7\" title=\"7\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-8\" title=\"8\"\u003e        ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-9\" title=\"9\"\u003e        \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003econcat\u003c/span\u003e([\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e])    \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: action.payload.taskでは？　→　そのとおりでした。\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-10\" title=\"10\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-11\" title=\"11\"\u003e    \u003cspan class=\"dt\"\u003edefault\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-12\" title=\"12\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e state\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-13\" title=\"13\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb59-14\" title=\"14\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eActionオブジェクトのイメージ\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb60\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb60-1\" title=\"1\"\u003e\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb60-2\" title=\"2\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;ADD_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb60-3\" title=\"3\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb60-4\" title=\"4\"\u003e    \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;Study Reducer\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb60-5\" title=\"5\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb60-6\" title=\"6\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"actioncreatorの定義\"\u003eActionCreatorの定義\u003c/h3\u003e\r\n\u003cp\u003eActionCreatorとはActionを生成するための関数です。\u003c/p\u003e\r\n\u003cp\u003eActionを生成する関数の定義［index.js］\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb61\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb61-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// ActionCreatorの定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb61-2\" title=\"2\"\u003e\u003cspan class=\"co\"\u003e// 追加するtaskを引数に取り、Actionオブジェクトを返す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb61-3\" title=\"3\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e addTask \u003cspan class=\"op\"\u003e=\u003c/span\u003e (task) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb61-4\" title=\"4\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;ADD_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb61-5\" title=\"5\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb61-6\" title=\"6\"\u003e    task\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb61-7\" title=\"7\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb61-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"storeの定義\"\u003eStoreの定義\u003c/h3\u003e\r\n\u003cp\u003eReduxの\u003ccode\u003ecreateStore\u003c/code\u003e関数を使ってStoreを生成します。 生成したStoreはアプリケーション内で唯一のものです。 アプリケーション全体のさまざまな状態をこのStoreで集約管理します。\u003c/p\u003e\r\n\u003cp\u003eReduxのStoreを生成するにはReducerが必要となります。\u003c/p\u003e\r\n\u003cp\u003eStoreの作成［index.js］\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb62\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb62-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb62-2\" title=\"2\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb62-3\" title=\"3\"\u003e\u003cspan class=\"co\"\u003e// Reducerの定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb62-4\" title=\"4\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003etasksReducer\u003c/span\u003e(state \u003cspan class=\"op\"\u003e=\u003c/span\u003e initialState\u003cspan class=\"op\"\u003e,\u003c/span\u003e action) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb62-5\" title=\"5\"\u003e  \u003cspan class=\"co\"\u003e// ...略\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb62-6\" title=\"6\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb62-7\" title=\"7\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb62-8\" title=\"8\"\u003e\u003cspan class=\"co\"\u003e// Storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb62-9\" title=\"9\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(tasksReducer)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb63\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb63-1\" title=\"1\"\u003e\u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(reducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e [preloadedState]\u003cspan class=\"op\"\u003e,\u003c/span\u003e [enhancer])\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e引数\u003c/p\u003e\r\n\u003cp\u003ereducer : Reducerを指定します。\u003c/p\u003e\r\n\u003cp\u003epreloadedState : Storeの初期値を指定します。 サーバーサイドやユーザーセッションで事前にデータを保持しているときに利用することが想定されます。\u003c/p\u003e\r\n\u003cp\u003eenhancer : Storeの機能を拡張するサードパーティ製のツールを指定できます。\u003c/p\u003e\r\n\u003cp\u003e戻り値\u003c/p\u003e\r\n\u003cp\u003eStoreオブジェクト\u003c/p\u003e\r\n\u003cp\u003eStoreオブジェクトは次の4つのメソッドを持ちます。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003cp\u003edispatch\u003c/p\u003e\r\n\u003cp\u003eActionCreatorで生成したActionを発行します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb64\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb64-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// ActionCreatorの定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb64-2\" title=\"2\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e addTask \u003cspan class=\"op\"\u003e=\u003c/span\u003e (task) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb64-3\" title=\"3\"\u003e  ... \u003cspan class=\"at\"\u003e略\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb64-4\" title=\"4\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb64-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb64-6\" title=\"6\"\u003e\u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026quot;Study Store\u0026quot;\u003c/span\u003e))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003egetState\u003c/p\u003e\r\n\u003cp\u003eStoreの現在の状態を取得します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb65\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb65-1\" title=\"1\"\u003e\u003cspan class=\"va\"\u003econsole\u003c/span\u003e.\u003cspan class=\"at\"\u003elog\u003c/span\u003e(\u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003egetState\u003c/span\u003e())\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb65-2\" title=\"2\"\u003e↓\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb65-3\" title=\"3\"\u003e\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb65-4\" title=\"4\"\u003e  \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e [\u003cspan class=\"st\"\u003e\u0026#39;Study Store\u0026#39;\u003c/span\u003e]\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb65-5\" title=\"5\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003esubscribe\u003c/p\u003e\r\n\u003cp\u003eStoreの状態が変更されたときに呼び出されるコールバック関数を指定します。\u003c/p\u003e\r\n\u003cp\u003eActionのdispatchによってStoreの状態が変わったときに、その変換を監視する役目を担う処理。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003estore.subscribe\u003c/code\u003eで監視を開始します。 \u003ccode\u003estore.subscribe\u003c/code\u003eの戻り値である\u003ccode\u003eunsubscribe\u003c/code\u003eを実行することで、\u003ccode\u003esubscribe\u003c/code\u003eを解除することができます。\u003c/p\u003e\r\n\u003cp\u003e実際にReactと組み合わせるときは、\u003ccode\u003ereact-redux\u003c/code\u003eというライブラリを使います。 \u003ccode\u003ereact-redux\u003c/code\u003eが\u003ccode\u003esubscribe\u003c/code\u003eの仕組みを隠蔽するため、Storeの状態が変化するとReactのViewが更新されるというシンプルな流れになります。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb66\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb66-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003ehandleChange\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb66-2\" title=\"2\"\u003e  \u003cspan class=\"va\"\u003econsole\u003c/span\u003e.\u003cspan class=\"at\"\u003elog\u003c/span\u003e(\u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003egetState\u003c/span\u003e())\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb66-3\" title=\"3\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb66-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb66-5\" title=\"5\"\u003e\u003cspan class=\"co\"\u003e// Storeの状態が変化したときに handleChange 関数が呼ばれる。\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb66-6\" title=\"6\"\u003e\u003cspan class=\"co\"\u003e// subscribeの戻り値は unsubscribe という関数。\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb66-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// これを実行すると状態変化の通知が解除され、handleChange 関数は呼ばれなくなる。\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb66-8\" title=\"8\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e unsubscribe \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003esubscribe\u003c/span\u003e(handleChange)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003ereplaceReducer\u003c/p\u003e\r\n\u003cp\u003ecreateStoreで関連付けたReducerを、別のReducerに差し替えるメソッドです。\u003c/p\u003e\r\n\u003cp\u003ecreateStoreで関連付けることができるReducerは1つだけです。 複数あるReducerを動的にロードしたいときにこのメソッドで差し替えをします。\u003c/p\u003e\r\n\u003cp\u003eStoreに関連付けられているReducerのみしか適用されないので、特別な理由がない限り、combineReducerによって一つにまとめたReducerを関連付けてしまう方が楽。\u003c/p\u003e\r\n\u003cp\u003ecombineReducer : Reduxに備わっているメソッドで、複数のReducerを合成します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e  通常、一つのReducer内で処理分岐して定義して問題ありませんが、規模が大きくなってくると見通しが悪くなってくるのでReducerを分割したくなります。\r\n  そんなときにどうぞ。\r\n  \r\n  Storeはアプリケーション内で一つということに変わりはありませんが、Reducerを分割することで、Storeを擬似的に分割できる点がメリットです。\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch3 id=\"reactと組み合わせる\"\u003eReactと組み合わせる\u003c/h3\u003e\r\n\u003cp\u003e次の機能を持たせます。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eReactを使って状態の変化をViewに反映する。\u003c/li\u003e\r\n\u003cli\u003eブラウザからのタスク入力を可能にする。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003eタスク入力用のActionCreatorの定義\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb68\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb68-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// タスク入力用のActionCreator\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb68-2\" title=\"2\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e inputTask \u003cspan class=\"op\"\u003e=\u003c/span\u003e (task) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb68-3\" title=\"3\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;INPUT_TASK\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb68-4\" title=\"4\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb68-5\" title=\"5\"\u003e    task\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb68-6\" title=\"6\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb68-7\" title=\"7\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eタスク入力用のActionを受け取りStoreを変更できるように、Reducerを変更する\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb69\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb69-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-2\" title=\"2\"\u003e  \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e       \u003cspan class=\"co\"\u003e// ←追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-3\" title=\"3\"\u003e  \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e []\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-4\" title=\"4\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-6\" title=\"6\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003etasksReducer\u003c/span\u003e(state \u003cspan class=\"op\"\u003e=\u003c/span\u003e initialState\u003cspan class=\"op\"\u003e,\u003c/span\u003e action) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-7\" title=\"7\"\u003e  \u003cspan class=\"cf\"\u003eswitch\u003c/span\u003e (\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"at\"\u003etype\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-8\" title=\"8\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;INPUT_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e    \u003cspan class=\"co\"\u003e// INPUT_TASKのCaseを追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-9\" title=\"9\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-10\" title=\"10\"\u003e        ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-11\" title=\"11\"\u003e        \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-12\" title=\"12\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-13\" title=\"13\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;ADD_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-14\" title=\"14\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-15\" title=\"15\"\u003e        ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-16\" title=\"16\"\u003e        \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003econcat\u003c/span\u003e([\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e])\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-17\" title=\"17\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-18\" title=\"18\"\u003e    \u003cspan class=\"dt\"\u003edefault\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-19\" title=\"19\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e state\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-20\" title=\"20\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb69-21\" title=\"21\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eReactコンポーネントの定義を追加する\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb70\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb70-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eTodoApp\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e store \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-2\" title=\"2\"\u003e  \u003cspan class=\"kw\"\u003econst\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e task\u003cspan class=\"op\"\u003e,\u003c/span\u003e tasks \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003egetState\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-3\" title=\"3\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-4\" title=\"4\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-5\" title=\"5\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e onChange\u003cspan class=\"op\"\u003e={\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(\u003cspan class=\"va\"\u003ee\u003c/span\u003e.\u003cspan class=\"va\"\u003etarget\u003c/span\u003e.\u003cspan class=\"at\"\u003evalue\u003c/span\u003e))\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-6\" title=\"6\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e value\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;add\u0026quot;\u003c/span\u003e onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task))\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-7\" title=\"7\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-8\" title=\"8\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-9\" title=\"9\"\u003e          \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003emap\u003c/span\u003e(\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e(item\u003cspan class=\"op\"\u003e,\u003c/span\u003e i) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-10\" title=\"10\"\u003e            \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-11\" title=\"11\"\u003e              \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli key\u003cspan class=\"op\"\u003e={\u003c/span\u003ei\u003cspan class=\"op\"\u003e}\u0026gt;{\u003c/span\u003eitem\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-12\" title=\"12\"\u003e            )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-13\" title=\"13\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-14\" title=\"14\"\u003e        \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-15\" title=\"15\"\u003e      \u0026lt;/ul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-16\" title=\"16\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-17\" title=\"17\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb70-18\" title=\"18\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eReactコンポーネントを描画する関数の準備\u003c/p\u003e\r\n\u003cp\u003eimportを次のように変更する。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb71\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb71-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e ReactDOM \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e↓\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb72\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb72-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e render \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eViewを描画する関数を追加する。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb73\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb73-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb73-2\" title=\"2\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb73-3\" title=\"3\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eTodoApp store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb73-4\" title=\"4\"\u003e    \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb73-5\" title=\"5\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb73-6\" title=\"6\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eもともとあった描画の処理は削除する。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb74\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb74-1\" title=\"1\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eApp /\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb74-2\" title=\"2\"\u003e\u003cspan class=\"at\"\u003eregisterServiceWorker\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eViewに反映する関数の準備\u003c/p\u003e\r\n\u003cp\u003eStoreの状態変化に応じてViewを変化させる関数を定義します。 Storeの\u003ccode\u003esubscribe\u003c/code\u003eメソッドを使います。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb75\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb75-1\" title=\"1\"\u003e\u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003esubscribe\u003c/span\u003e(() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e上記処理の次に描画する関数の呼び出しを追加する。\u003cbr /\u003e\r\n初期表示用？\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb76\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb76-1\" title=\"1\"\u003e\u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003ch3 id=\"indexjsの全体\"\u003eindex.jsの全体\u003c/h3\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb77\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb77-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e render \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-5\" title=\"5\"\u003e\u003cspan class=\"co\"\u003e// Note: 使わないのでコメント化 \u0026gt;\u0026gt;\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-6\" title=\"6\"\u003e\u003cspan class=\"co\"\u003e// import \u0026#39;./index.css\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// import App from \u0026#39;./App\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-8\" title=\"8\"\u003e\u003cspan class=\"co\"\u003e// import registerServiceWorker from \u0026#39;./registerServiceWorker\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-9\" title=\"9\"\u003e\u003cspan class=\"co\"\u003e/// Note: \u0026lt;\u0026lt;\u0026lt; 使わないのでコメント化\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-10\" title=\"10\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-11\" title=\"11\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-12\" title=\"12\"\u003e  \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-13\" title=\"13\"\u003e  \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e []\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-14\" title=\"14\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-15\" title=\"15\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-16\" title=\"16\"\u003e\u003cspan class=\"co\"\u003e// Reducerの定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-17\" title=\"17\"\u003e\u003cspan class=\"co\"\u003e// 第1引数は、現在の状態を表すstateオブジェクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-18\" title=\"18\"\u003e\u003cspan class=\"co\"\u003e// 第2引数は、どのような操作をしたのかを示すActionオブジェクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-19\" title=\"19\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003etasksReducer\u003c/span\u003e(state \u003cspan class=\"op\"\u003e=\u003c/span\u003e initialState\u003cspan class=\"op\"\u003e,\u003c/span\u003e action) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-20\" title=\"20\"\u003e  \u003cspan class=\"cf\"\u003eswitch\u003c/span\u003e (\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"at\"\u003etype\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-21\" title=\"21\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;INPUT_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-22\" title=\"22\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-23\" title=\"23\"\u003e        ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-24\" title=\"24\"\u003e        \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-25\" title=\"25\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-26\" title=\"26\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;ADD_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-27\" title=\"27\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-28\" title=\"28\"\u003e        ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-29\" title=\"29\"\u003e        \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003econcat\u003c/span\u003e([\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e])\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-30\" title=\"30\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-31\" title=\"31\"\u003e    \u003cspan class=\"dt\"\u003edefault\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-32\" title=\"32\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e state\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-33\" title=\"33\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-34\" title=\"34\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-35\" title=\"35\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-36\" title=\"36\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-37\" title=\"37\"\u003e\u003cspan class=\"co\"\u003e// Storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-38\" title=\"38\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(tasksReducer)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-39\" title=\"39\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-40\" title=\"40\"\u003e\u003cspan class=\"co\"\u003e// ActionCreatorの定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-41\" title=\"41\"\u003e\u003cspan class=\"co\"\u003e// 追加するtaskを引数に取り、Actionオブジェクトを返す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-42\" title=\"42\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e addTask \u003cspan class=\"op\"\u003e=\u003c/span\u003e (task) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-43\" title=\"43\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;ADD_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-44\" title=\"44\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-45\" title=\"45\"\u003e    task\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-46\" title=\"46\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-47\" title=\"47\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-48\" title=\"48\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-49\" title=\"49\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-50\" title=\"50\"\u003e\u003cspan class=\"co\"\u003e// タスク入力用のActionCreator\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-51\" title=\"51\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e inputTask \u003cspan class=\"op\"\u003e=\u003c/span\u003e (task) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-52\" title=\"52\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;INPUT_TASK\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-53\" title=\"53\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-54\" title=\"54\"\u003e    task\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-55\" title=\"55\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-56\" title=\"56\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-57\" title=\"57\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-58\" title=\"58\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-59\" title=\"59\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eTodoApp\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e store \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-60\" title=\"60\"\u003e  \u003cspan class=\"kw\"\u003econst\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e task\u003cspan class=\"op\"\u003e,\u003c/span\u003e tasks \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003egetState\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-61\" title=\"61\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-62\" title=\"62\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-63\" title=\"63\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e onChange\u003cspan class=\"op\"\u003e={\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(\u003cspan class=\"va\"\u003ee\u003c/span\u003e.\u003cspan class=\"va\"\u003etarget\u003c/span\u003e.\u003cspan class=\"at\"\u003evalue\u003c/span\u003e))\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-64\" title=\"64\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e value\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;add\u0026quot;\u003c/span\u003e onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task))\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-65\" title=\"65\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-66\" title=\"66\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-67\" title=\"67\"\u003e          \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003emap\u003c/span\u003e(\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e(item\u003cspan class=\"op\"\u003e,\u003c/span\u003e i) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-68\" title=\"68\"\u003e            \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-69\" title=\"69\"\u003e              \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli key\u003cspan class=\"op\"\u003e={\u003c/span\u003ei\u003cspan class=\"op\"\u003e}\u0026gt;{\u003c/span\u003eitem\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-70\" title=\"70\"\u003e            )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-71\" title=\"71\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-72\" title=\"72\"\u003e        \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-73\" title=\"73\"\u003e      \u0026lt;/ul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-74\" title=\"74\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-75\" title=\"75\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-76\" title=\"76\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-77\" title=\"77\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-78\" title=\"78\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-79\" title=\"79\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-80\" title=\"80\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-81\" title=\"81\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eTodoApp store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-82\" title=\"82\"\u003e    \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-83\" title=\"83\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-84\" title=\"84\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-85\" title=\"85\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-86\" title=\"86\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-87\" title=\"87\"\u003e\u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003esubscribe\u003c/span\u003e(() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb77-88\" title=\"88\"\u003e\u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"ファイルを機能ごとに分割する\"\u003eファイルを機能ごとに分割する\u003c/h3\u003e\r\n\u003cp\u003eActionCreator、Store、Reducer、Componentの定義を、1ファイルにまとめて書きました。 これを役割ごとにファイルを分割したほうが視認性がよくなります。\u003c/p\u003e\r\n\u003cp\u003e次のフォルダ構造でファイルを分割します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003esrc/\r\n+---index.js\r\n+---containers/\r\n|     ... Container Component を置く\r\n+---components/\r\n|     ... Presentational Component を置く\r\n+---actions/\r\n|     ... ActionCreator を置く\r\n`---reducers/\r\n      ... Reducer を置く\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003eReducerの定義を\u003ccode\u003esrc/reducers/tasks.js\u003c/code\u003eに移動します。\u003c/p\u003e\r\n\u003cp\u003efunction には \u003ccode\u003eexport default\u003c/code\u003e を付けてください。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb79\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb79-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-2\" title=\"2\"\u003e  \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-3\" title=\"3\"\u003e  \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e []\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-4\" title=\"4\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-6\" title=\"6\"\u003e\u003cspan class=\"co\"\u003e// Reducerの定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// 第1引数は、現在の状態を表すstateオブジェクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-8\" title=\"8\"\u003e\u003cspan class=\"co\"\u003e// 第2引数は、どのような操作をしたのかを示すActionオブジェクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-9\" title=\"9\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003etasksReducer\u003c/span\u003e(state \u003cspan class=\"op\"\u003e=\u003c/span\u003e initialState\u003cspan class=\"op\"\u003e,\u003c/span\u003e action) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-10\" title=\"10\"\u003e  \u003cspan class=\"cf\"\u003eswitch\u003c/span\u003e (\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"at\"\u003etype\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-11\" title=\"11\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;INPUT_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-12\" title=\"12\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-13\" title=\"13\"\u003e        ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-14\" title=\"14\"\u003e        \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-15\" title=\"15\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-16\" title=\"16\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;ADD_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-17\" title=\"17\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-18\" title=\"18\"\u003e        ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-19\" title=\"19\"\u003e        \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003econcat\u003c/span\u003e([\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e])\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-20\" title=\"20\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-21\" title=\"21\"\u003e    \u003cspan class=\"dt\"\u003edefault\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-22\" title=\"22\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e state\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-23\" title=\"23\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb79-24\" title=\"24\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eActionCreatorの定義を \u003ccode\u003esrc/actions/tasks.js\u003c/code\u003e に移動します。\u003c/p\u003e\r\n\u003cp\u003econst に \u003ccode\u003eexport\u003c/code\u003e を付けてください。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb80\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb80-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// ActionCreatorの定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-2\" title=\"2\"\u003e\u003cspan class=\"co\"\u003e// 追加するtaskを引数に取り、Actionオブジェクトを返す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003econst\u003c/span\u003e addTask \u003cspan class=\"op\"\u003e=\u003c/span\u003e (task) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-4\" title=\"4\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;ADD_TASK\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-5\" title=\"5\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-6\" title=\"6\"\u003e    task\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-7\" title=\"7\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-9\" title=\"9\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-10\" title=\"10\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-11\" title=\"11\"\u003e\u003cspan class=\"co\"\u003e// タスク入力用のActionCreator\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-12\" title=\"12\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003econst\u003c/span\u003e inputTask \u003cspan class=\"op\"\u003e=\u003c/span\u003e (task) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-13\" title=\"13\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;INPUT_TASK\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-14\" title=\"14\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-15\" title=\"15\"\u003e    task\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-16\" title=\"16\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb80-17\" title=\"17\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eComponentの定義を \u003ccode\u003esrc/components/TodoApp.js\u003c/code\u003e に移動します。\u003c/p\u003e\r\n\u003cp\u003ecomponentsからActionをDispatchするため、先ほど移動したActionCreatorのファイルをインポートします。\u003c/p\u003e\r\n\u003cp\u003e（\u003ccode\u003eimport { inputTask, addTask } from '../actions/tasks';\u003c/code\u003e の部分）\u003c/p\u003e\r\n\u003cp\u003e関数には \u003ccode\u003eexport default\u003c/code\u003e を付けてください。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb81\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb81-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e inputTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e addTask \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../actions/tasks\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eTodoApp\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e store \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-5\" title=\"5\"\u003e  \u003cspan class=\"kw\"\u003econst\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e task\u003cspan class=\"op\"\u003e,\u003c/span\u003e tasks \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003egetState\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-6\" title=\"6\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-7\" title=\"7\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-8\" title=\"8\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e onChange\u003cspan class=\"op\"\u003e={\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(\u003cspan class=\"va\"\u003ee\u003c/span\u003e.\u003cspan class=\"va\"\u003etarget\u003c/span\u003e.\u003cspan class=\"at\"\u003evalue\u003c/span\u003e))\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-9\" title=\"9\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e value\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;add\u0026quot;\u003c/span\u003e onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task))\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-10\" title=\"10\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-11\" title=\"11\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-12\" title=\"12\"\u003e          \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003emap\u003c/span\u003e(\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e(item\u003cspan class=\"op\"\u003e,\u003c/span\u003e i) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-13\" title=\"13\"\u003e            \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-14\" title=\"14\"\u003e              \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli key\u003cspan class=\"op\"\u003e={\u003c/span\u003ei\u003cspan class=\"op\"\u003e}\u0026gt;{\u003c/span\u003eitem\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-15\" title=\"15\"\u003e            )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-16\" title=\"16\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-17\" title=\"17\"\u003e        \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-18\" title=\"18\"\u003e      \u0026lt;/ul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-19\" title=\"19\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-20\" title=\"20\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb81-21\" title=\"21\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e\u003ccode\u003esrc\\index.js\u003c/code\u003e は、分割したファイルをインポートするように変更します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb82\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb82-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e render \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e tasksReducer \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./reducers/tasks\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e    \u003cspan class=\"co\"\u003e// Reducerのインポート\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e TodoApp \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./components/TodoApp\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e     \u003cspan class=\"co\"\u003e// Componentのインポート\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// Note: 使わないのでコメント化 \u0026gt;\u0026gt;\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-8\" title=\"8\"\u003e\u003cspan class=\"co\"\u003e// import \u0026#39;./index.css\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-9\" title=\"9\"\u003e\u003cspan class=\"co\"\u003e// import App from \u0026#39;./App\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-10\" title=\"10\"\u003e\u003cspan class=\"co\"\u003e// import registerServiceWorker from \u0026#39;./registerServiceWorker\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-11\" title=\"11\"\u003e\u003cspan class=\"co\"\u003e/// Note: \u0026lt;\u0026lt;\u0026lt; 使わないのでコメント化\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-12\" title=\"12\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-13\" title=\"13\"\u003e\u003cspan class=\"co\"\u003e// Storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-14\" title=\"14\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(tasksReducer)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-15\" title=\"15\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-16\" title=\"16\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-17\" title=\"17\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-18\" title=\"18\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eTodoApp store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-19\" title=\"19\"\u003e    \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-20\" title=\"20\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-21\" title=\"21\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-22\" title=\"22\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-23\" title=\"23\"\u003e\u003cspan class=\"va\"\u003estore\u003c/span\u003e.\u003cspan class=\"at\"\u003esubscribe\u003c/span\u003e(() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb82-24\" title=\"24\"\u003e\u003cspan class=\"at\"\u003erenderApp\u003c/span\u003e(store)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003c!-- TODO: p.108 「最終的な」と書いておきつつ、サンプルコードに最後の2行がない。 --\u003e\r\n\r\n\u003ch3 id=\"react-redux\"\u003ereact-redux\u003c/h3\u003e\r\n\u003cp\u003e\u003ccode\u003ereact-redux\u003c/code\u003eは、ReactとReduxの連携をサポートするライブラリです。 Storeの状態変化に応じて該当部分のViewを再描画するのを手助けしてくれます。\u003c/p\u003e\r\n\u003ch3 id=\"react-reduxのインストール\"\u003ereact-reduxのインストール\u003c/h3\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save react-redux\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003c!-- TODO: p109 `-save`になっている。半角ハイフンがひとつ足りない。 --\u003e\r\n\r\n\u003cp\u003eReactはViewを扱うライブラリなので、Reduxが有するStoreやActionの情報と疎結合になっていることが望ましい。 そのほうがコンポーネント単体としてもテストしやすいし、コードの可読性も上がります。\u003c/p\u003e\r\n\u003cp\u003eContainer Component : Reactコンポーネントをラップしたコンポーネント。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eReduxのStoreやActionを受け取り、ReactのPropsとして渡す役を担います。\r\nContainer Componentの責務は、ReactとReduxの橋渡しのみなので、JSXを記述するのは誤りです。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ePresentational Component : Redux依存のない純粋なReactコンポーネント。\u003c/p\u003e\r\n\u003ch3 id=\"react-reduxの機能\"\u003ereact-reduxの機能\u003c/h3\u003e\r\n\u003cp\u003e次の2つの機能があります。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u0026lt;Provider\u0026gt;\u003c/li\u003e\r\n\u003cli\u003econnect\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch4 id=\"provider-store\"\u003e\u0026lt;Provider store\u0026gt;\u003c/h4\u003e\r\n\u003cp\u003edispatchはStoreが持つメソッドなので、ReactコンポーネントからActionをdispatchさせるにはStoreが必要になります。 dispatchしたいコンポーネントすべてに対し、Storeを最上位から渡していくのは得策ではありません。\u003c/p\u003e\r\n\u003cp\u003e\u0026lt;Provider\u0026gt;を使うことで\u003ccode\u003econnect\u003c/code\u003eという関数を使えるようになり、任意のコンポーネントに対してStoreとの紐付けができるようになります。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb85\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb85-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// 最上位のコンポーネントを\u0026lt;Provider\u0026gt;でラップして、propsにStoreを与える\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb85-2\" title=\"2\"\u003e\u003cspan class=\"co\"\u003e// （内部的にはReactのcontext経由でStoreを保持する仕組み）\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb85-3\" title=\"3\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb85-4\" title=\"4\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eProvider store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb85-5\" title=\"5\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eMyRootComponent /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb85-6\" title=\"6\"\u003e  \u0026lt;/Provider\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb85-7\" title=\"7\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb85-8\" title=\"8\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch4 id=\"connectmapstatetoprops-mapdispatchtoprops-mergeprops-options\"\u003econnect([mapStateToProps], [mapDispatchToProps], [mergeProps], [options])\u003c/h4\u003e\r\n\u003cp\u003e特定のComponentに対して、Reactのcontextで保持しているStoreを提供します。 Storeさえあれば\u003ccode\u003egetState\u003c/code\u003eで状態が取得できますし、Actionの\u003ccode\u003edispatch\u003c/code\u003eもできます。\u003c/p\u003e\r\n\u003cp\u003e引数\u003c/p\u003e\r\n\u003cp\u003emapStateToProps(state, [ownProps]) : Storeから必要なstateを取り出し、ComponentのPropsに割り当てる関数を指定します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e第1引数はStoreのstate。\r\n複数のReducerを組み合わせている場合は、必要な部分のstateのみ取り出して返すようにすれば、不要なコンポーネントを渡さずに済みます。\r\n\r\n第2引数はオプションで、親コンポーネントから引き継がれてきたPropsが格納されています（下記の例では未使用）。\r\n\r\n~~~javascript\r\nfunction mapStateToProps({ task, tasks }) {\r\n  return {\r\n    task,\r\n    tasks,\r\n  };\r\n}\r\n~~~\r\n\r\n戻り値のオブジェクトは、connect先のComponentのPropsとして受け取ることができます。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003emapDispatchToProps(dispatch, [ownProps]) : Actionのdispatchを行う処理を指定します。そうすることでコンポーネントからdispatchの概念を隠蔽します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e第1引数に、Storeのdispatchメソッドが渡されてくるので、これを使ってActionをdispatchします。\r\n\r\n~~~javascript\r\n// ActionCreator\r\nconst addTask = (task) =\u0026gt; ({\r\n  type: \u0026quot;ADD_TASK\u0026quot;,\r\n  payload: {\r\n    task\r\n  }\r\n});\r\n\r\nfunction mapDispatchToProps(dispatch) {\r\n  return {\r\n    addTask(task) {\r\n      dispatch(addTask(task));\r\n    }\r\n  };\r\n}\r\n~~~\r\n\r\n\u0026lt;!-- TODO: p.112 dispatch(addTask(task});　← } ではなく ) では？ --\u0026gt;\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003emergeProps(stateProps, dispatchProps, ownProps) : \u003ccode\u003emapStateToProps\u003c/code\u003eと\u003ccode\u003emapDispatchToProps\u003c/code\u003eを経たそれぞれのPropsと、親から渡ってきた\u003ccode\u003eownProps\u003c/code\u003eをマージして、コンポーネントに渡します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e既定では、以下のように、`Object.assign`関数を使って単純に3つをマージしたものを返す処理が設定されています。\r\n\r\n~~~javascript\r\nfunction mergeProps(stateProps, dispatchProps, ownProps) {\r\n  return Object.assign({}, ownProps, stateProps, dispatchProps);\r\n}\r\n~~~\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eoptions : オプションとして次の項目を設定できます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003epure - Boolean\r\n:   規定値はtrueです。trueの場合、関連するState/Propsに変化がなければ、connectは再描画および`mapStateToProps`/`mapDispatchToProps`/`mergeProp`を呼び出しません。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003c!-- TODO: p.114 mapStateToPrupsになっている。Propsでは？ --\u003e\r\n\r\n\u003cpre\u003e\u003ccode\u003eareStateEqual - Function\r\n:   `pure`がtrueの場合、Storeの中身の差分判定をどのようにするか指定します。\r\n    規定値は、strictEqual（===）です。\r\n\r\nareOwnPropsEqual - Function\r\n:   pureがtrueの場合、OwnPropの中身の差分判定をどのようにするか指定します。\r\n    規定値は、shallowEqual（==）です。\r\n\r\nareStatePropsEqual - Function\r\n:   pureがtrueの場合、mapStateToPropsの結果の差分判定をどのようにするか指定します。\r\n    規定値は、shallowEqual（==）です。\r\n\r\nareMergedPropsEqual - Function\r\n:   pureがtrueの場合、mergePropsの結果の差分判定をどのようにするか指定します。\r\n    規定値は、shallowEqual（==）です。\r\n\r\nstoreKey - String\r\n:   もし何らかの理由でStoreを複数用意したいときに指定します。\r\n\r\n    通常であれば不要。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"react-reduxの組み込み\"\u003ereact-reduxの組み込み\u003c/h3\u003e\r\n\u003ch4 id=\"container-componentの作成\"\u003eContainer Componentの作成\u003c/h4\u003e\r\n\u003cp\u003eファイル\u003ccode\u003esrc\\containers\\TodoApp.js\u003c/code\u003eを作ります。\u003c/p\u003e\r\n\u003cp\u003eこれにより TodoApp コンポーネントには Prop として次の4つが渡されるようになります。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003etask - フォームに入力されたタスク\u003c/li\u003e\r\n\u003cli\u003etasks - タスクの配列\u003c/li\u003e\r\n\u003cli\u003eaddTask - タスクを追加する関数\u003c/li\u003e\r\n\u003cli\u003einputTask - タスクを入力する関数\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb91\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb91-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e connect \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e TodoApp \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../components/TodoApp\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e inputTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e addTask \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../actions/tasks\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-5\" title=\"5\"\u003e\u003cspan class=\"co\"\u003e// Storeにある task と tasks という State を Props に渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-6\" title=\"6\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003emapStateToProps\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e task\u003cspan class=\"op\"\u003e,\u003c/span\u003e tasks \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-7\" title=\"7\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-8\" title=\"8\"\u003e    task\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-9\" title=\"9\"\u003e    tasks\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-10\" title=\"10\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-11\" title=\"11\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-12\" title=\"12\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-13\" title=\"13\"\u003e\u003cspan class=\"co\"\u003e// 該当のActionをDispatchさせる関数を Props に渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-14\" title=\"14\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003emapDispatchToProps\u003c/span\u003e(dispatch) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-15\" title=\"15\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-16\" title=\"16\"\u003e    \u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-17\" title=\"17\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-18\" title=\"18\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-19\" title=\"19\"\u003e    \u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(task) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-20\" title=\"20\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(task))\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-21\" title=\"21\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-22\" title=\"22\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-23\" title=\"23\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-24\" title=\"24\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb91-25\" title=\"25\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"at\"\u003econnect\u003c/span\u003e(mapStateToProps\u003cspan class=\"op\"\u003e,\u003c/span\u003e mapDispatchToProps)(TodoApp)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch4 id=\"todoappコンポーネントの修正\"\u003eTodoAppコンポーネントの修正\u003c/h4\u003e\r\n\u003cp\u003e\u003ccode\u003esrc/components/TodoApp.js\u003c/code\u003e\u003c/p\u003e\r\n\u003cp\u003e変更前 : StoreがPropsに渡ってきて、そこからStateを取得。\u003c/p\u003e\r\n\u003cp\u003e変更後 : containersから整形されたオブジェクトがPropsとして渡されてきます。 ActionCreatorやActionのDispatchもcontainers側でやるので、コンポーネント側はPropsで渡ってきたinputTaskとaddTaskを呼び出すだけになります。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eこれにより、コンポーネントのRedux依存が消え、再利用性も高まりました。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb93\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb93-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-2\" title=\"2\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-3\" title=\"3\"\u003e\u003cspan class=\"co\"\u003e// 引数を store から変更\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eTodoApp\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e task\u003cspan class=\"op\"\u003e,\u003c/span\u003e tasks\u003cspan class=\"op\"\u003e,\u003c/span\u003e inputTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e addTask \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-5\" title=\"5\"\u003e  \u003cspan class=\"co\"\u003e// onChange、onClickの指定時にdispatchが不要になる\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-6\" title=\"6\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-7\" title=\"7\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-8\" title=\"8\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e onChange\u003cspan class=\"op\"\u003e={\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(\u003cspan class=\"va\"\u003ee\u003c/span\u003e.\u003cspan class=\"va\"\u003etarget\u003c/span\u003e.\u003cspan class=\"at\"\u003evalue\u003c/span\u003e)\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-9\" title=\"9\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e value\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;add\u0026quot;\u003c/span\u003e onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task)\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-10\" title=\"10\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-11\" title=\"11\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-12\" title=\"12\"\u003e          \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003emap\u003c/span\u003e(\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e(item\u003cspan class=\"op\"\u003e,\u003c/span\u003e i) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-13\" title=\"13\"\u003e            \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-14\" title=\"14\"\u003e              \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli key\u003cspan class=\"op\"\u003e={\u003c/span\u003ei\u003cspan class=\"op\"\u003e}\u0026gt;{\u003c/span\u003eitem\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-15\" title=\"15\"\u003e            )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-16\" title=\"16\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-17\" title=\"17\"\u003e        \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-18\" title=\"18\"\u003e      \u0026lt;/ul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-19\" title=\"19\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-20\" title=\"20\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb93-21\" title=\"21\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch4 id=\"indexjsの修正\"\u003eindex.jsの修正\u003c/h4\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eProviderのimportを追加\u003c/li\u003e\r\n\u003cli\u003eTodoAppのimportをcomponentsではなくcontainersにする\u003c/li\u003e\r\n\u003cli\u003eStoreのsubscribeでコンポーネントの再描画を行っていた処理を削除する\u003c/li\u003e\r\n\u003cli\u003efunction renderApp の処理を外に出す（render()をfunctionではなくする）\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb94\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb94-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Provider \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e render \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e tasksReducer \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./reducers/tasks\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-6\" title=\"6\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e TodoApp \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./containers/TodoApp\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-7\" title=\"7\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-8\" title=\"8\"\u003e\u003cspan class=\"co\"\u003e// Note: 使わないのでコメント化 \u0026gt;\u0026gt;\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-9\" title=\"9\"\u003e\u003cspan class=\"co\"\u003e// import \u0026#39;./index.css\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-10\" title=\"10\"\u003e\u003cspan class=\"co\"\u003e// import App from \u0026#39;./App\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-11\" title=\"11\"\u003e\u003cspan class=\"co\"\u003e// import registerServiceWorker from \u0026#39;./registerServiceWorker\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-12\" title=\"12\"\u003e\u003cspan class=\"co\"\u003e/// Note: \u0026lt;\u0026lt;\u0026lt; 使わないのでコメント化\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-13\" title=\"13\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-14\" title=\"14\"\u003e\u003cspan class=\"co\"\u003e// Storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-15\" title=\"15\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(tasksReducer)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-16\" title=\"16\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-17\" title=\"17\"\u003e\u003cspan class=\"co\"\u003e// \u0026lt;Provider\u0026gt;を追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-18\" title=\"18\"\u003e\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-19\" title=\"19\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eProvider store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-20\" title=\"20\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eTodoApp /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-21\" title=\"21\"\u003e  \u0026lt;/Provider\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-22\" title=\"22\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb94-23\" title=\"23\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch4 id=\"connectadvanced\"\u003econnectAdvanced\u003c/h4\u003e\r\n\u003cp\u003e通常の\u003ccode\u003econnect\u003c/code\u003eよりも自由度を高くpropsの受け渡しをしたい場合、\u003ccode\u003econnectAdvanced\u003c/code\u003eを使うことができます。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003emapStateToProps\u003c/code\u003eや\u003ccode\u003emapDispatchToProps\u003c/code\u003e、\u003ccode\u003emergeProps\u003c/code\u003eのあたりの処理を自前で行うイメージです。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb95\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb95-1\" title=\"1\"\u003e\u003cspan class=\"at\"\u003econnectAdvanced\u003c/span\u003e(selectorFactory\u003cspan class=\"op\"\u003e,\u003c/span\u003e [connectOptions])\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eこれらについては必要なときに調べるとしましょう。\u003c/p\u003e\r\n\u003ch2 id=\"ルーティング\"\u003eルーティング\u003c/h2\u003e\r\n\u003cp\u003eユーザーからの入力をもとに表示させるページを出し分けることをルーティングといいます。\u003c/p\u003e\r\n\u003cp\u003e実装の方法は、どのページにいるのかという情報（URL）をStoreで保持し、変化があった場合にViewを差し替えるようにします。\u003c/p\u003e\r\n\u003ch3 id=\"実装パターン\"\u003e実装パターン\u003c/h3\u003e\r\n\u003cp\u003eURL遷移なし : URLを使わずにアプリの内部で状態を保持する方法。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eたとえば、Storeにpageというプロパティを用意し、ここでいまどのページにいるのかを管理します。\r\nですが、画面のリロードによって状態が元に戻ってしまうため現実的ではありません。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eURL Hash : URL Hash（\u003ccode\u003e#\u003c/code\u003e)を使ってクライアントサイドのルーティングを実現する方法です。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eaタグによるページ内移動と同じ仕組みなので、サーバーにリクエストは投げられません。\r\n\r\nHashは`location.hash`で取得できます。\r\nhashが変更されたときに発火する`hashchange`イベントをハンドリングしてコンポーネントを描画します。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ehistory API : ブラウザの履歴情報を操作するAPI（history API）を使った方法です。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e- `pushState`で履歴を追加できます。このとき、サーバーにリクエストは飛びません。\r\n- 画面をリロードされたときは、その時点のURLにリクエストが投げられます。そのため、URLに該当するリソースがないと404エラーになってしまいます。\r\n- 404エラーに対応するため、サーバーサイトで常にSPAの基点となるべきテンプレートを返すようにします。\r\n- `webpack-dev-server`を使っているときは、History API Fallback機能を使うとWebサーバーが返すリソースがない場合、自動で index.html を返してくれます。\r\n- Reduxのconnectを使っている場合は`connect-history-api-fallback`というミドルウェアを使います。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"ルーティングライブラリ\"\u003eルーティングライブラリ\u003c/h3\u003e\r\n\u003cp\u003eReact Router V4 : メジャーなルーティングライブラリ。react-nativeを使ったアプリ開発でも使うことができます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eWebアプリでは`react-router-dom`パッケージを使います。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch4 id=\"インストール\"\u003eインストール\u003c/h4\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save react-router-dom\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003ereact-router-redux : react-routerをReduxに最適化したもの。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e- react-routerのみでは、URLの変更を`\u0026lt;Link\u0026gt;`や`\u0026lt;Redirect\u0026gt;`経由でしかできません。\r\n- react-router-reduxでは、ルーティング情報をStoreのStateで管理しつつ、pushやreplaceといったAPIを使ってURLを変更できます。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch4 id=\"インストール-1\"\u003eインストール\u003c/h4\u003e\r\n\u003cp\u003ereact-routerも動作に必要です。react-router-domパッケージも一緒にインストールします。\u003c/p\u003e\r\n\u003cp\u003eNote: : react-router 4.x を使う場合、react-router-redux 5.x が必要です。 react-router-reduxに〝@next〟をつけてインストールします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e[react-router-redux - Installation](https://github.com/ReactTraining/react-router/tree/master/packages/react-router-redux#installation) より。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save react-router-dom react-router-redux@next history\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch4 id=\"特徴\"\u003e特徴\u003c/h4\u003e\r\n\u003cul\u003e\r\n\u003cli\u003ereact-routerのAPIはそのまま利用できます。\u003c/li\u003e\r\n\u003cli\u003ereact-router-reduxがやっていることは、historyオブジェクトを強化し、その変更をStoreのStateに常に同期することです。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch4 id=\"導入方法\"\u003e導入方法\u003c/h4\u003e\r\n\u003cp\u003eStoreの生成処理が複雑なので別ファイルとして切り出します。 その中にStoreを生成する関数を定義します。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003esrc/store/index.js\u003c/code\u003eというファイルを作成します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb104\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb104-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-2\" title=\"2\"\u003e  \u003cspan class=\"co\"\u003e// 名前が被るので別名でインポートする\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-3\" title=\"3\"\u003e  createStore \u003cspan class=\"im\"\u003eas\u003c/span\u003e reduxCreateStore\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-4\" title=\"4\"\u003e  combineReducers\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-5\" title=\"5\"\u003e  applyMiddleware\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-6\" title=\"6\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-7\" title=\"7\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e routerReducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e routerMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-8\" title=\"8\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e tasksReducer \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../reducers/tasks\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-9\" title=\"9\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-10\" title=\"10\"\u003e\u003cspan class=\"co\"\u003e// Storeを生成するための関数を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-11\" title=\"11\"\u003e\u003cspan class=\"co\"\u003e// historyはsrc/index.jsからもらう\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-12\" title=\"12\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(history) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-13\" title=\"13\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"at\"\u003ereduxCreateStore\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-14\" title=\"14\"\u003e    \u003cspan class=\"at\"\u003ecombineReducers\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-15\" title=\"15\"\u003e      \u003cspan class=\"co\"\u003e// tasksReducersをtasksというキーに割り当てる\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-16\" title=\"16\"\u003e      \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e tasksReducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-17\" title=\"17\"\u003e      \u003cspan class=\"co\"\u003e// react-router-reduxのReducer\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-18\" title=\"18\"\u003e      \u003cspan class=\"dt\"\u003erouter\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e routerReducer\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-19\" title=\"19\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-20\" title=\"20\"\u003e    \u003cspan class=\"at\"\u003eapplyMiddleware\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-21\" title=\"21\"\u003e      \u003cspan class=\"co\"\u003e// react-router-reduxのRedux Middleware\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-22\" title=\"22\"\u003e      \u003cspan class=\"at\"\u003erouterMiddleware\u003c/span\u003e(history)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-23\" title=\"23\"\u003e    )\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-24\" title=\"24\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb104-25\" title=\"25\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cul\u003e\r\n\u003cli\u003ereact-router-reduxは\u003ccode\u003erouterReducer\u003c/code\u003eというルーティングのためのReducerを持っています。\u003c/li\u003e\r\n\u003cli\u003e自前のReducerと一緒に使うために、combineReducerを使ってReducerを合成します。\u003c/li\u003e\r\n\u003cli\u003ereact-router-reduxはルーティングのための\u003ccode\u003erouterMiddleware\u003c/code\u003eというMiddlewareも提供しています。 このMiddlewareにより、ReduxのAction経由でルーティングを制御できるようになります。\u003c/li\u003e\r\n\u003cli\u003e\u003ccode\u003eapplyMiddleware\u003c/code\u003eを使って、\u003ccode\u003erouterMiddleware\u003c/code\u003eを適用します。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003eStoreの生成\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003esrc/index.js\u003c/code\u003eを変更します。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003ccode\u003eimport { createStore } from 'redux';\u003c/code\u003eを消す。\u003c/li\u003e\r\n\u003cli\u003e\u003ccode\u003eimport tasksReducer from './reducers/tasks';\u003c/code\u003e を消す。\u003c/li\u003e\r\n\u003cli\u003e\u003ccode\u003ereact-router-redux\u003c/code\u003eと\u003ccode\u003ehistory\u003c/code\u003e、\u003ccode\u003esrc/store/index.js\u003c/code\u003eのインポートを追加。\u003c/li\u003e\r\n\u003cli\u003ehistoryのインスタンス生成を追加。\u003c/li\u003e\r\n\u003cli\u003e\u0026lt;ConnectedRouter\u0026gt;にhistoryを渡す処理を追加。\u003c/li\u003e\r\n\u003cli\u003ecreateStoreの引数を\u003ccode\u003etasksReducer\u003c/code\u003eから\u003ccode\u003ehistory\u003c/code\u003eに変更。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb105\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb105-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Provider \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e render \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e ConnectedRouter \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e             \u003cspan class=\"co\"\u003e// 追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e createBrowserHistory \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;history/createBrowserHistory\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e  \u003cspan class=\"co\"\u003e// 追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-6\" title=\"6\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e TodoApp \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./containers/TodoApp\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-7\" title=\"7\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e createStore \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./store\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e                                \u003cspan class=\"co\"\u003e// 追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-8\" title=\"8\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-9\" title=\"9\"\u003e\u003cspan class=\"co\"\u003e// Note: 使わないのでコメント化 \u0026gt;\u0026gt;\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-10\" title=\"10\"\u003e\u003cspan class=\"co\"\u003e// import \u0026#39;./index.css\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-11\" title=\"11\"\u003e\u003cspan class=\"co\"\u003e// import App from \u0026#39;./App\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-12\" title=\"12\"\u003e\u003cspan class=\"co\"\u003e// import registerServiceWorker from \u0026#39;./registerServiceWorker\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-13\" title=\"13\"\u003e\u003cspan class=\"co\"\u003e/// Note: \u0026lt;\u0026lt;\u0026lt; 使わないのでコメント化\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-14\" title=\"14\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-15\" title=\"15\"\u003e\u003cspan class=\"co\"\u003e// history のインスタンスを生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-16\" title=\"16\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e history \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateBrowserHistory\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-17\" title=\"17\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-18\" title=\"18\"\u003e\u003cspan class=\"co\"\u003e// Storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-19\" title=\"19\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(history)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-20\" title=\"20\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-21\" title=\"21\"\u003e\u003cspan class=\"co\"\u003e// \u0026lt;ConnectedRouter\u0026gt;を追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-22\" title=\"22\"\u003e\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-23\" title=\"23\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eProvider store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-24\" title=\"24\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eConnectedRouter history\u003cspan class=\"op\"\u003e={\u003c/span\u003ehistory\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-25\" title=\"25\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eTodoApp /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-26\" title=\"26\"\u003e    \u0026lt;/ConnectedRouter\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-27\" title=\"27\"\u003e  \u0026lt;/Provider\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-28\" title=\"28\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb105-29\" title=\"29\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003esrc/store/index.js\u003c/code\u003eでReducerの合成をしたため、Reducerの構成が変更になっています。\u003c/p\u003e\r\n\u003cp\u003eStoreの構成\u003c/p\u003e\r\n\u003cp\u003e↓\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb106\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb106-1\" title=\"1\"\u003e\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-2\" title=\"2\"\u003e  \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-3\" title=\"3\"\u003e    \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-4\" title=\"4\"\u003e    \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e []\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-5\" title=\"5\"\u003e  \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-6\" title=\"6\"\u003e  \u003cspan class=\"dt\"\u003erouter\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-7\" title=\"7\"\u003e    \u003cspan class=\"dt\"\u003elocation\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-8\" title=\"8\"\u003e      \u003cspan class=\"co\"\u003e// ルーティング情報\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-9\" title=\"9\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-10\" title=\"10\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb106-11\" title=\"11\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eそのため、\u003ccode\u003esrc/containers/TodoApp.js\u003c/code\u003eの\u003ccode\u003emapStateToProps\u003c/code\u003eも変更する必要があります。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb107\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb107-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003emapStateToProps\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e tasks \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb107-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb107-3\" title=\"3\"\u003e    \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb107-4\" title=\"4\"\u003e    \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003etasks\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb107-5\" title=\"5\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb107-6\" title=\"6\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch4 id=\"action経由によるルーティング\"\u003eAction経由によるルーティング\u003c/h4\u003e\r\n\u003cp\u003e\u003ccode\u003erouterMiddleware\u003c/code\u003eを適用することで、Action経由でルーティングをすることができます。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003ereact-router-redux\u003c/code\u003eが用意している次のようなActionCreatorを用いたルーティングができるようになります。\u003c/p\u003e\r\n\u003cp\u003epush : 履歴に新しいlocationを追加します。\u003c/p\u003e\r\n\u003cp\u003ereplace : 現在の履歴を新しいlocationに置き換えます。\u003c/p\u003e\r\n\u003cp\u003ego : 相対値（1 や -2 など）を指定して、履歴を移動します。\u003c/p\u003e\r\n\u003cp\u003egoForward : 履歴を1つ進めます。\u003c/p\u003e\r\n\u003cp\u003egoBack : 履歴を1つ戻ります。\u003c/p\u003e\r\n\u003ch4 id=\"ボタンを押すとエラーページに移動するサンプル\"\u003eボタンを押すとエラーページに移動するサンプル\u003c/h4\u003e\r\n\u003cp\u003e\u003ccode\u003esrc/components/Error.js\u003c/code\u003eファイルを作成します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb108\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb108-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Link \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eError\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-5\" title=\"5\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-6\" title=\"6\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-7\" title=\"7\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eh1\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eエラーページ\u0026lt;/h1\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-8\" title=\"8\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eLink to\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e戻る\u0026lt;/Link\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-9\" title=\"9\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-10\" title=\"10\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb108-11\" title=\"11\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003esrc/index.js\u003c/code\u003eを変更して、エラーページに移動できるようにします。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb109\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb109-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e render \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Route \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e     \u003cspan class=\"co\"\u003e// 追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Provider \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e ConnectedRouter \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-6\" title=\"6\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e createBrowserHistory \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;history/createBrowserHistory\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-7\" title=\"7\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e TodoApp \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./containers/TodoApp\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-8\" title=\"8\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Error \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./components/Error\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e       \u003cspan class=\"co\"\u003e// 追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-9\" title=\"9\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e createStore \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./store\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-10\" title=\"10\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-11\" title=\"11\"\u003e\u003cspan class=\"co\"\u003e// Note: 使わないのでコメント化 \u0026gt;\u0026gt;\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-12\" title=\"12\"\u003e\u003cspan class=\"co\"\u003e// import \u0026#39;./index.css\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-13\" title=\"13\"\u003e\u003cspan class=\"co\"\u003e// import App from \u0026#39;./App\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-14\" title=\"14\"\u003e\u003cspan class=\"co\"\u003e// import registerServiceWorker from \u0026#39;./registerServiceWorker\u0026#39;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-15\" title=\"15\"\u003e\u003cspan class=\"co\"\u003e/// Note: \u0026lt;\u0026lt;\u0026lt; 使わないのでコメント化\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-16\" title=\"16\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-17\" title=\"17\"\u003e\u003cspan class=\"co\"\u003e// history のインスタンスを生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-18\" title=\"18\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e history \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateBrowserHistory\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-19\" title=\"19\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-20\" title=\"20\"\u003e\u003cspan class=\"co\"\u003e// Storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-21\" title=\"21\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(history)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-22\" title=\"22\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-23\" title=\"23\"\u003e\u003cspan class=\"co\"\u003e// \u0026lt;ConnectedRouter\u0026gt;を追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-24\" title=\"24\"\u003e\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-25\" title=\"25\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eProvider store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-26\" title=\"26\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eConnectedRouter history\u003cspan class=\"op\"\u003e={\u003c/span\u003ehistory\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-27\" title=\"27\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-28\" title=\"28\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"co\"\u003e/* ルーティングさせる */\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-29\" title=\"29\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute exact path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e component\u003cspan class=\"op\"\u003e={\u003c/span\u003eTodoApp\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-30\" title=\"30\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute exact path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/error\u0026quot;\u003c/span\u003e component\u003cspan class=\"op\"\u003e={\u003c/span\u003eError\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-31\" title=\"31\"\u003e      \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-32\" title=\"32\"\u003e    \u0026lt;/ConnectedRouter\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-33\" title=\"33\"\u003e  \u0026lt;/Provider\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-34\" title=\"34\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb109-35\" title=\"35\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003ereact-router-dom\u003c/code\u003eのRouteコンポーネントを使ってルーティングを用意しています。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003e/\u003c/code\u003e であれば、Todoアプリを表示。 \u003ccode\u003e/error\u003c/code\u003eであれば、エラーページを表示。\u003c/p\u003e\r\n\u003cp\u003e\u003ccode\u003esrc/containers/TodoApp.js\u003c/code\u003eにエラーページにリダイレクトさせる処理を追加します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb110\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb110-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e connect \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e push \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e    \u003cspan class=\"co\"\u003e// 追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e TodoApp \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../components/TodoApp\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e inputTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e addTask \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../actions/tasks\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-6\" title=\"6\"\u003e\u003cspan class=\"co\"\u003e// Storeにある task と tasks という State を Props に渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-7\" title=\"7\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003emapStateToProps\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e tasks \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-8\" title=\"8\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-9\" title=\"9\"\u003e    \u003cspan class=\"dt\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003etask\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-10\" title=\"10\"\u003e    \u003cspan class=\"dt\"\u003etasks\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003etasks\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-11\" title=\"11\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-12\" title=\"12\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-13\" title=\"13\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-14\" title=\"14\"\u003e\u003cspan class=\"co\"\u003e// 該当のActionをDispatchさせる関数を Props に渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-15\" title=\"15\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003emapDispatchToProps\u003c/span\u003e(dispatch) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-16\" title=\"16\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-17\" title=\"17\"\u003e    \u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-18\" title=\"18\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-19\" title=\"19\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-20\" title=\"20\"\u003e    \u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(task) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-21\" title=\"21\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(task))\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-22\" title=\"22\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-23\" title=\"23\"\u003e    \u003cspan class=\"co\"\u003e// リダイレクト処理を追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-24\" title=\"24\"\u003e    \u003cspan class=\"co\"\u003e// react-router-reduxが提供しているpushというActionCreatorを使う\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-25\" title=\"25\"\u003e    \u003cspan class=\"at\"\u003eredirectToError\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-26\" title=\"26\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003epush\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;/error\u0026#39;\u003c/span\u003e))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-27\" title=\"27\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-28\" title=\"28\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-29\" title=\"29\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-30\" title=\"30\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb110-31\" title=\"31\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"at\"\u003econnect\u003c/span\u003e(mapStateToProps\u003cspan class=\"op\"\u003e,\u003c/span\u003e mapDispatchToProps)(TodoApp)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eリダイレクトする処理を呼び出せるように、\u003ccode\u003esrc/components/TodoApp.js\u003c/code\u003eを変更します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb111\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb111-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-2\" title=\"2\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-3\" title=\"3\"\u003e\u003cspan class=\"co\"\u003e// 引数に redirectToError を追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eTodoApp\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e task\u003cspan class=\"op\"\u003e,\u003c/span\u003e tasks\u003cspan class=\"op\"\u003e,\u003c/span\u003e inputTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e addTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e redirectToError \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-5\" title=\"5\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-6\" title=\"6\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-7\" title=\"7\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e onChange\u003cspan class=\"op\"\u003e={\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(\u003cspan class=\"va\"\u003ee\u003c/span\u003e.\u003cspan class=\"va\"\u003etarget\u003c/span\u003e.\u003cspan class=\"at\"\u003evalue\u003c/span\u003e)\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-8\" title=\"8\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e value\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;add\u0026quot;\u003c/span\u003e onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task)\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-9\" title=\"9\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-10\" title=\"10\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-11\" title=\"11\"\u003e          \u003cspan class=\"va\"\u003etasks\u003c/span\u003e.\u003cspan class=\"at\"\u003emap\u003c/span\u003e(\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e(item\u003cspan class=\"op\"\u003e,\u003c/span\u003e i) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-12\" title=\"12\"\u003e            \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-13\" title=\"13\"\u003e              \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli key\u003cspan class=\"op\"\u003e={\u003c/span\u003ei\u003cspan class=\"op\"\u003e}\u0026gt;{\u003c/span\u003eitem\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-14\" title=\"14\"\u003e            )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-15\" title=\"15\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-16\" title=\"16\"\u003e        \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-17\" title=\"17\"\u003e      \u0026lt;/ul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-18\" title=\"18\"\u003e      \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"co\"\u003e/* 追加 */\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-19\" title=\"19\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ebutton onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003eredirectToError\u003c/span\u003e()\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003eエラーページへ移動\u0026lt;/button\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-20\" title=\"20\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-21\" title=\"21\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb111-22\" title=\"22\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch2 id=\"redux-middleware\"\u003eRedux Middleware\u003c/h2\u003e\r\n\u003cp\u003eRedux Middleware とは、Reduxの機能を拡張する仕組みです。\u003c/p\u003e\r\n\u003cp\u003eMiddleware ＝ 拡張機能\u003c/p\u003e\r\n\u003cp\u003eRedux自体は軽量なアーキテクチャなので、単体では提供していない機能もある。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eActionのログを取るミドルウェア\u003c/li\u003e\r\n\u003cli\u003e非同期処理を可能にするミドルウェア\u003c/li\u003e\r\n\u003cli\u003eクラッシュレポートを送信するためのミドルウェア\u003c/li\u003e\r\n\u003cli\u003eルーティングのためのミドルウェア\u003c/li\u003e\r\n\u003cli\u003eetc...\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch3 id=\"actionのログを取るミドルウェア\"\u003eActionのログを取るミドルウェア\u003c/h3\u003e\r\n\u003cp\u003e\u003ccode\u003eredux-logger\u003c/code\u003eはActionがDispatchされる前後のstateと、DispatchされたActionをコンソールに表示します。 開発時に有用なミドルウェアなのでインストールしたほうがよいでしょう。\u003c/p\u003e\r\n\u003ch4 id=\"インストール-2\"\u003eインストール\u003c/h4\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save redux-logger\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003c!-- TODO: p.143 install が insta'l になっている --\u003e\r\n\r\n\u003ch4 id=\"ミドルウェアの適用\"\u003eミドルウェアの適用\u003c/h4\u003e\r\n\u003cp\u003eReduxにミドルウェアを適用するには、\u003ccode\u003eapplyMiddleware\u003c/code\u003e関数を利用します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb113\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb113-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// ミドルウェアの適用に必要な applyMiddleware 関数をインポートします\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore\u003cspan class=\"op\"\u003e,\u003c/span\u003e applyMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-4\" title=\"4\"\u003e\u003cspan class=\"co\"\u003e// ミドルウェアをインポートします\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e logger \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux-logger\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// createStoreの第2引数に applyMiddleware を指定し、その引数にミドルウェアを指定します\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-8\" title=\"8\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-9\" title=\"9\"\u003e  reducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-10\" title=\"10\"\u003e  \u003cspan class=\"at\"\u003eapplyMiddleware\u003c/span\u003e(logger)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb113-11\" title=\"11\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e\u003ccode\u003eapplyMiddleware\u003c/code\u003eの引数は可変数なので、複数のミドルウェアを指定するときは、以下のようにカンマ区切りで並べて指定します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb114\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb114-1\" title=\"1\"\u003e\u003cspan class=\"at\"\u003eapplyMiddleware\u003c/span\u003e(middleware1\u003cspan class=\"op\"\u003e,\u003c/span\u003e middleware2\u003cspan class=\"op\"\u003e,\u003c/span\u003e middleware3)\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch2 id=\"非同期処理\"\u003e非同期処理\u003c/h2\u003e\r\n\u003ch3 id=\"同期処理と非同期処理\"\u003e同期処理と非同期処理\u003c/h3\u003e\r\n\u003cp\u003e同期処理 : 書いた順に実行される処理\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e~~~Javascript\r\nconsole.log(\u0026quot;start\u0026quot;);\r\nconsole.log(1 + 1);\r\nconsole.log(\u0026quot;end\u0026quot;);\r\n~~~\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e非同期処理 : 必ずしも書いた順には実行されない処理\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e~~~javascript\r\nconsole.log(\u0026quot;start\u0026quot;);\r\nsetTimeout(function () {\r\n  console.log(1 + 1);\r\n}, 1000);\r\nconsole.log(\u0026quot;end\u0026quot;);\r\n~~~\r\n\r\n非同期処理のあとに任意の処理を実行する方法として、コールバック関数やPromise、Async/Awaitなどがあります。\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"redux-thunkによる非同期処理\"\u003eredux-thunkによる非同期処理\u003c/h3\u003e\r\n\u003cp\u003eReduxではAPIから何かレスポンスが返ってきたら、これをActionとして扱うという作法があります。 これを通常のActionCreatorで記述しようとすると、実はうまく書けません。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb117\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb117-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e requestAPI \u003cspan class=\"op\"\u003e=\u003c/span\u003e (parameter) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-2\" title=\"2\"\u003e  \u003cspan class=\"kw\"\u003econst\u003c/span\u003e response \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-3\" title=\"3\"\u003e    \u003cspan class=\"at\"\u003efetch\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;APIのURL\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e parameter).\u003cspan class=\"at\"\u003ethen\u003c/span\u003e((response) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-4\" title=\"4\"\u003e      \u003cspan class=\"co\"\u003e// ここで返してもうまく動かない\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-5\" title=\"5\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-6\" title=\"6\"\u003e        \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;REQUEST_API\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-7\" title=\"7\"\u003e        \u003cspan class=\"dt\"\u003edata\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e response\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-8\" title=\"8\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-9\" title=\"9\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb117-10\" title=\"10\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eAction自体は単なるオブジェクトです。これをstore.dispatch()に与えることでActionが実行されます。 どうにかしてdispatch関数をコード中で使いたい。というときにこのミドルウェアの出番です。\u003c/p\u003e\r\n\u003ch3 id=\"thunk-ミドルウェア\"\u003ethunk ミドルウェア\u003c/h3\u003e\r\n\u003cp\u003eReduxで非同期処理をする代表的なミドルウェア。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save redux-thunk\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eインストールできたらミドルウェアを適用します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb119\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb119-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore\u003cspan class=\"op\"\u003e,\u003c/span\u003e applyMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e logger \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux-logger\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e thunk \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux-thunk\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e reducers \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./reducers\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-6\" title=\"6\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e middlewares \u003cspan class=\"op\"\u003e=\u003c/span\u003e [logger\u003cspan class=\"op\"\u003e,\u003c/span\u003e thunk]\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-7\" title=\"7\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-8\" title=\"8\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-9\" title=\"9\"\u003e  reducers\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-10\" title=\"10\"\u003e  \u003cspan class=\"at\"\u003eapplyMiddleware\u003c/span\u003e(...\u003cspan class=\"at\"\u003emiddlewares\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-11\" title=\"11\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-12\" title=\"12\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb119-13\" title=\"13\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e store\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"非同期アクション\"\u003e非同期アクション\u003c/h3\u003e\r\n\u003cp\u003ethunkミドルウェアの適用により、非同期で実行されるActionを書けるようになりました。\u003c/p\u003e\r\n\u003cp\u003e次のコードサンプルで使っているshortidパッケージはユニークなIDを自動で生成してくれるものです。 インストールは \u003ccode\u003enpm install --save shortid\u003c/code\u003e でできます。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb120\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb120-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e shortid \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;shortid\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-2\" title=\"2\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e*\u003c/span\u003e \u003cspan class=\"im\"\u003eas\u003c/span\u003e types \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../types/todo\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-5\" title=\"5\"\u003e\u003cspan class=\"co\"\u003e// 同期 ActionCreator\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-6\" title=\"6\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eaddTodo\u003c/span\u003e(title) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-7\" title=\"7\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-8\" title=\"8\"\u003e    \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003etypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eADD_TODO\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-9\" title=\"9\"\u003e    \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-10\" title=\"10\"\u003e      \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eshortid\u003c/span\u003e.\u003cspan class=\"at\"\u003egenerate\u003c/span\u003e()\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-11\" title=\"11\"\u003e      title\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-12\" title=\"12\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-13\" title=\"13\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-14\" title=\"14\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-15\" title=\"15\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-16\" title=\"16\"\u003e\u003cspan class=\"co\"\u003e// 非同期 ActionCreator\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-17\" title=\"17\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003easyncAddTodo\u003c/span\u003e(title) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-18\" title=\"18\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (dispatch\u003cspan class=\"op\"\u003e,\u003c/span\u003e getState) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-19\" title=\"19\"\u003e    \u003cspan class=\"at\"\u003esetTimeout\u003c/span\u003e(() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-20\" title=\"20\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTodo\u003c/span\u003e(title))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-21\" title=\"21\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e \u003cspan class=\"dv\"\u003e1000\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-22\" title=\"22\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb120-23\" title=\"23\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e同期 ActionCreator はActionオブジェクトを返しています。\u003c/p\u003e\r\n\u003cp\u003e非同期 ActionCreator は関数を返しています。 thunkミドルウェアにより、通常のActionオブジェクト以外に関数を返せるようになります。 ここで返した関数は、引数としてdispatch関数とgetState関数を取ります。\u003c/p\u003e\r\n\u003cp\u003edispatch関数はActionオブジェクトを受け取りさえすれば、同期的にreducerに処理を移します。\u003c/p\u003e\r\n\u003cp\u003edispatch関数にさらに関数を渡すこともできます。このときも関数の引数としてdispatch関数とgetState関数を取ります。\u003c/p\u003e\r\n\u003cp\u003eポイント : Reduxアプリでは、最終的にdispatch関数にActionオブジェクトを渡せばreducerに処理が移るという原則がある。\u003c/p\u003e\r\n\u003ch3 id=\"thunk-と-promiseasyncawait\"\u003ethunk と Promise、Async/Await\u003c/h3\u003e\r\n\u003cp\u003ePromise :\u003cbr /\u003e\r\n~~~javascript const sleep1000ms = () =\u0026gt; { return new Promise(resolve =\u0026gt; { setTimeout(() =\u0026gt; { resolve(); }, 1000); }); };\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eexport function addTodo(title) {\r\n  return {\r\n    type: types.ADD_TODO,\r\n    payload: {\r\n      id: shortid.generate(),\r\n      title,\r\n    },\r\n  };\r\n}\r\n\r\n// Promise 版\r\nexport function asyncAddTodo(title) {\r\n  return (dispatch) =\u0026gt; {\r\n    sleep1000ms().then(() =\u0026gt; {\r\n      dispatch(addTodo(title));\r\n    });\r\n  };\r\n}\r\n~~~\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eAsync/Await :\u003cbr /\u003e\r\n~~~javascript const sleep1000ms = () =\u0026gt; { ... 上記サンプルと同じ };\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eexport function addTodo(title) {\r\n  ... 上記サンプルと同じ\r\n}\r\n\r\n// Async/Await 版\r\nexport function asyncAddTodo(title) {\r\n  return async(dispatch) =\u0026gt; {\r\n    await sleep1000ms();\r\n    dispatch(addTodo(title));\r\n  };\r\n}\r\n~~~\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"複数のアクションをまとめる\"\u003e複数のアクションをまとめる\u003c/h3\u003e\r\n\u003cp\u003e通常のActionCreatorでは、1つの関数では1つのActionしか返せませんでした。 thunkはこれらを1つにまとめたActionとして返すことができます。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb123\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb123-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eaddTodo\u003c/span\u003e(title) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-3\" title=\"3\"\u003e    \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003etypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eADD_TODO\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-4\" title=\"4\"\u003e    \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-5\" title=\"5\"\u003e      \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eshortid\u003c/span\u003e.\u003cspan class=\"at\"\u003egenerate\u003c/span\u003e()\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-6\" title=\"6\"\u003e      title\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-7\" title=\"7\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-8\" title=\"8\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-9\" title=\"9\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-10\" title=\"10\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-11\" title=\"11\"\u003e\u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eupdateInput\u003c/span\u003e(value) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-12\" title=\"12\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-13\" title=\"13\"\u003e    \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003etypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eUPDATE_INPUT\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-14\" title=\"14\"\u003e    \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-15\" title=\"15\"\u003e      value\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-16\" title=\"16\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-17\" title=\"17\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-18\" title=\"18\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-19\" title=\"19\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-20\" title=\"20\"\u003e\u003cspan class=\"co\"\u003e// 上の2つのActionを1つにまとめる\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-21\" title=\"21\"\u003e\u003cspan class=\"co\"\u003e// これをReactコンポーネントにバインドする\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-22\" title=\"22\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eaddTodoAndClear\u003c/span\u003e(title) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-23\" title=\"23\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (dispatch) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-24\" title=\"24\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTodo\u003c/span\u003e(title))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-25\" title=\"25\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eupdateInput\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;\u0026#39;\u003c/span\u003e))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-26\" title=\"26\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb123-27\" title=\"27\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e1つの操作で複数の処理を行うときのアプローチとして、以下が考えられます。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eActionCreatorでまとめる。\u003c/li\u003e\r\n\u003cli\u003e1つのActionとして記述し、reducerで2つの操作を行う。\u003c/li\u003e\r\n\u003cli\u003e複数のActionをReactコンポーネントのボタンにバインドする。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003eActionCreatorでまとめるのがベターな方法です。 理由は次の2つです。\u003c/p\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003eそれぞれのActionの処理を独立して考えられる。\u003c/p\u003e\r\n\u003cp\u003eサンプルコードの場合、TODOを追加することと、フォームをクリアすることに直接の関係はありません。 TODOをコピーするときなどフォームを使わずにTODOを追加する方法を増やすときは、addTodo関数については再利用ができそうです。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eActionCreatorをユーザー操作とひも付けられる。\u003c/p\u003e\r\n\u003cp\u003eActionCreatorはContainerコンポーネントからpropsとしてUI要素を持つプレゼンテーショナルコンポーネントに渡されるはずです。 このとき、プレゼンテーショナルコンポーネントは「このボタンを押すと何が起きるかはわからないが、渡された関数を叩けばよい」というように作られているべきです。\u003c/p\u003e\r\n\u003cp\u003eボタンを押したら「TODOを追加する関数を叩く」のと「フォームをクリアする関数を叩く」ことをプレゼンテーショナルコンポーネントに書いてしまうと、コンポーネントはビジネスロジックや仕様を反映し、汎用性を失ってしまいます。\u003c/p\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003ch3 id=\"getstate関数\"\u003egetState関数\u003c/h3\u003e\r\n\u003cp\u003egetState関数はstoreが持つ関数と同一で、すべてのstateを返します。 ActionCreator内でstoreの内容を知ることで、できることが広がります。\u003c/p\u003e\r\n\u003cp\u003eたとえば、登録済みのTODOは追加しないようにする。など。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb124\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb124-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eaddUniqueTodo\u003c/span\u003e(title) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (dispatch\u003cspan class=\"op\"\u003e,\u003c/span\u003e getState) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-3\" title=\"3\"\u003e    \u003cspan class=\"kw\"\u003econst\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-4\" title=\"4\"\u003e      \u003cspan class=\"dt\"\u003etodo\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-5\" title=\"5\"\u003e        todos\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-6\" title=\"6\"\u003e      \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-7\" title=\"7\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003egetState\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-8\" title=\"8\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-9\" title=\"9\"\u003e    \u003cspan class=\"co\"\u003e// stateに保存されたTodoに同一のタイトルがあったら登録済み\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-10\" title=\"10\"\u003e    \u003cspan class=\"kw\"\u003econst\u003c/span\u003e isDuplicated \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003etodos\u003c/span\u003e.\u003cspan class=\"at\"\u003esome\u003c/span\u003e(todo \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"va\"\u003etodo\u003c/span\u003e.\u003cspan class=\"at\"\u003etitle\u003c/span\u003e \u003cspan class=\"op\"\u003e===\u003c/span\u003e title)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-11\" title=\"11\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-12\" title=\"12\"\u003e    \u003cspan class=\"cf\"\u003eif\u003c/span\u003e (isDuplicated) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-13\" title=\"13\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-14\" title=\"14\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-15\" title=\"15\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003eaddTodo\u003c/span\u003e(title))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-16\" title=\"16\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb124-17\" title=\"17\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eこの処理はReducerでもできますが、ActionCreatorで処理すると次のメリットがあります。\u003c/p\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003eすべてのstateを参照できる\u003c/p\u003e\r\n\u003cp\u003e分割されたReducerは、ほかのReducerが持っているstateを参照することができません。 ほかのReducerが持っているstateを使ってActionの動作を振り分けたいときは、ActionCreatorでgetStateするのがよいでしょう。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eAction、Reducerの処理を簡潔にできる\u003c/p\u003e\r\n\u003cp\u003e〝ActionをどうDispatchするか〟の部分をActionCreatorとして切り出しておくことで、アクションとそれに対応するReducerの処理を簡潔にできます。\u003c/p\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003ch2 id=\"uiをきれいにする\"\u003eUIをきれいにする\u003c/h2\u003e\r\n\u003ch3 id=\"style属性を使う方法\"\u003estyle属性を使う方法\u003c/h3\u003e\r\n\u003cp\u003e※style属性を使っての指定は非推奨です。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003cp\u003eJSXのstyle属性を使って、直接スタイルを適用できる。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eオブジェクトのキーにCSSプロパティをキャメルケースで指定、オブジェクトの値にCSSの値を指定します。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e値にNumber型を指定したときは自動でpxが追加されます。px以外の単位を指定するときは、単位付きの値を文字列で指定します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb125\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb125-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// font-size: 20px\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb125-2\" title=\"2\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv style\u003cspan class=\"op\"\u003e={{\u003c/span\u003e \u003cspan class=\"dt\"\u003efontSize\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"dv\"\u003e20\u003c/span\u003e \u003cspan class=\"op\"\u003e}}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb125-3\" title=\"3\"\u003e  Hello World\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb125-4\" title=\"4\"\u003e\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb125-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb125-6\" title=\"6\"\u003e\u003cspan class=\"co\"\u003e// font-size: 2em\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb125-7\" title=\"7\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv style\u003cspan class=\"op\"\u003e={{\u003c/span\u003e \u003cspan class=\"dt\"\u003efontSize\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;2em\u0026quot;\u003c/span\u003e \u003cspan class=\"op\"\u003e}}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb125-8\" title=\"8\"\u003e  Hello World\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb125-9\" title=\"9\"\u003e\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eベンダープレフィクスは自動で付与されません。自分で指定する必要があります。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb126\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb126-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e style \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-2\" title=\"2\"\u003e  \u003cspan class=\"co\"\u003e// ベンダープレフィクス付きのスタイル\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-3\" title=\"3\"\u003e  \u003cspan class=\"dt\"\u003eWebkitTransition\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;all\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-4\" title=\"4\"\u003e  \u003cspan class=\"co\"\u003e// 通常のスタイル\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-5\" title=\"5\"\u003e  \u003cspan class=\"dt\"\u003etransition\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;all\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-6\" title=\"6\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-7\" title=\"7\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-8\" title=\"8\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e HelloWorldComponent \u003cspan class=\"op\"\u003e=\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-9\" title=\"9\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv style\u003cspan class=\"op\"\u003e={\u003c/span\u003e style \u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003eHello World\u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb126-10\" title=\"10\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch3 id=\"classname属性を使う方法\"\u003eclassName属性を使う方法\u003c/h3\u003e\r\n\u003cp\u003eJSXのclassName属性を使って、CSSクラスの指定ができます。className属性に指定した内容が、HTMLのclass属性となります。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb127\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb127-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Button \u003cspan class=\"op\"\u003e=\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb127-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ebutton className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;normal-button\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e追加\u0026lt;/button\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb127-3\" title=\"3\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003c!-- TODO: p.169 リスト9.4　\u003cbutton\u003e要素で始まっているのに、閉じタグが\u003c/div\u003e　リスト9.6も同様 --\u003e\r\n\r\n\u003cp\u003e\u003ccode\u003ewebpack\u003c/code\u003e、\u003ccode\u003ecss-loader\u003c/code\u003e、\u003ccode\u003estyle-loader\u003c/code\u003eなどのライブラリを組み合わせることで、JavaScriptからCSSファイルの読み込みができるようになります。 \u003ccode\u003ecreate-react-app\u003c/code\u003eでは、標準でCSSファイルのインポートがサポートされています。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb128\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb128-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;./style.css\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb128-2\" title=\"2\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb128-3\" title=\"3\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e Button \u003cspan class=\"op\"\u003e=\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb128-4\" title=\"4\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ebutton className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;normal-button\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e追加\u0026lt;/button\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb128-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb128-6\" title=\"6\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e Button\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch3 id=\"uiライブラリを使う\"\u003eUIライブラリを使う\u003c/h3\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003cp\u003eMaterial-UI\u003c/p\u003e\r\n\u003cp\u003eマテリアルデザインに沿って作られたUIライブラリ。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eReact-Bootstrap\u003c/p\u003e\r\n\u003cp\u003eBootstrapをReact向けのUIライブラリとして実装したもの。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eReact Desktop\u003c/p\u003e\r\n\u003cp\u003eデスクトップネイティブアプリの開発を想定したReact向けUIライブラリ。 Electronなどで利用します。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eOnsen UI\u003c/p\u003e\r\n\u003cp\u003eネイティブアプリライクなモバイルウェブアプリの作成に特化したUIライブラリ。\u003c/p\u003e\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch3 id=\"material-ui\"\u003eMaterial-UI\u003c/h3\u003e\r\n\u003cp\u003eマテリアルデザインに則ったUIを簡単に実装することができます。 ボタンやフォームなどの基本的なUIパーツが網羅されています。\u003c/p\u003e\r\n\u003cp\u003e各UIパーツはReactコンポーネントとして実装されており、props経由でコンポーネントをカスタマイズできます。\u003c/p\u003e\r\n\u003cp\u003eパッケージは、次のコマンドでインストールできます。\u003c/p\u003e\r\n\u003cp\u003eこちらだと v0.20.0 がインストールされます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save material-ui\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e最新をインストールしたければ次のコマンドにします。 2018年3月8日時点で v1.0.0-beta.36がインストールされました。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save material-ui@next\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003e※以降のサンプルは\u003ccode\u003e@next\u003c/code\u003eでインストールしたものを対象としています。\u003c/p\u003e\r\n\u003ch4 id=\"使い方\"\u003e使い方\u003c/h4\u003e\r\n\u003cp\u003e\u003ccode\u003esrc/components/TodoApp.js\u003c/code\u003eを修正します。\u003c/p\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003eインポートを追加します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb131\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb131-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Reboot \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;material-ui/Reboot\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb131-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Button \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;material-ui/Button\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eRebootコンポーネントを追加します。 場所はどこでもよいですが、今回はルート要素の最初の子要素にしました。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb132\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb132-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eTodoApp\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e task\u003cspan class=\"op\"\u003e,\u003c/span\u003e tasks\u003cspan class=\"op\"\u003e,\u003c/span\u003e inputTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e addTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e redirectToError \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb132-2\" title=\"2\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb132-3\" title=\"3\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb132-4\" title=\"4\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e onChange\u003cspan class=\"op\"\u003e={\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(\u003cspan class=\"va\"\u003ee\u003c/span\u003e.\u003cspan class=\"va\"\u003etarget\u003c/span\u003e.\u003cspan class=\"at\"\u003evalue\u003c/span\u003e)\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e↓\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb133\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb133-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eTodoApp\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e task\u003cspan class=\"op\"\u003e,\u003c/span\u003e tasks\u003cspan class=\"op\"\u003e,\u003c/span\u003e inputTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e addTask\u003cspan class=\"op\"\u003e,\u003c/span\u003e redirectToError \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb133-2\" title=\"2\"\u003e \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb133-3\" title=\"3\"\u003e   \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb133-4\" title=\"4\"\u003e     \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eReboot /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb133-5\" title=\"5\"\u003e     \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;text\u0026quot;\u003c/span\u003e onChange\u003cspan class=\"op\"\u003e={\u003c/span\u003e(e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003einputTask\u003c/span\u003e(\u003cspan class=\"va\"\u003ee\u003c/span\u003e.\u003cspan class=\"va\"\u003etarget\u003c/span\u003e.\u003cspan class=\"at\"\u003evalue\u003c/span\u003e)\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003einput要素で作っていたボタンを、Buttonコンポーネントに変更します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb134\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb134-1\" title=\"1\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003einput type\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;button\u0026quot;\u003c/span\u003e value\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;add\u0026quot;\u003c/span\u003e onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task)\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e↓\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb135\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb135-1\" title=\"1\"\u003e\u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eButton variant\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;raised\u0026quot;\u003c/span\u003e className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;default\u0026quot;\u003c/span\u003e onClick\u003cspan class=\"op\"\u003e={\u003c/span\u003e() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"at\"\u003eaddTask\u003c/span\u003e(task)\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003eadd\u0026lt;/Button\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003ch2 id=\"note\"\u003eNote\u003c/h2\u003e\r\n\u003ch3 id=\"reduxの三原則\"\u003eReduxの三原則\u003c/h3\u003e\r\n\u003cp\u003eSingle source of truth : アプリケーション内のすべての状態を一つの大きなオブジェクトとして管理します。\u003c/p\u003e\r\n\u003cp\u003eState in read-only : アプリケーションの状態はコンポーネントから直接参照できますが、直接変更することはできません。 Action（どんな動作を行ったのかを示す単純なオブジェクト）をdispatch（発行）することが、アプリケーションの状態を変更する唯一の方法です。\u003c/p\u003e\r\n\u003cp\u003eChanges are made with pure functions : アプリケーションの状態の変更は、副作用のない純粋関数によって行われます。 〝純粋関数〟とは〝同じ入力を渡せば、同じ出力が得られる関数〟のことです。\u003c/p\u003e\r\n\u003ch3 id=\"ie11-arrayprototypefind-メソッドがエラーになる\"\u003eIE11 Array.prototype.find メソッドがエラーになる\u003c/h3\u003e\r\n\u003cp\u003eIE11 では Array.prototype.find メソッドがサポートされていないのでエラーになります。\u003c/p\u003e\r\n\u003cp\u003e対応させるためには Polyfill で代替コードを実装する必要があります。\u003c/p\u003e\r\n\u003ch2 id=\"一連の流れを通しで\"\u003e一連の流れを通しで\u003c/h2\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003eプロジェクトを作成して、ルートフォルダに移動します。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; .\\node_modules\\.bin\\create-react-app app-1st\r\n\u0026gt; cd app-1st\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003epropTypesをインストールします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save prop-types\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003epropTypesはpropsの型チェック機能を持つパッケージです。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eアプリケーションを開発モードで起動します。\u003c/p\u003e\r\n\u003cp\u003eブラウザが自動で起動して、\u003ccode\u003ehttp://localhost:3000/\u003c/code\u003eにアクセスします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm start\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eファイル/フォルダ構成に則り、フォルダを作ります。 あとから作り直せばいいので、構成はあまり悩まなくてよいです。\u003c/p\u003e\r\n\u003cp\u003e今回はサンプルと同じにします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003esrc/\r\n+---index.js  ... エントリポイント\r\n+---App.js    ... ルートコンポーネント\r\n+---components/\r\n|     ... Presentational Component を置く\r\n+---containers/\r\n|     ... Container Component を置く\r\n+---actions/\r\n|     ... ActionCreator を置く\r\n+---reducers/\r\n|     ... Reducer を置く\r\n`---store/\r\n      ... Store を置く（createStore関数）\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; mkdir .\\src\\containers\r\n\u0026gt; mkdir .\\src\\components\r\n\u0026gt; mkdir .\\src\\actions\r\n\u0026gt; mkdir .\\src\\reducers\r\n\u0026gt; mkdir .\\src\\store\r\n\u003c/code\u003e\u003c/pre\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eReduxをインストールします。\u003c/p\u003e\r\n\u003cp\u003eReduxを開発で使う場合、開発が進んでからインストールするのは導入コストが高くなるため、開発開始時に導入しておきます。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save redux react-redux redux-logger\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eReduxのStoreの作成にはReducerが必要です。 ［\u003ccode\u003esrc\\reducers\\index.js\u003c/code\u003e］にReducerを追加します。\u003c/p\u003e\r\n\u003cp\u003eこの時点では、単純に受け取ったstateをそのまま返すReducerを定義しておきます。\u003c/p\u003e\r\n\u003cp\u003e1つのReducerでアプリケーションが完結することはまずないので、［\u003ccode\u003esrc\\reducers\\index.js\u003c/code\u003e］に各Reducerの参照を束ねて、\u003ccode\u003eimport * as reducers from \"./reducers\"\u003c/code\u003eでまとめてimportできる作りにしておきます。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb142\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb142-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// 受け取ったstateをそのまま返すReducer\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb142-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003econst\u003c/span\u003e noop \u003cspan class=\"op\"\u003e=\u003c/span\u003e (state \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{}\u003c/span\u003e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e state\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\store\\index.js\u003c/code\u003e]にreduxのcreateStore関数を定義します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb143\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb143-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore\u003cspan class=\"op\"\u003e,\u003c/span\u003e combineReducers\u003cspan class=\"op\"\u003e,\u003c/span\u003e applyMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e logger \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux-logger\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e*\u003c/span\u003e \u003cspan class=\"im\"\u003eas\u003c/span\u003e reducers \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../reducers\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-5\" title=\"5\"\u003e\u003cspan class=\"co\"\u003e// Storeを生成するための関数を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-6\" title=\"6\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStoreEx\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-7\" title=\"7\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-8\" title=\"8\"\u003e    \u003cspan class=\"co\"\u003e// 複数のReducerをまとめる\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-9\" title=\"9\"\u003e    \u003cspan class=\"at\"\u003ecombineReducers\u003c/span\u003e(reducers)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-10\" title=\"10\"\u003e    \u003cspan class=\"co\"\u003e// ミドルウェアを適用する\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-11\" title=\"11\"\u003e    \u003cspan class=\"at\"\u003eapplyMiddleware\u003c/span\u003e(logger)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-12\" title=\"12\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb143-13\" title=\"13\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e［\u003ccode\u003esrc\\index.js\u003c/code\u003e］でStoreを生成し、react-reduxのProviderコンポーネントでAppコンポーネントに関連付ける処理を記述します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb144\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb144-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e ReactDOM \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Provider \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e App \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./App\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e createStoreEx \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./store\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// Storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-8\" title=\"8\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStoreEx\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-9\" title=\"9\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-10\" title=\"10\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-11\" title=\"11\"\u003e  \u003cspan class=\"co\"\u003e// Providerコンポーネントを使って、StoreをAppコンポーネントに関連付ける\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-12\" title=\"12\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eProvider store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-13\" title=\"13\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eApp /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-14\" title=\"14\"\u003e  \u0026lt;/Provider\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-15\" title=\"15\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb144-16\" title=\"16\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eルーティングライブラリの導入\u003c/p\u003e\r\n\u003cp\u003eこちらも開発開始時に導入しておきます。\u003c/p\u003e\r\n\u003cp\u003eNote : 最新版の React Router （ver 4.x）に対応した react-router-redux パッケージのバージョンは ver 5.x なので、\u003ccode\u003e@next\u003c/code\u003eをつけてインストールします（2018年3月8日時点）。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save react-router-dom history react-router-redux@next\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eStoreを生成する関数に、routerReducerとrouterMiddlewareを追加します。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\store\\index.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb146\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb146-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore\u003cspan class=\"op\"\u003e,\u003c/span\u003e combineReducers\u003cspan class=\"op\"\u003e,\u003c/span\u003e applyMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e logger \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux-logger\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e*\u003c/span\u003e \u003cspan class=\"im\"\u003eas\u003c/span\u003e reducers \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../reducers\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e routerReducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e routerMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-6\" title=\"6\"\u003e\u003cspan class=\"co\"\u003e// Storeを生成するための関数を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// history は src/index.js から受け渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-8\" title=\"8\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStoreEx\u003c/span\u003e(history) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-9\" title=\"9\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-10\" title=\"10\"\u003e    \u003cspan class=\"co\"\u003e// 複数のReducerをまとめる\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-11\" title=\"11\"\u003e    \u003cspan class=\"co\"\u003e//   ・自前で定義したReducer\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-12\" title=\"12\"\u003e    \u003cspan class=\"co\"\u003e//   ・react-router-redux の Reducer\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-13\" title=\"13\"\u003e    \u003cspan class=\"at\"\u003ecombineReducers\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-14\" title=\"14\"\u003e      ...\u003cspan class=\"at\"\u003ereducers\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-15\" title=\"15\"\u003e      \u003cspan class=\"dt\"\u003erouter\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e routerReducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-16\" title=\"16\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-17\" title=\"17\"\u003e    \u003cspan class=\"co\"\u003e// ミドルウェアを適用する\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-18\" title=\"18\"\u003e    \u003cspan class=\"co\"\u003e// react-router-redux の Redux Middleware\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-19\" title=\"19\"\u003e    \u003cspan class=\"at\"\u003eapplyMiddleware\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-20\" title=\"20\"\u003e      logger\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-21\" title=\"21\"\u003e      \u003cspan class=\"at\"\u003erouterMiddleware\u003c/span\u003e(history)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-22\" title=\"22\"\u003e    )\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-23\" title=\"23\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb146-24\" title=\"24\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\index.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb147\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb147-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e ReactDOM \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Provider \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e ConnectedRouter \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e createBrowserHistory \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;history/createBrowserHistory\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-6\" title=\"6\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e App \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./App\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-7\" title=\"7\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e createStoreEx \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./store\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-8\" title=\"8\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-9\" title=\"9\"\u003e\u003cspan class=\"co\"\u003e// history のインスタンスを生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-10\" title=\"10\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e history \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateBrowserHistory\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-11\" title=\"11\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-12\" title=\"12\"\u003e\u003cspan class=\"co\"\u003e// Storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-13\" title=\"13\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStoreEx\u003c/span\u003e(history)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-14\" title=\"14\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-15\" title=\"15\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-16\" title=\"16\"\u003e  \u003cspan class=\"co\"\u003e// Providerコンポーネントを使って、StoreをAppコンポーネントに関連付ける\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-17\" title=\"17\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eProvider store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-18\" title=\"18\"\u003e    \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-19\" title=\"19\"\u003e      \u003cspan class=\"co\"\u003e/* Link コンポーネントなどが動作するように、\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-20\" title=\"20\"\u003e\u003cspan class=\"co\"\u003e         react-router-dom の Router ではなく\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-21\" title=\"21\"\u003e\u003cspan class=\"co\"\u003e         react-router-redux の ConnectedRouter を使う\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-22\" title=\"22\"\u003e\u003cspan class=\"co\"\u003e       */\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-23\" title=\"23\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-24\" title=\"24\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eConnectedRouter history\u003cspan class=\"op\"\u003e={\u003c/span\u003ehistory\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-25\" title=\"25\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eApp /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-26\" title=\"26\"\u003e    \u0026lt;/ConnectedRouter\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-27\" title=\"27\"\u003e  \u0026lt;/Provider\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-28\" title=\"28\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb147-29\" title=\"29\"\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eルーティングの実装\u003c/p\u003e\r\n\u003cp\u003eコンポーネントを作ります。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\components\\Ranking.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb148\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb148-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e PropTypes \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;prop-types\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eRanking\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e categoryId \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-5\" title=\"5\"\u003e  \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: 最終的には categoryId をもとにAPIから情報を取得する\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-6\" title=\"6\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-7\" title=\"7\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-8\" title=\"8\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eh2\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eRanking Component\u0026lt;/h2\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-9\" title=\"9\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ep\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eCategory \u003cspan class=\"dt\"\u003eId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003ecategoryId\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/p\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-10\" title=\"10\"\u003e    \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-11\" title=\"11\"\u003e  )\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-12\" title=\"12\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-13\" title=\"13\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-14\" title=\"14\"\u003e\u003cspan class=\"co\"\u003e// propsのデータ型を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-15\" title=\"15\"\u003e\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003epropTypes\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-16\" title=\"16\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003estring\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-17\" title=\"17\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-18\" title=\"18\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-19\" title=\"19\"\u003e\u003cspan class=\"co\"\u003e// 未指定時の既定値を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-20\" title=\"20\"\u003e\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003edefaultProps\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-21\" title=\"21\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb148-22\" title=\"22\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eルーティングの設定は [\u003ccode\u003esrc\\App.js\u003c/code\u003e] に記述します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb149\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb149-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Component \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Route\u003cspan class=\"op\"\u003e,\u003c/span\u003e Link \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Ranking \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./components/Ranking\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-5\" title=\"5\"\u003e\u003cspan class=\"kw\"\u003eclass\u003c/span\u003e App \u003cspan class=\"kw\"\u003eextends\u003c/span\u003e Component \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-6\" title=\"6\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-7\" title=\"7\"\u003e    \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-8\" title=\"8\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;App\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-9\" title=\"9\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"co\"\u003e/* カテゴリ名、IDはハードコード。本来であればAPIから取得するのが望ましい。 */\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-10\" title=\"10\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-11\" title=\"11\"\u003e          \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli\u003cspan class=\"op\"\u003e\u0026gt;\u0026lt;\u003c/span\u003eLink to\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/all\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eCategory All\u0026lt;/Link\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-12\" title=\"12\"\u003e          \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli\u003cspan class=\"op\"\u003e\u0026gt;\u0026lt;\u003c/span\u003eLink to\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/category/2502\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eCategory \u003cspan class=\"dv\"\u003e2502\u003c/span\u003e\u0026lt;/Link\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-13\" title=\"13\"\u003e          \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli\u003cspan class=\"op\"\u003e\u0026gt;\u0026lt;\u003c/span\u003eLink to\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/category/10002\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eCategory \u003cspan class=\"dv\"\u003e10002\u003c/span\u003e\u0026lt;/Link\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-14\" title=\"14\"\u003e        \u0026lt;/ul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-15\" title=\"15\"\u003e        \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-16\" title=\"16\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/all\u0026quot;\u003c/span\u003e component\u003cspan class=\"op\"\u003e={\u003c/span\u003eRanking\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-17\" title=\"17\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-18\" title=\"18\"\u003e          path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/category/:id\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-19\" title=\"19\"\u003e          render\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-20\" title=\"20\"\u003e            (\u003cspan class=\"op\"\u003e{\u003c/span\u003e match \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRanking categoryId\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"va\"\u003ematch\u003c/span\u003e.\u003cspan class=\"va\"\u003eparams\u003c/span\u003e.\u003cspan class=\"at\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-21\" title=\"21\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-22\" title=\"22\"\u003e      \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-23\" title=\"23\"\u003e    )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-24\" title=\"24\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-25\" title=\"25\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-26\" title=\"26\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb149-27\" title=\"27\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e App\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e非同期処理の実装\u003c/p\u003e\r\n\u003cp\u003eインストール\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save redux-thunk fetch-jsonp qs\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003efetch-jsonp : XMLHttpRequestの後継であるfetch関数と同じインターフェースでJSONPのAPIで通信できるライブラリ。\u003c/p\u003e\r\n\u003cp\u003eqs : URLのクエリ文字列（URLの ? のあとにつく key=value\u0026amp;hoge=fuga の部分）を扱うライブラリ。\u003c/p\u003e\r\n\u003cp\u003eミドルウェアに redux-thunk を追加するため、[\u003ccode\u003esrc\\store\\index.js\u003c/code\u003e]を修正します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb151\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb151-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore\u003cspan class=\"op\"\u003e,\u003c/span\u003e combineReducers\u003cspan class=\"op\"\u003e,\u003c/span\u003e applyMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e logger \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux-logger\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e thunk \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux-thunk\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e*\u003c/span\u003e \u003cspan class=\"im\"\u003eas\u003c/span\u003e reducers \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../reducers\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e routerReducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e routerMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// Storeを生成するための関数を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-8\" title=\"8\"\u003e\u003cspan class=\"co\"\u003e// history は src/index.js から受け渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-9\" title=\"9\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStoreEx\u003c/span\u003e(history) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-10\" title=\"10\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-11\" title=\"11\"\u003e    \u003cspan class=\"co\"\u003e// 複数のReducerをまとめる\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-12\" title=\"12\"\u003e    \u003cspan class=\"co\"\u003e//   ・自前で定義したReducer\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-13\" title=\"13\"\u003e    \u003cspan class=\"co\"\u003e//   ・react-router-redux の Reducer\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-14\" title=\"14\"\u003e    \u003cspan class=\"at\"\u003ecombineReducers\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-15\" title=\"15\"\u003e      ...\u003cspan class=\"at\"\u003ereducers\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-16\" title=\"16\"\u003e      \u003cspan class=\"dt\"\u003erouter\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e routerReducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-17\" title=\"17\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-18\" title=\"18\"\u003e    \u003cspan class=\"co\"\u003e// ミドルウェアを適用する\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-19\" title=\"19\"\u003e    \u003cspan class=\"co\"\u003e// react-router-redux の Redux Middleware\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-20\" title=\"20\"\u003e    \u003cspan class=\"at\"\u003eapplyMiddleware\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-21\" title=\"21\"\u003e      logger\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-22\" title=\"22\"\u003e      thunk\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-23\" title=\"23\"\u003e      \u003cspan class=\"at\"\u003erouterMiddleware\u003c/span\u003e(history)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-24\" title=\"24\"\u003e    )\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-25\" title=\"25\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb151-26\" title=\"26\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eAPIからデータを取得し、ReduxのStoreを経由してコンポーネントに表示する処理を実装します。\u003c/p\u003e\r\n\u003cp\u003eComponentからActionを呼び出す部分。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\components\\Ranking.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb152\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb152-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e PropTypes \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;prop-types\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-4\" title=\"4\"\u003e\u003cspan class=\"co\"\u003e// ライフサイクルメソッドを使うので function から class に変更\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003eclass\u003c/span\u003e Ranking \u003cspan class=\"kw\"\u003eextends\u003c/span\u003e \u003cspan class=\"va\"\u003eReact\u003c/span\u003e.\u003cspan class=\"at\"\u003eComponent\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-7\" title=\"7\"\u003e  \u003cspan class=\"at\"\u003ecomponentWillMount\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-8\" title=\"8\"\u003e    \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003eonMount\u003c/span\u003e(\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-9\" title=\"9\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-10\" title=\"10\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-11\" title=\"11\"\u003e  \u003cspan class=\"at\"\u003ecomponentWillReceiveProps\u003c/span\u003e(nextProps) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-12\" title=\"12\"\u003e    \u003cspan class=\"cf\"\u003eif\u003c/span\u003e (\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e \u003cspan class=\"op\"\u003e!==\u003c/span\u003e \u003cspan class=\"va\"\u003enextProps\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-13\" title=\"13\"\u003e      \u003cspan class=\"co\"\u003e// props.categoryId に変化があるので、ページ移動が発生している\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-14\" title=\"14\"\u003e      \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003eonUpdate\u003c/span\u003e(\u003cspan class=\"va\"\u003enextProps\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-15\" title=\"15\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-16\" title=\"16\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-17\" title=\"17\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-18\" title=\"18\"\u003e  \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: 最終的には categoryId をもとにAPIから情報を取得する\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-19\" title=\"19\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-20\" title=\"20\"\u003e    \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-21\" title=\"21\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-22\" title=\"22\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eh2\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eRanking Component\u0026lt;/h2\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-23\" title=\"23\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ep\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eCategory \u003cspan class=\"dt\"\u003eId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/p\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-24\" title=\"24\"\u003e      \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-25\" title=\"25\"\u003e    )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-26\" title=\"26\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-27\" title=\"27\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-28\" title=\"28\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-29\" title=\"29\"\u003e\u003cspan class=\"co\"\u003e// propsのデータ型を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-30\" title=\"30\"\u003e\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003epropTypes\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-31\" title=\"31\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003estring\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-32\" title=\"32\"\u003e  \u003cspan class=\"dt\"\u003eonMount\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003efunc\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-33\" title=\"33\"\u003e  \u003cspan class=\"dt\"\u003eonUpdate\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003efunc\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-34\" title=\"34\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-35\" title=\"35\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-36\" title=\"36\"\u003e\u003cspan class=\"co\"\u003e// 未指定時の既定値を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-37\" title=\"37\"\u003e\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003edefaultProps\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-38\" title=\"38\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb152-39\" title=\"39\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\actions\\Ranking.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cp\u003eActionCreator を定義します。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eコンポーネントのprops.onMount、props.onUpdateが呼び出されたときに実行するfetchRanking ※redux-thunkを使った非同期処理\u003c/li\u003e\r\n\u003cli\u003eリクエスト開始 Action - startRequest\u003c/li\u003e\r\n\u003cli\u003eレスポンス受信 Action - receiveData\u003c/li\u003e\r\n\u003cli\u003eリクエスト完了 Action - finishRequest\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb153\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb153-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e fetchJsonp \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;fetch-jsonp\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e qs \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;qs\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-4\" title=\"4\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e API_URL \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;http://hoge.co.jp/v1/json/hoge\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: api のURL\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-5\" title=\"5\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e APP_ID \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;APP_ID\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e                          \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: 不要だが定義しておく\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-7\" title=\"7\"\u003e\u003cspan class=\"co\"\u003e// リクエスト開始 Action\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-8\" title=\"8\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e startRequest \u003cspan class=\"op\"\u003e=\u003c/span\u003e categoryId \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-9\" title=\"9\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;START_REQUEST\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-10\" title=\"10\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e categoryId \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-11\" title=\"11\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-12\" title=\"12\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-13\" title=\"13\"\u003e\u003cspan class=\"co\"\u003e// レスポンス受信 Action\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-14\" title=\"14\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e receiveData \u003cspan class=\"op\"\u003e=\u003c/span\u003e (categoryId\u003cspan class=\"op\"\u003e,\u003c/span\u003e error\u003cspan class=\"op\"\u003e,\u003c/span\u003e response) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-15\" title=\"15\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;RECEIVE_DATA\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-16\" title=\"16\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e categoryId\u003cspan class=\"op\"\u003e,\u003c/span\u003e error\u003cspan class=\"op\"\u003e,\u003c/span\u003e response \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-17\" title=\"17\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-18\" title=\"18\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-19\" title=\"19\"\u003e\u003cspan class=\"co\"\u003e// リクエスト完了 Action\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-20\" title=\"20\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e finishRequest \u003cspan class=\"op\"\u003e=\u003c/span\u003e categoryId \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-21\" title=\"21\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;FINISH_REQUEST\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-22\" title=\"22\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e categoryId \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-23\" title=\"23\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-24\" title=\"24\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-25\" title=\"25\"\u003e\u003cspan class=\"co\"\u003e// データ取得\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-26\" title=\"26\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003econst\u003c/span\u003e fetchRanking \u003cspan class=\"op\"\u003e=\u003c/span\u003e categoryId \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-27\" title=\"27\"\u003e  \u003cspan class=\"co\"\u003e// redux-thunkを使った非同期処理\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-28\" title=\"28\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e async dispatch \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-29\" title=\"29\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003estartRequest\u003c/span\u003e(categoryId))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-30\" title=\"30\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-31\" title=\"31\"\u003e    \u003cspan class=\"kw\"\u003econst\u003c/span\u003e queryString \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003eqs\u003c/span\u003e.\u003cspan class=\"at\"\u003estringify\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-32\" title=\"32\"\u003e      \u003cspan class=\"dt\"\u003eappid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e APP_ID\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-33\" title=\"33\"\u003e      \u003cspan class=\"dt\"\u003ecategory_id\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e categoryId\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-34\" title=\"34\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-35\" title=\"35\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-36\" title=\"36\"\u003e    \u003cspan class=\"cf\"\u003etry\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-37\" title=\"37\"\u003e      \u003cspan class=\"kw\"\u003econst\u003c/span\u003e response \u003cspan class=\"op\"\u003e=\u003c/span\u003e await \u003cspan class=\"at\"\u003efetchJsonp\u003c/span\u003e(\u003cspan class=\"vs\"\u003e`\u003c/span\u003e\u003cspan class=\"sc\"\u003e${\u003c/span\u003eAPI_URL\u003cspan class=\"sc\"\u003e}\u003c/span\u003e\u003cspan class=\"vs\"\u003e?\u003c/span\u003e\u003cspan class=\"sc\"\u003e${\u003c/span\u003equeryString\u003cspan class=\"sc\"\u003e}\u003c/span\u003e\u003cspan class=\"vs\"\u003e`\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-38\" title=\"38\"\u003e      \u003cspan class=\"kw\"\u003econst\u003c/span\u003e data \u003cspan class=\"op\"\u003e=\u003c/span\u003e await \u003cspan class=\"va\"\u003eresponse\u003c/span\u003e.\u003cspan class=\"at\"\u003ejson\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-39\" title=\"39\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003ereceiveData\u003c/span\u003e(categoryId\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"kw\"\u003enull\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e data))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-40\" title=\"40\"\u003e      \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-41\" title=\"41\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"cf\"\u003ecatch\u003c/span\u003e (ex) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-42\" title=\"42\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003ereceiveData\u003c/span\u003e(categoryId\u003cspan class=\"op\"\u003e,\u003c/span\u003e ex))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-43\" title=\"43\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-44\" title=\"44\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-45\" title=\"45\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003efinishRequest\u003c/span\u003e(categoryId))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-46\" title=\"46\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb153-47\" title=\"47\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\containers\\Ranking.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eActionCreator をコンポーネントのprops.onMountedから呼び出すため、Container Component を定義します。\u003c/li\u003e\r\n\u003cli\u003emapDispatchToPropsで、props.onMountedとactions.fetchRankingを接続します。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb154\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb154-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e connect \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Ranking \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../components/Ranking\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e*\u003c/span\u003e \u003cspan class=\"im\"\u003eas\u003c/span\u003e actions \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../actions/Ranking\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-5\" title=\"5\"\u003e\u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: Reducerを定義するまでの仮の処理\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-6\" title=\"6\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e mapStateToProps \u003cspan class=\"op\"\u003e=\u003c/span\u003e (state\u003cspan class=\"op\"\u003e,\u003c/span\u003e ownProps) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-7\" title=\"7\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eownProps\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-9\" title=\"9\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-10\" title=\"10\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e mapDispatchToProps \u003cspan class=\"op\"\u003e=\u003c/span\u003e dispatch \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-11\" title=\"11\"\u003e  \u003cspan class=\"at\"\u003eonMount\u003c/span\u003e(categoryId) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-12\" title=\"12\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"va\"\u003eactions\u003c/span\u003e.\u003cspan class=\"at\"\u003efetchRanking\u003c/span\u003e(categoryId))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-13\" title=\"13\"\u003e  \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-14\" title=\"14\"\u003e  \u003cspan class=\"at\"\u003eonUpdate\u003c/span\u003e(categoryId) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-15\" title=\"15\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"va\"\u003eactions\u003c/span\u003e.\u003cspan class=\"at\"\u003efetchRanking\u003c/span\u003e(categoryId))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-16\" title=\"16\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-17\" title=\"17\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-18\" title=\"18\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb154-19\" title=\"19\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"at\"\u003econnect\u003c/span\u003e(mapStateToProps\u003cspan class=\"op\"\u003e,\u003c/span\u003e mapDispatchToProps)(Ranking)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\App.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cp\u003e定義したContainer Componentを使うように修正します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb155\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb155-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Ranking \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./components/Ranking\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e↓\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb156\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb156-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Ranking \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./containers/Ranking\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eReducerの実装\u003c/p\u003e\r\n\u003cp\u003eReducerを実装し、取得したデータを表示します。\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003cp\u003e\u003ccode\u003esrc\\reducers\\shopping.js\u003c/code\u003e\u003c/p\u003e\r\n\u003cp\u003eカテゴリ名、カテゴリIDを保持する。 ランキングページにもカテゴリ名を表示したいので、\u003ccode\u003esrc\\App.js\u003c/code\u003eのハードコードをこちらに移動する。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e\u003ccode\u003esrc\\reducers\\Ranking.js\u003c/code\u003e\u003c/p\u003e\r\n\u003cp\u003eRanking コンポーネント用のReducer。 ランキング情報を保持します。\u003c/p\u003e\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\reducers\\shopping.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cp\u003e固定のJSONを常に返すReducerとして実装します。\u003c/p\u003e\r\n\u003cp\u003e※本来はAPIから取得した情報を返すようにするべきです。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb157\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb157-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-2\" title=\"2\"\u003e  \u003cspan class=\"co\"\u003e// カテゴリ情報\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-3\" title=\"3\"\u003e  \u003cspan class=\"co\"\u003e// 本来はAPIから取得した情報を返すべき\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-4\" title=\"4\"\u003e  \u003cspan class=\"dt\"\u003ecategories\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e [\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-5\" title=\"5\"\u003e    \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-6\" title=\"6\"\u003e      \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-7\" title=\"7\"\u003e      \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;ALL\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-8\" title=\"8\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-9\" title=\"9\"\u003e    \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-10\" title=\"10\"\u003e      \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;2502\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-11\" title=\"11\"\u003e      \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Category 2502\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-12\" title=\"12\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-13\" title=\"13\"\u003e    \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-14\" title=\"14\"\u003e      \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;10002\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-15\" title=\"15\"\u003e      \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;Category 10002\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-16\" title=\"16\"\u003e    \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-17\" title=\"17\"\u003e  ]\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-18\" title=\"18\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-19\" title=\"19\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb157-20\" title=\"20\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e initialState\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\reducers\\Ranking.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003eSTART_REQUEST Action にフックして、リクエスト開始時に状態をリセットします。\u003c/li\u003e\r\n\u003cli\u003eRECEIVE_DATA Action にフックして、レスポンスからランキング情報を取得し、状態に設定します。 リクエストが失敗したときはエラーフラグを立てます。\u003c/li\u003e\r\n\u003cli\u003egetRanking関数は、レスポンスから商品名、商品URL、商品画像のURLを抜き出します。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb158\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb158-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// レスポンスからランキング情報だけを抜き出す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-2\" title=\"2\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e getRanking \u003cspan class=\"op\"\u003e=\u003c/span\u003e response \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-3\" title=\"3\"\u003e  \u003cspan class=\"kw\"\u003econst\u003c/span\u003e ranking \u003cspan class=\"op\"\u003e=\u003c/span\u003e []\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-4\" title=\"4\"\u003e  \u003cspan class=\"kw\"\u003econst\u003c/span\u003e itemLength \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003eresponse\u003c/span\u003e.\u003cspan class=\"va\"\u003eResultSet\u003c/span\u003e.\u003cspan class=\"at\"\u003etotalResultsReturned\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-5\" title=\"5\"\u003e  \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: p.206 ↑末尾にセミコロン必要では？\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-6\" title=\"6\"\u003e  \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: ダウンロードできるサンプルに第10章が含まれていない\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-7\" title=\"7\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-8\" title=\"8\"\u003e  \u003cspan class=\"cf\"\u003efor\u003c/span\u003e (\u003cspan class=\"kw\"\u003elet\u003c/span\u003e index \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"dv\"\u003e0\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e index \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003e itemLength\u003cspan class=\"op\"\u003e;\u003c/span\u003e index\u003cspan class=\"op\"\u003e++\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-9\" title=\"9\"\u003e    \u003cspan class=\"kw\"\u003econst\u003c/span\u003e item \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003eresponse\u003c/span\u003e.\u003cspan class=\"at\"\u003eResultSet\u003c/span\u003e[\u003cspan class=\"st\"\u003e\u0026#39;0\u0026#39;\u003c/span\u003e].\u003cspan class=\"at\"\u003eResult\u003c/span\u003e[index \u003cspan class=\"op\"\u003e+\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e]\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-10\" title=\"10\"\u003e    \u003cspan class=\"va\"\u003eranking\u003c/span\u003e.\u003cspan class=\"at\"\u003epush\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-11\" title=\"11\"\u003e      \u003cspan class=\"dt\"\u003ecode\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"at\"\u003eCode\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-12\" title=\"12\"\u003e      \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"at\"\u003eName\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-13\" title=\"13\"\u003e      \u003cspan class=\"dt\"\u003eurl\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"at\"\u003eUrl\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-14\" title=\"14\"\u003e      \u003cspan class=\"dt\"\u003eimageUrl\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"va\"\u003eImage\u003c/span\u003e.\u003cspan class=\"at\"\u003eMedium\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-15\" title=\"15\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-16\" title=\"16\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-17\" title=\"17\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e ranking\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-18\" title=\"18\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-19\" title=\"19\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-20\" title=\"20\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-21\" title=\"21\"\u003e\u003cspan class=\"co\"\u003e// 初期状態\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-22\" title=\"22\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-23\" title=\"23\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003eundefined\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-24\" title=\"24\"\u003e  \u003cspan class=\"dt\"\u003eranking\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003eundefined\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-25\" title=\"25\"\u003e  \u003cspan class=\"dt\"\u003eerror\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003efalse\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-26\" title=\"26\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-27\" title=\"27\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-28\" title=\"28\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-29\" title=\"29\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e (state \u003cspan class=\"op\"\u003e=\u003c/span\u003e initialState\u003cspan class=\"op\"\u003e,\u003c/span\u003e action) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-30\" title=\"30\"\u003e  \u003cspan class=\"cf\"\u003eswitch\u003c/span\u003e (\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"at\"\u003etype\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-31\" title=\"31\"\u003e    \u003cspan class=\"co\"\u003e// リクエスト開始時に状態をリセット\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-32\" title=\"32\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;START_REQUEST\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-33\" title=\"33\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-34\" title=\"34\"\u003e        \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-35\" title=\"35\"\u003e        \u003cspan class=\"dt\"\u003eranking\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003eundefined\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-36\" title=\"36\"\u003e        \u003cspan class=\"dt\"\u003eerror\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003efalse\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-37\" title=\"37\"\u003e      \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-38\" title=\"38\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-39\" title=\"39\"\u003e    \u003cspan class=\"co\"\u003e// データ受信\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-40\" title=\"40\"\u003e    \u003cspan class=\"cf\"\u003ecase\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;RECEIVE_DATA\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-41\" title=\"41\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003eerror\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-42\" title=\"42\"\u003e        \u003cspan class=\"op\"\u003e?\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-43\" title=\"43\"\u003e            ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-44\" title=\"44\"\u003e            \u003cspan class=\"dt\"\u003eerror\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003etrue\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-45\" title=\"45\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-46\" title=\"46\"\u003e        : \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-47\" title=\"47\"\u003e            ...\u003cspan class=\"at\"\u003estate\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-48\" title=\"48\"\u003e            \u003cspan class=\"dt\"\u003eranking\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"at\"\u003egetRanking\u003c/span\u003e(\u003cspan class=\"va\"\u003eaction\u003c/span\u003e.\u003cspan class=\"va\"\u003epayload\u003c/span\u003e.\u003cspan class=\"at\"\u003eresponse\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-49\" title=\"49\"\u003e          \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-50\" title=\"50\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-51\" title=\"51\"\u003e    \u003cspan class=\"dt\"\u003edefault\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-52\" title=\"52\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e state\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-53\" title=\"53\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb158-54\" title=\"54\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e2つのReducerの参照を [\u003ccode\u003esrc\\reducers\\index.js\u003c/code\u003e] に追加します。\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb159\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb159-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// 受け取ったstateをそのまま返すReducer\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb159-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003econst\u003c/span\u003e noop \u003cspan class=\"op\"\u003e=\u003c/span\u003e (state \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{}\u003c/span\u003e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e state\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb159-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb159-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"im\"\u003eas\u003c/span\u003e shopping \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./shopping\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb159-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"im\"\u003eas\u003c/span\u003e Ranking \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./Ranking\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\App.js\u003c/code\u003e] のリンクの部分を Nav コンポーネントに移動する。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\components\\Nav.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb160\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb160-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e PropTypes \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;prop-types\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Link \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003efunction\u003c/span\u003e \u003cspan class=\"at\"\u003eNav\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e categories \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-6\" title=\"6\"\u003e  \u003cspan class=\"co\"\u003e// 移動先パスの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-7\" title=\"7\"\u003e  \u003cspan class=\"co\"\u003e//   カテゴリID = \u0026quot;1\u0026quot; であれば \u0026quot;/all\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-8\" title=\"8\"\u003e  \u003cspan class=\"co\"\u003e//   上記以外であれば \u0026quot;/category/\u0026lt;カテゴリID\u0026gt;\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-9\" title=\"9\"\u003e  \u003cspan class=\"kw\"\u003econst\u003c/span\u003e to \u003cspan class=\"op\"\u003e=\u003c/span\u003e category \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-10\" title=\"10\"\u003e    \u003cspan class=\"va\"\u003ecategory\u003c/span\u003e.\u003cspan class=\"at\"\u003eid\u003c/span\u003e \u003cspan class=\"op\"\u003e===\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-11\" title=\"11\"\u003e      \u003cspan class=\"op\"\u003e?\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;/all\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-12\" title=\"12\"\u003e      : \u003cspan class=\"vs\"\u003e`/category/\u003c/span\u003e\u003cspan class=\"sc\"\u003e${\u003c/span\u003e\u003cspan class=\"va\"\u003ecategory\u003c/span\u003e.\u003cspan class=\"at\"\u003eid\u003c/span\u003e\u003cspan class=\"sc\"\u003e}\u003c/span\u003e\u003cspan class=\"vs\"\u003e`\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-13\" title=\"13\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-14\" title=\"14\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-15\" title=\"15\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-16\" title=\"16\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-17\" title=\"17\"\u003e      \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"co\"\u003e/* props.categories からリンク一覧を生成 */\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-18\" title=\"18\"\u003e      \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"va\"\u003ecategories\u003c/span\u003e.\u003cspan class=\"at\"\u003emap\u003c/span\u003e(category \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-19\" title=\"19\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli key\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"vs\"\u003e`nav-item-\u003c/span\u003e\u003cspan class=\"sc\"\u003e${\u003c/span\u003e\u003cspan class=\"va\"\u003ecategory\u003c/span\u003e.\u003cspan class=\"at\"\u003eid\u003c/span\u003e\u003cspan class=\"sc\"\u003e}\u003c/span\u003e\u003cspan class=\"vs\"\u003e`\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-20\" title=\"20\"\u003e          \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eLink to\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"at\"\u003eto\u003c/span\u003e(category)\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-21\" title=\"21\"\u003e            \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"va\"\u003ecategory\u003c/span\u003e.\u003cspan class=\"at\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-22\" title=\"22\"\u003e          \u0026lt;/Link\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-23\" title=\"23\"\u003e        \u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-24\" title=\"24\"\u003e      ))\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-25\" title=\"25\"\u003e    \u0026lt;/ul\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-26\" title=\"26\"\u003e  )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-27\" title=\"27\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-28\" title=\"28\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-29\" title=\"29\"\u003e\u003cspan class=\"va\"\u003eNav\u003c/span\u003e.\u003cspan class=\"at\"\u003epropTypes\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-30\" title=\"30\"\u003e  \u003cspan class=\"co\"\u003e// state.shopping.categories の構造\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-31\" title=\"31\"\u003e  \u003cspan class=\"dt\"\u003ecategories\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003earrayOf\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-32\" title=\"32\"\u003e    \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eshape\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-33\" title=\"33\"\u003e      \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-34\" title=\"34\"\u003e      \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-35\" title=\"35\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-36\" title=\"36\"\u003e  ).\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb160-37\" title=\"37\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eNav コンポーネントの Container Component を作成します。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\containers\\Nav.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb161\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb161-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e connect \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb161-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Nav \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;../components/Nav\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb161-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb161-4\" title=\"4\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e mapStateToProps \u003cspan class=\"op\"\u003e=\u003c/span\u003e state \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb161-5\" title=\"5\"\u003e  \u003cspan class=\"co\"\u003e// state.shopping.categories を props.categories に関連付ける\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb161-6\" title=\"6\"\u003e  \u003cspan class=\"dt\"\u003ecategories\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"va\"\u003eshopping\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategories\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb161-7\" title=\"7\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb161-8\" title=\"8\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb161-9\" title=\"9\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"at\"\u003econnect\u003c/span\u003e(mapStateToProps)(Nav)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eApp コンポーネントに Nav コンポーネントを組み込みます。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\App.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb162\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb162-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Component \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Route\u003cspan class=\"op\"\u003e,\u003c/span\u003e Switch\u003cspan class=\"op\"\u003e,\u003c/span\u003e Redirect \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-dom\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Ranking \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./containers/Ranking\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e Nav \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./containers/Nav\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-6\" title=\"6\"\u003e\u003cspan class=\"kw\"\u003eclass\u003c/span\u003e App \u003cspan class=\"kw\"\u003eextends\u003c/span\u003e Component \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-7\" title=\"7\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-8\" title=\"8\"\u003e    \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-9\" title=\"9\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;App\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-10\" title=\"10\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"co\"\u003e/* Nav コンポーネントに差し替える */\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-11\" title=\"11\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"co\"\u003e/*\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-12\" title=\"12\"\u003e\u003cspan class=\"co\"\u003e        \u0026lt;ul\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-13\" title=\"13\"\u003e\u003cspan class=\"co\"\u003e          \u0026lt;li\u0026gt;\u0026lt;Link to=\u0026quot;/all\u0026quot;\u0026gt;Category All\u0026lt;/Link\u0026gt;\u0026lt;/li\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-14\" title=\"14\"\u003e\u003cspan class=\"co\"\u003e          \u0026lt;li\u0026gt;\u0026lt;Link to=\u0026quot;/category/2502\u0026quot;\u0026gt;Category 2502\u0026lt;/Link\u0026gt;\u0026lt;/li\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-15\" title=\"15\"\u003e\u003cspan class=\"co\"\u003e          \u0026lt;li\u0026gt;\u0026lt;Link to=\u0026quot;/category/10002\u0026quot;\u0026gt;Category 10002\u0026lt;/Link\u0026gt;\u0026lt;/li\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-16\" title=\"16\"\u003e\u003cspan class=\"co\"\u003e        \u0026lt;/ul\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-17\" title=\"17\"\u003e\u003cspan class=\"co\"\u003e        */\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-18\" title=\"18\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eNav /\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-19\" title=\"19\"\u003e        \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-20\" title=\"20\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eSwitch\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-21\" title=\"21\"\u003e          \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/all\u0026quot;\u003c/span\u003e component\u003cspan class=\"op\"\u003e={\u003c/span\u003eRanking\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-22\" title=\"22\"\u003e          \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-23\" title=\"23\"\u003e            path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/category/1\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-24\" title=\"24\"\u003e            render\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-25\" title=\"25\"\u003e              () \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRedirect to\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/all\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-26\" title=\"26\"\u003e            \u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-27\" title=\"27\"\u003e          \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-28\" title=\"28\"\u003e            path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/category/:id\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-29\" title=\"29\"\u003e            render\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-30\" title=\"30\"\u003e              (\u003cspan class=\"op\"\u003e{\u003c/span\u003e match \u003cspan class=\"op\"\u003e}\u003c/span\u003e) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRanking categoryId\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"va\"\u003ematch\u003c/span\u003e.\u003cspan class=\"va\"\u003eparams\u003c/span\u003e.\u003cspan class=\"at\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-31\" title=\"31\"\u003e            \u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-32\" title=\"32\"\u003e        \u0026lt;/Switch\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-33\" title=\"33\"\u003e      \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-34\" title=\"34\"\u003e    )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-35\" title=\"35\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-36\" title=\"36\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-37\" title=\"37\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb162-38\" title=\"38\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e App\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e機能拡張\u003c/p\u003e\r\n\u003cul\u003e\r\n\u003cli\u003estate.shopping.categoriesにないカテゴリIDへのアクセスは、トップページにリダイレクトする。\u003c/li\u003e\r\n\u003cli\u003eカテゴリ名を表示\u003c/li\u003e\r\n\u003cli\u003eランキング情報の表示\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\actions\\Ranking.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb163\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb163-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e fetchJsonp \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;fetch-jsonp\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e qs \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;qs\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-3\" title=\"3\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e replace \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-4\" title=\"4\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-5\" title=\"5\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e API_URL \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;http://hoge.co.jp/v1/json/hoge\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: api のURL\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-6\" title=\"6\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e APP_ID \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;APP_ID\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e                          \u003cspan class=\"co\"\u003e// \u003c/span\u003e\u003cspan class=\"al\"\u003eTODO\u003c/span\u003e\u003cspan class=\"co\"\u003e: 不要だが定義しておく\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-7\" title=\"7\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-8\" title=\"8\"\u003e\u003cspan class=\"co\"\u003e// リクエスト開始 Action\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-9\" title=\"9\"\u003e\u003cspan class=\"co\"\u003e// categoryId ではなく category を含めるように変更\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-10\" title=\"10\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e startRequest \u003cspan class=\"op\"\u003e=\u003c/span\u003e category \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-11\" title=\"11\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;START_REQUEST\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-12\" title=\"12\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e category \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-13\" title=\"13\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-14\" title=\"14\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-15\" title=\"15\"\u003e\u003cspan class=\"co\"\u003e// レスポンス受信 Action\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-16\" title=\"16\"\u003e\u003cspan class=\"co\"\u003e// categoryId ではなく category を含めるように変更\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-17\" title=\"17\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e receiveData \u003cspan class=\"op\"\u003e=\u003c/span\u003e (category\u003cspan class=\"op\"\u003e,\u003c/span\u003e error\u003cspan class=\"op\"\u003e,\u003c/span\u003e response) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-18\" title=\"18\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;RECEIVE_DATA\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-19\" title=\"19\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e category\u003cspan class=\"op\"\u003e,\u003c/span\u003e error\u003cspan class=\"op\"\u003e,\u003c/span\u003e response \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-20\" title=\"20\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-21\" title=\"21\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-22\" title=\"22\"\u003e\u003cspan class=\"co\"\u003e// リクエスト完了 Action\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-23\" title=\"23\"\u003e\u003cspan class=\"co\"\u003e// categoryId ではなく category を含めるように変更\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-24\" title=\"24\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e finishRequest \u003cspan class=\"op\"\u003e=\u003c/span\u003e category \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-25\" title=\"25\"\u003e  \u003cspan class=\"dt\"\u003etype\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;FINISH_REQUEST\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-26\" title=\"26\"\u003e  \u003cspan class=\"dt\"\u003epayload\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e category \u003cspan class=\"op\"\u003e},\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-27\" title=\"27\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-28\" title=\"28\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-29\" title=\"29\"\u003e\u003cspan class=\"co\"\u003e// データ取得\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-30\" title=\"30\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"kw\"\u003econst\u003c/span\u003e fetchRanking \u003cspan class=\"op\"\u003e=\u003c/span\u003e categoryId \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-31\" title=\"31\"\u003e  \u003cspan class=\"co\"\u003e// redux-thunkを使った非同期処理\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-32\" title=\"32\"\u003e  \u003cspan class=\"co\"\u003e// getState関数を引数に追加する\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-33\" title=\"33\"\u003e  \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"at\"\u003easync\u003c/span\u003e (dispatch\u003cspan class=\"op\"\u003e,\u003c/span\u003e getState) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-34\" title=\"34\"\u003e    \u003cspan class=\"co\"\u003e// カテゴリIDに対応する state.shopping.categories の要素を取得\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-35\" title=\"35\"\u003e    \u003cspan class=\"kw\"\u003econst\u003c/span\u003e categories \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003egetState\u003c/span\u003e().\u003cspan class=\"va\"\u003eshopping\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategories\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-36\" title=\"36\"\u003e    \u003cspan class=\"kw\"\u003econst\u003c/span\u003e category \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003ecategories\u003c/span\u003e.\u003cspan class=\"at\"\u003efind\u003c/span\u003e(category \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"va\"\u003ecategory\u003c/span\u003e.\u003cspan class=\"at\"\u003eid\u003c/span\u003e \u003cspan class=\"op\"\u003e===\u003c/span\u003e categoryId))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-37\" title=\"37\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-38\" title=\"38\"\u003e    \u003cspan class=\"co\"\u003e// 対応する情報がなければトップページへリダイレクト\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-39\" title=\"39\"\u003e    \u003cspan class=\"cf\"\u003eif\u003c/span\u003e (\u003cspan class=\"kw\"\u003etypeof\u003c/span\u003e category \u003cspan class=\"op\"\u003e===\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;undefined\u0026quot;\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-40\" title=\"40\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003ereplace\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-41\" title=\"41\"\u003e      \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-42\" title=\"42\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-43\" title=\"43\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-44\" title=\"44\"\u003e    \u003cspan class=\"co\"\u003e// startRequest Action の引数に category を受け渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-45\" title=\"45\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003estartRequest\u003c/span\u003e(category))\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-46\" title=\"46\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-47\" title=\"47\"\u003e    \u003cspan class=\"kw\"\u003econst\u003c/span\u003e queryString \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"va\"\u003eqs\u003c/span\u003e.\u003cspan class=\"at\"\u003estringify\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-48\" title=\"48\"\u003e      \u003cspan class=\"dt\"\u003eappid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e APP_ID\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-49\" title=\"49\"\u003e      \u003cspan class=\"dt\"\u003ecategory_id\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e categoryId\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-50\" title=\"50\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-51\" title=\"51\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-52\" title=\"52\"\u003e    \u003cspan class=\"cf\"\u003etry\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-53\" title=\"53\"\u003e      \u003cspan class=\"kw\"\u003econst\u003c/span\u003e response \u003cspan class=\"op\"\u003e=\u003c/span\u003e await \u003cspan class=\"at\"\u003efetchJsonp\u003c/span\u003e(\u003cspan class=\"vs\"\u003e`\u003c/span\u003e\u003cspan class=\"sc\"\u003e${\u003c/span\u003eAPI_URL\u003cspan class=\"sc\"\u003e}\u003c/span\u003e\u003cspan class=\"vs\"\u003e?\u003c/span\u003e\u003cspan class=\"sc\"\u003e${\u003c/span\u003equeryString\u003cspan class=\"sc\"\u003e}\u003c/span\u003e\u003cspan class=\"vs\"\u003e`\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-54\" title=\"54\"\u003e      \u003cspan class=\"kw\"\u003econst\u003c/span\u003e data \u003cspan class=\"op\"\u003e=\u003c/span\u003e await \u003cspan class=\"va\"\u003eresponse\u003c/span\u003e.\u003cspan class=\"at\"\u003ejson\u003c/span\u003e()\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-55\" title=\"55\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003ereceiveData\u003c/span\u003e(category\u003cspan class=\"op\"\u003e,\u003c/span\u003e \u003cspan class=\"kw\"\u003enull\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e data))\u003cspan class=\"op\"\u003e;\u003c/span\u003e  \u003cspan class=\"co\"\u003e// categoryId ではなく category を受け渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-56\" title=\"56\"\u003e      \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-57\" title=\"57\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"cf\"\u003ecatch\u003c/span\u003e (ex) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-58\" title=\"58\"\u003e      \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003ereceiveData\u003c/span\u003e(category\u003cspan class=\"op\"\u003e,\u003c/span\u003e ex))\u003cspan class=\"op\"\u003e;\u003c/span\u003e  \u003cspan class=\"co\"\u003e// categoryId ではなく category を受け渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-59\" title=\"59\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-60\" title=\"60\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-61\" title=\"61\"\u003e    \u003cspan class=\"at\"\u003edispatch\u003c/span\u003e(\u003cspan class=\"at\"\u003efinishRequest\u003c/span\u003e(category))\u003cspan class=\"op\"\u003e;\u003c/span\u003e      \u003cspan class=\"co\"\u003e// categoryId ではなく category を受け渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-62\" title=\"62\"\u003e  \u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb163-63\" title=\"63\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003e修正したActionに対応できるように、Reducerを変更します。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\reducers\\Ranking.js\u003c/code\u003e] （変更する initialState の部分のみ抜粋）\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb164\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb164-1\" title=\"1\"\u003e\u003cspan class=\"co\"\u003e// 初期状態\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb164-2\" title=\"2\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e initialState \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb164-3\" title=\"3\"\u003e  \u003cspan class=\"co\"\u003e// categoryId → category\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb164-4\" title=\"4\"\u003e  \u003cspan class=\"dt\"\u003ecategory\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003eundefined\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb164-5\" title=\"5\"\u003e  \u003cspan class=\"dt\"\u003eranking\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003eundefined\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb164-6\" title=\"6\"\u003e  \u003cspan class=\"dt\"\u003eerror\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"kw\"\u003efalse\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb164-7\" title=\"7\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eRankingコンポーネントと Store の状態を関連付けます。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\containers\\Ranking.js\u003c/code\u003e] （mapStateToProps の部分のみ抜粋）\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb165\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb165-1\" title=\"1\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e mapStateToProps \u003cspan class=\"op\"\u003e=\u003c/span\u003e (state\u003cspan class=\"op\"\u003e,\u003c/span\u003e ownProps) \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb165-2\" title=\"2\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003eownProps\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb165-3\" title=\"3\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb165-4\" title=\"4\"\u003e  \u003cspan class=\"co\"\u003e// カテゴリ情報、ランキング情報を Ranking コンポーネントに渡す\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb165-5\" title=\"5\"\u003e  \u003cspan class=\"dt\"\u003ecategory\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategory\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb165-6\" title=\"6\"\u003e  \u003cspan class=\"dt\"\u003eranking\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003eranking\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb165-7\" title=\"7\"\u003e  \u003cspan class=\"dt\"\u003eerror\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003estate\u003c/span\u003e.\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003eerror\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb165-8\" title=\"8\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003cp\u003eRankingコンポーネントは、受け取ったカテゴリ情報、ランキング情報、エラーフラグを表示します。\u003c/p\u003e\r\n\u003cp\u003e[\u003ccode\u003esrc\\components\\Ranking.js\u003c/code\u003e]\u003c/p\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb166\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb166-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e PropTypes \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;prop-types\u0026#39;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eexport\u003c/span\u003e \u003cspan class=\"im\"\u003edefault\u003c/span\u003e \u003cspan class=\"kw\"\u003eclass\u003c/span\u003e Ranking \u003cspan class=\"kw\"\u003eextends\u003c/span\u003e \u003cspan class=\"va\"\u003eReact\u003c/span\u003e.\u003cspan class=\"at\"\u003eComponent\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-5\" title=\"5\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-6\" title=\"6\"\u003e  \u003cspan class=\"at\"\u003ecomponentWillMount\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-7\" title=\"7\"\u003e    \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003eonMount\u003c/span\u003e(\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-8\" title=\"8\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-9\" title=\"9\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-10\" title=\"10\"\u003e  \u003cspan class=\"at\"\u003ecomponentWillReceiveProps\u003c/span\u003e(nextProps) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-11\" title=\"11\"\u003e    \u003cspan class=\"cf\"\u003eif\u003c/span\u003e (\u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e \u003cspan class=\"op\"\u003e!==\u003c/span\u003e \u003cspan class=\"va\"\u003enextProps\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-12\" title=\"12\"\u003e      \u003cspan class=\"co\"\u003e// props.categoryId に変化があるので、ページ移動が発生している\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-13\" title=\"13\"\u003e      \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"va\"\u003eprops\u003c/span\u003e.\u003cspan class=\"at\"\u003eonUpdate\u003c/span\u003e(\u003cspan class=\"va\"\u003enextProps\u003c/span\u003e.\u003cspan class=\"at\"\u003ecategoryId\u003c/span\u003e)\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-14\" title=\"14\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-15\" title=\"15\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-16\" title=\"16\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-17\" title=\"17\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e() \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-18\" title=\"18\"\u003e    \u003cspan class=\"kw\"\u003econst\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e category\u003cspan class=\"op\"\u003e,\u003c/span\u003e ranking\u003cspan class=\"op\"\u003e,\u003c/span\u003e error \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"kw\"\u003ethis\u003c/span\u003e.\u003cspan class=\"at\"\u003eprops\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-19\" title=\"19\"\u003e    \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-20\" title=\"20\"\u003e    \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-21\" title=\"21\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-22\" title=\"22\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eh2\u003cspan class=\"op\"\u003e\u0026gt;{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-23\" title=\"23\"\u003e          \u003cspan class=\"kw\"\u003etypeof\u003c/span\u003e category \u003cspan class=\"op\"\u003e!==\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;undefined\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-24\" title=\"24\"\u003e            \u003cspan class=\"op\"\u003e?\u003c/span\u003e \u003cspan class=\"vs\"\u003e`Ranking: \u003c/span\u003e\u003cspan class=\"sc\"\u003e${\u003c/span\u003e\u003cspan class=\"va\"\u003ecategory\u003c/span\u003e.\u003cspan class=\"at\"\u003ename\u003c/span\u003e\u003cspan class=\"sc\"\u003e}\u003c/span\u003e\u003cspan class=\"vs\"\u003e`\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-25\" title=\"25\"\u003e            : \u003cspan class=\"st\"\u003e\u0026quot;\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-26\" title=\"26\"\u003e        \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/h2\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-27\" title=\"27\"\u003e        \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-28\" title=\"28\"\u003e        \u003cspan class=\"op\"\u003e{\u003c/span\u003e(() \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-29\" title=\"29\"\u003e          \u003cspan class=\"cf\"\u003eif\u003c/span\u003e (error) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-30\" title=\"30\"\u003e            \u003cspan class=\"co\"\u003e// エラー表示\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-31\" title=\"31\"\u003e            \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ep\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eエラーが発生しました。リロードしてください。\u0026lt;/p\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-32\" title=\"32\"\u003e            \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-33\" title=\"33\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"cf\"\u003eelse\u003c/span\u003e \u003cspan class=\"cf\"\u003eif\u003c/span\u003e (\u003cspan class=\"kw\"\u003etypeof\u003c/span\u003e ranking \u003cspan class=\"op\"\u003e===\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;undefined\u0026quot;\u003c/span\u003e) \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-34\" title=\"34\"\u003e            \u003cspan class=\"co\"\u003e// リクエスト完了前\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-35\" title=\"35\"\u003e            \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ep\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"va\"\u003e読み込み中\u003c/span\u003e...\u0026lt;/p\u003cspan class=\"op\"\u003e\u0026gt;;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-36\" title=\"36\"\u003e            \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-37\" title=\"37\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"cf\"\u003eelse\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-38\" title=\"38\"\u003e            \u003cspan class=\"co\"\u003e// ランキングの表示\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-39\" title=\"39\"\u003e            \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-40\" title=\"40\"\u003e              \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eol\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-41\" title=\"41\"\u003e                \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003cspan class=\"va\"\u003eranking\u003c/span\u003e.\u003cspan class=\"at\"\u003emap\u003c/span\u003e(item \u003cspan class=\"op\"\u003e=\u0026gt;\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-42\" title=\"42\"\u003e                  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eli key\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"vs\"\u003e`ranking-item-\u003c/span\u003e\u003cspan class=\"sc\"\u003e${\u003c/span\u003e\u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"at\"\u003ecode\u003c/span\u003e\u003cspan class=\"sc\"\u003e}\u003c/span\u003e\u003cspan class=\"vs\"\u003e`\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-43\" title=\"43\"\u003e                    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eimg alt\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"at\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e src\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"at\"\u003eimageUrl\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-44\" title=\"44\"\u003e                    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ea href\u003cspan class=\"op\"\u003e={\u003c/span\u003e\u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"at\"\u003eurl\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e target\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;_blank\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;{\u003c/span\u003e\u003cspan class=\"va\"\u003eitem\u003c/span\u003e.\u003cspan class=\"at\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u0026lt;/a\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-45\" title=\"45\"\u003e                  \u0026lt;/li\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-46\" title=\"46\"\u003e                ))\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-47\" title=\"47\"\u003e              \u0026lt;/ol\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-48\" title=\"48\"\u003e            )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-49\" title=\"49\"\u003e          \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-50\" title=\"50\"\u003e        \u003cspan class=\"op\"\u003e}\u003c/span\u003e)()\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-51\" title=\"51\"\u003e      \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-52\" title=\"52\"\u003e    )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-53\" title=\"53\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-54\" title=\"54\"\u003e\u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-55\" title=\"55\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-56\" title=\"56\"\u003e\u003cspan class=\"co\"\u003e// propsのデータ型を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-57\" title=\"57\"\u003e\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003epropTypes\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-58\" title=\"58\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003estring\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-59\" title=\"59\"\u003e  \u003cspan class=\"dt\"\u003eonMount\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003efunc\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-60\" title=\"60\"\u003e  \u003cspan class=\"dt\"\u003eonUpdate\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003efunc\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-61\" title=\"61\"\u003e  \u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-62\" title=\"62\"\u003e  \u003cspan class=\"co\"\u003e// category, ranking, error の型を追加\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-63\" title=\"63\"\u003e  \u003cspan class=\"dt\"\u003ecategory\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eshape\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-64\" title=\"64\"\u003e    \u003cspan class=\"dt\"\u003eid\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-65\" title=\"65\"\u003e    \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-66\" title=\"66\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-67\" title=\"67\"\u003e  \u003cspan class=\"dt\"\u003eranking\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003earrayOf\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-68\" title=\"68\"\u003e    \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"at\"\u003eshape\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-69\" title=\"69\"\u003e      \u003cspan class=\"dt\"\u003ecode\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-70\" title=\"70\"\u003e      \u003cspan class=\"dt\"\u003ename\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-71\" title=\"71\"\u003e      \u003cspan class=\"dt\"\u003eurl\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-72\" title=\"72\"\u003e      \u003cspan class=\"dt\"\u003eimageUrl\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003estring\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-73\" title=\"73\"\u003e    \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-74\" title=\"74\"\u003e  )\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-75\" title=\"75\"\u003e  \u003cspan class=\"dt\"\u003eerror\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"va\"\u003ePropTypes\u003c/span\u003e.\u003cspan class=\"va\"\u003ebool\u003c/span\u003e.\u003cspan class=\"at\"\u003eisRequired\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-76\" title=\"76\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-77\" title=\"77\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-78\" title=\"78\"\u003e\u003cspan class=\"co\"\u003e// 未指定時の既定値を定義\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-79\" title=\"79\"\u003e\u003cspan class=\"va\"\u003eRanking\u003c/span\u003e.\u003cspan class=\"at\"\u003edefaultProps\u003c/span\u003e \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-80\" title=\"80\"\u003e  \u003cspan class=\"dt\"\u003ecategoryId\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;1\u0026quot;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb166-81\" title=\"81\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003ch2 id=\"日付を扱う\"\u003e日付を扱う\u003c/h2\u003e\r\n\u003cp\u003e\u003ccode\u003ereact-moment\u003c/code\u003eを使います。 \u003ccode\u003emoment\u003c/code\u003eを使ったReactコンポーネントです。\u003c/p\u003e\r\n\u003ch3 id=\"インストール-3\"\u003eインストール\u003c/h3\u003e\r\n\u003cpre\u003e\u003ccode\u003enpm install --save moment react-moment\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eタイムゾーンを指定するのであれば、こちらのパッケージもインストールします。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003enpm install --save moment-timezone\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch2 id=\"note-react-router\"\u003eNote: React Router\u003c/h2\u003e\r\n\u003cp\u003eRouter : すべてのRouterコンポーネントに共通する低レベルインターフェース。根底クラスみたいなもんだと思えばよいでしょう。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003e一般的にアプリでは次のRouterのうち、ひとつを使います。\r\n\r\n- BrowserRouter\r\n- HashRouter\r\n- MemoryRouter\r\n- NativeRouter\r\n- StaticRouter\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003cp\u003eBrowserRouter : HTML5 の history API を使って、URLとUIを同期するRouterコンポーネント。\u003c/p\u003e\r\n\u003cp\u003eHashRouter : URLのハッシュ（＝window.location.hash）を使って、URLとUIを同期するRouterコンポーネント。\u003c/p\u003e\r\n\u003cp\u003eLink : ナビゲーションコンポーネント。\u003c/p\u003e\r\n\u003cp\u003eNavLink : 見た目（スタイルの属性）ができるLinkコンポーネント。\u003c/p\u003e\r\n\u003cp\u003eRoute : パスと一致するときに、コンポーネントを描画するコンポーネント。\u003c/p\u003e\r\n\u003cpre\u003e\u003ccode\u003eRenderコンポーネントを使って、コンポーネントを描画するには次の3つの方法があります。\r\nが、ほとんどのケースで使うことになるのは、`\u0026lt;Route component\u0026gt;`でしょう。\r\n\r\n- `\u0026lt;Route component\u0026gt;`\r\n\r\n    パスが一致したときに、指定したコンポーネントを描画します。\r\n    \r\n    ~~~javascript\r\n    // Helloコンポーネントを描画\r\n    \u0026lt;Route path=\u0026quot;/hello\u0026quot; component={Hello}/\u0026gt;\r\n    ~~~\r\n\r\n- `\u0026lt;Route render\u0026gt;`\r\n\r\n    パスが一致したときに、render関数に従い描画します。\r\n    \r\n    ~~~javascript\r\n    \u0026lt;Route path=\u0026quot;/hello\u0026quot; render={() =\u0026gt; \u0026lt;div\u0026gt;Hello\u0026lt;/div\u0026gt;}/\u0026gt;\r\n    ~~~\r\n\r\n- `\u0026lt;Route children\u0026gt;`\r\n\r\n    パスが一致するかどうかを描画するときに使います。\r\n    \r\n    `children`の関数の引数 `match`には、パスが一致したときはオブジェクト、それ以外は null が渡されます。\r\n    \r\n    [`match`の詳細は公式ドキュメントを参照。](https://reacttraining.com/react-router/web/api/match){target=\u0026quot;_blank\u0026quot;}\r\n    \r\n    ~~~javascript\r\n    \u0026lt;ul\u0026gt;\r\n      \u0026lt;ListItemLink to=\u0026quot;/somewhere\u0026quot;/\u0026gt;\r\n      \u0026lt;ListItemLink to=\u0026quot;/somewhere-else\u0026quot;/\u0026gt;\r\n    \u0026lt;/ul\u0026gt;\r\n\r\n    const ListItemLink = ({ to, ...rest }) =\u0026gt; (\r\n      \u0026lt;Route path={to} children={({ match }) =\u0026gt; (\r\n        \u0026lt;li className={match ? \u0026#39;active\u0026#39; : \u0026#39;\u0026#39;}\u0026gt;\r\n          \u0026lt;Link to={to} {...rest}/\u0026gt;\r\n        \u0026lt;/li\u0026gt;\r\n      )}/\u0026gt;\r\n    )\r\n    ~~~\r\n\r\n\r\nすべての方法で、次の3つのpropsが渡されます。\r\n\r\n- match\r\n- location\r\n- history\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch2 id=\"react-router-redux\"\u003eReact Router Redux\u003c/h2\u003e\r\n\u003ch3 id=\"基本的な考え方\"\u003e基本的な考え方\u003c/h3\u003e\r\n\u003col\u003e\r\n\u003cli\u003e\u003cp\u003ehistory を作ります。\u003cbr /\u003e\r\nHTML5 の history API を使うか、URLハッシュを使うか選べます。\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003eミドルウェアを構築します。\u003cbr /\u003e\r\nナビゲーションアクションのインターセプトとディスパッチのためのミドルウェアを構築。 噛み砕いて言うと？\u003c/p\u003e\u003c/li\u003e\r\n\u003cli\u003e\u003cp\u003e\u003ccode\u003ecreateStore\u003c/code\u003e関数にReducerとMiddlewareを適用します。\u003cbr /\u003e\r\nReducerの指定は「router」キーに「routerReducer」を指定します。\u003c/p\u003e\u003c/li\u003e\r\n\u003c/ol\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb171\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb171-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e ReactDOM \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-dom\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-4\" title=\"4\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e createStore\u003cspan class=\"op\"\u003e,\u003c/span\u003e combineReducers\u003cspan class=\"op\"\u003e,\u003c/span\u003e applyMiddleware \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;redux\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-5\" title=\"5\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Provider \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-redux\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-6\" title=\"6\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-7\" title=\"7\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e createHistory \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;history/createBrowserHistory\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-8\" title=\"8\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e Route \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-9\" title=\"9\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-10\" title=\"10\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e ConnectedRouter\u003cspan class=\"op\"\u003e,\u003c/span\u003e routerReducer\u003cspan class=\"op\"\u003e,\u003c/span\u003e routerMiddleware\u003cspan class=\"op\"\u003e,\u003c/span\u003e push \u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;react-router-redux\u0026#39;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-11\" title=\"11\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-12\" title=\"12\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e reducers \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026#39;./reducers\u0026#39;\u003c/span\u003e \u003cspan class=\"co\"\u003e// Or wherever you keep your reducers\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-13\" title=\"13\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-14\" title=\"14\"\u003e\u003cspan class=\"co\"\u003e// (1) history の生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-15\" title=\"15\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e history \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateHistory\u003c/span\u003e()\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-16\" title=\"16\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-17\" title=\"17\"\u003e\u003cspan class=\"co\"\u003e// (2) ミドルウェアを構築\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-18\" title=\"18\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e middleware \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003erouterMiddleware\u003c/span\u003e(history)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-19\" title=\"19\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-20\" title=\"20\"\u003e\u003cspan class=\"co\"\u003e// (3) storeの生成\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-21\" title=\"21\"\u003e\u003cspan class=\"co\"\u003e//      ・Reducerを指定します。router キーに routerReducer を指定します。\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-22\" title=\"22\"\u003e\u003cspan class=\"co\"\u003e//      ・構築したミドルウェアを適用します。\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-23\" title=\"23\"\u003e\u003cspan class=\"kw\"\u003econst\u003c/span\u003e store \u003cspan class=\"op\"\u003e=\u003c/span\u003e \u003cspan class=\"at\"\u003ecreateStore\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-24\" title=\"24\"\u003e  \u003cspan class=\"at\"\u003ecombineReducers\u003c/span\u003e(\u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-25\" title=\"25\"\u003e    ...\u003cspan class=\"at\"\u003ereducers\u003c/span\u003e\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-26\" title=\"26\"\u003e    \u003cspan class=\"dt\"\u003erouter\u003c/span\u003e\u003cspan class=\"op\"\u003e:\u003c/span\u003e routerReducer\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-27\" title=\"27\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e)\u003cspan class=\"op\"\u003e,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-28\" title=\"28\"\u003e  \u003cspan class=\"at\"\u003eapplyMiddleware\u003c/span\u003e(middleware)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-29\" title=\"29\"\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-30\" title=\"30\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-31\" title=\"31\"\u003e\u003cspan class=\"co\"\u003e// これでどこからでもナビゲーションのアクションを送信できます。\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-32\" title=\"32\"\u003e\u003cspan class=\"co\"\u003e// store.dispatch(push(\u0026#39;/foo\u0026#39;))\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-33\" title=\"33\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-34\" title=\"34\"\u003e\u003cspan class=\"va\"\u003eReactDOM\u003c/span\u003e.\u003cspan class=\"at\"\u003erender\u003c/span\u003e(\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-35\" title=\"35\"\u003e  \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eProvider store\u003cspan class=\"op\"\u003e={\u003c/span\u003estore\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-36\" title=\"36\"\u003e    \u003cspan class=\"op\"\u003e{\u003c/span\u003e \u003cspan class=\"co\"\u003e/* ConnectedRouter は Provider コンポーネントに store を自動で使います */\u003c/span\u003e \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-37\" title=\"37\"\u003e    \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eConnectedRouter history\u003cspan class=\"op\"\u003e={\u003c/span\u003ehistory\u003cspan class=\"op\"\u003e}\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-38\" title=\"38\"\u003e      \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-39\" title=\"39\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute exact path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/\u0026quot;\u003c/span\u003e component\u003cspan class=\"op\"\u003e={\u003c/span\u003eHome\u003cspan class=\"op\"\u003e}\u003c/span\u003e/\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-40\" title=\"40\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/about\u0026quot;\u003c/span\u003e component\u003cspan class=\"op\"\u003e={\u003c/span\u003eAbout\u003cspan class=\"op\"\u003e}\u003c/span\u003e/\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-41\" title=\"41\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eRoute path\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;/topics\u0026quot;\u003c/span\u003e component\u003cspan class=\"op\"\u003e={\u003c/span\u003eTopics\u003cspan class=\"op\"\u003e}\u003c/span\u003e/\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-42\" title=\"42\"\u003e      \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-43\" title=\"43\"\u003e    \u0026lt;/ConnectedRouter\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-44\" title=\"44\"\u003e  \u0026lt;/Provider\u003cspan class=\"op\"\u003e\u0026gt;,\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-45\" title=\"45\"\u003e  \u003cspan class=\"va\"\u003edocument\u003c/span\u003e.\u003cspan class=\"at\"\u003egetElementById\u003c/span\u003e(\u003cspan class=\"st\"\u003e\u0026#39;root\u0026#39;\u003c/span\u003e)\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb171-46\" title=\"46\"\u003e)\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\u003ch2 id=\"head要素内の各要素を書き換える\"\u003ehead要素内の各要素を書き換える\u003c/h2\u003e\r\n\u003cp\u003eReact Helmet パッケージを使います。\u003c/p\u003e\r\n\u003ch3 id=\"実施環境-1\"\u003e実施環境\u003c/h3\u003e\r\n\u003cul\u003e\r\n\u003cli\u003ereact-helmet 5.2.0\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003ch3 id=\"インストール-4\"\u003eインストール\u003c/h3\u003e\r\n\u003cpre\u003e\u003ccode\u003e\u0026gt; npm install --save react-helmet\r\n\u003c/code\u003e\u003c/pre\u003e\r\n\u003ch3 id=\"使い方-1\"\u003e使い方\u003c/h3\u003e\r\n\u003cul\u003e\r\n\u003cli\u003e\u003ccode\u003ereact-helmet\u003c/code\u003eパッケージをインポートします。\u003c/li\u003e\r\n\u003cli\u003e\u003ccode\u003eHelmet\u003c/code\u003eコンポーネントの子要素に書き換える要素を指定します。\u003c/li\u003e\r\n\u003c/ul\u003e\r\n\u003cdiv class=\"sourceCode\" id=\"cb173\"\u003e\u003cpre class=\"sourceCode javascript\"\u003e\u003ccode class=\"sourceCode javascript\"\u003e\u003ca class=\"sourceLine\" id=\"cb173-1\" title=\"1\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e React \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;react\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-2\" title=\"2\"\u003e\u003cspan class=\"im\"\u003eimport\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003eHelmet\u003cspan class=\"op\"\u003e}\u003c/span\u003e \u003cspan class=\"im\"\u003efrom\u003c/span\u003e \u003cspan class=\"st\"\u003e\u0026quot;react-helmet\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-3\" title=\"3\"\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-4\" title=\"4\"\u003e\u003cspan class=\"kw\"\u003eclass\u003c/span\u003e Application \u003cspan class=\"kw\"\u003eextends\u003c/span\u003e \u003cspan class=\"va\"\u003eReact\u003c/span\u003e.\u003cspan class=\"at\"\u003eComponent\u003c/span\u003e \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-5\" title=\"5\"\u003e  \u003cspan class=\"at\"\u003erender\u003c/span\u003e () \u003cspan class=\"op\"\u003e{\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-6\" title=\"6\"\u003e    \u003cspan class=\"cf\"\u003ereturn\u003c/span\u003e (\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-7\" title=\"7\"\u003e        \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003ediv className\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;application\u0026quot;\u003c/span\u003e\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-8\" title=\"8\"\u003e            \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003eHelmet\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-9\" title=\"9\"\u003e                \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003emeta charSet\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;utf-8\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-10\" title=\"10\"\u003e                \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003etitle\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003eMy Title\u0026lt;/title\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-11\" title=\"11\"\u003e                \u003cspan class=\"op\"\u003e\u0026lt;\u003c/span\u003elink rel\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;canonical\u0026quot;\u003c/span\u003e href\u003cspan class=\"op\"\u003e=\u003c/span\u003e\u003cspan class=\"st\"\u003e\u0026quot;http://mysite.com/example\u0026quot;\u003c/span\u003e /\u0026gt;\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-12\" title=\"12\"\u003e            \u0026lt;/Helmet\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-13\" title=\"13\"\u003e            ...\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-14\" title=\"14\"\u003e        \u0026lt;/div\u003cspan class=\"op\"\u003e\u0026gt;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-15\" title=\"15\"\u003e    )\u003cspan class=\"op\"\u003e;\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-16\" title=\"16\"\u003e  \u003cspan class=\"op\"\u003e}\u003c/span\u003e\u003c/a\u003e\r\n\u003ca class=\"sourceLine\" id=\"cb173-17\" title=\"17\"\u003e\u003cspan class=\"op\"\u003e};\u003c/span\u003e\u003c/a\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n"}}},"page":"/post","query":{"id":"/2nd"},"buildId":"8XuzPB_jJm_7d8ACRpK5s","assetPrefix":"/next1","runtimeConfig":{"publicUrl":"/next1","siteName":"NOTE:: 技術メモ","siteDescription":"自分のための技術メモを残しています。"},"nextExport":true};__NEXT_LOADED_PAGES__=[];__NEXT_REGISTER_PAGE=function(r,f){__NEXT_LOADED_PAGES__.push([r, f])}</script><script async="" id="__NEXT_PAGE__/post" src="/next1/_next/static/8XuzPB_jJm_7d8ACRpK5s/pages/post.js"></script><script async="" id="__NEXT_PAGE__/_app" src="/next1/_next/static/8XuzPB_jJm_7d8ACRpK5s/pages/_app.js"></script><script async="" id="__NEXT_PAGE__/_error" src="/next1/_next/static/8XuzPB_jJm_7d8ACRpK5s/pages/_error.js"></script><script src="/next1/_next/static/runtime/webpack-42652fa8b82c329c0559.js" async=""></script><script src="/next1/_next/static/chunks/commons.c8e68c3a49c7dc3e6621.js" async=""></script><script src="/next1/_next/static/runtime/main-525d18c4fe55e81fb890.js" async=""></script></body></html>